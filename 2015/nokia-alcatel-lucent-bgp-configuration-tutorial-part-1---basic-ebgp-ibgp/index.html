<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Applying DevOps to networks."><meta name=author content="Roman Dodin"><link href=https://netdevops.me/2015/nokia-alcatel-lucent-bgp-configuration-tutorial-part-1---basic-ebgp-ibgp/ rel=canonical><link href=../nokia-alcatel-lucent-configuring-packet-ip-filters/ rel=prev><link href=../nokia-alcatel-lucent-bgp-configuration-tutorial-part-2---communities/ rel=next><link rel=alternate type=application/rss+xml title="RSS feed" href=../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../../feed_rss_updated.xml><link rel=icon href=../../assets/images/code.svg><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.4.14+insiders-4.46.0"><title>Nokia (Alcatel-Lucent) BGP configuration tutorial. Part 1 - basic eBGP, iBGP - Applying DevOps to networks</title><link rel=stylesheet href=../../assets/stylesheets/main.0ab26e37.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Google Sans";--md-code-font:"Fira Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-Y7R34KCT4N"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-Y7R34KCT4N",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-Y7R34KCT4N",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#nokia-alcatel-lucent-bgp-configuration-tutorial-part-1-basic-ebgp-ibgp class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <a href=https://twitter.com/ntdvps> For updates follow <strong>@ntdvps</strong> on <span class="twemoji twitter"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </span> <strong>Twitter</strong> </a> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Applying DevOps to networks" class="md-header__button md-logo" aria-label="Applying DevOps to networks" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Applying DevOps to networks </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Nokia (Alcatel-Lucent) BGP configuration tutorial. Part 1 - basic eBGP, iBGP </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=cyan aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hellt/netdevops.me title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> hellt/netdevops.me </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class="md-tabs__item md-tabs__item--active"> <a href=../.. class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../tags/ class=md-tabs__link> Tags </a> </li> <li class=md-tabs__item> <a href=../../subscribe/ class=md-tabs__link> Subscribe </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Applying DevOps to networks" class="md-nav__button md-logo" aria-label="Applying DevOps to networks" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg> </a> Applying DevOps to networks </label> <div class=md-nav__source> <a href=https://github.com/hellt/netdevops.me title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> hellt/netdevops.me </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1 checked> <div class="md-nav__link md-nav__container"> <a href=../.. class="md-nav__link "> <span class=md-ellipsis> Blog </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=true> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> <li class=md-nav__item> <a href=../../subscribe/ class=md-nav__link> <span class=md-ellipsis> Subscribe </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#common-bgp-configuration-steps class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Common BGP configuration steps </span> </span> </a> <nav class=md-nav aria-label="Common BGP configuration steps"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#igp-and-addressing class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> IGP and addressing </span> </span> </a> </li> <li class=md-nav__item> <a href=#configuring-router-id-and-autonomous-system-number class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Configuring Router ID and Autonomous System number </span> </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#starting-ebgp class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Starting eBGP </span> </span> </a> </li> <li class=md-nav__item> <a href=#exporting-routes-to-bgp class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Exporting routes to BGP </span> </span> </a> </li> <li class=md-nav__item> <a href=#alcatel-lucent-ebgp-reflecting-routes-issue class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Alcatel-Lucent eBGP reflecting routes issue </span> </span> </a> </li> <li class=md-nav__item> <a href=#ebgp-split-horizon class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> eBGP split-horizon </span> </span> </a> </li> <li class=md-nav__item> <a href=#ebgp-resulting-configuration class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> eBGP resulting configuration </span> </span> </a> </li> <li class=md-nav__item> <a href=#ibgp-configuration class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> iBGP configuration </span> </span> </a> <nav class=md-nav aria-label="iBGP configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ibgp-next-hop-self class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> iBGP next-hop-self </span> </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#wrapping-up class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Wrapping up </span> </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=../.. class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img src=https://avatars.githubusercontent.com/u/5679861 alt="Roman Dodin"> </span> <span class=md-profile__description> <strong> Roman Dodin </strong> <br> Network Automater </span> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Metadata </span> </div> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg> <time datetime="2015-08-24 00:00:00" class=md-ellipsis>August 24, 2015</time> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg> <span class=md-ellipsis> 32 min read </span> </div> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a href=../../tags/#nokia class=md-tag>nokia</a> <a href=../../tags/#sr-os class=md-tag>sr os</a> <a href=../../tags/#bgp class=md-tag>bgp</a> </nav> <h1 id=nokia-alcatel-lucent-bgp-configuration-tutorial-part-1-basic-ebgp-ibgp>Nokia (Alcatel-Lucent) BGP configuration tutorial. Part 1 - basic eBGP, iBGP<a class=headerlink href=#nokia-alcatel-lucent-bgp-configuration-tutorial-part-1-basic-ebgp-ibgp title="Permanent link">#</a></h1> <p>There is no way I would leave you without covering configuration steps for one of the most versatile, scalable and robust internet protocols also known as <strong>BGP</strong>. And here it is - BGP configuration guide for Nokia (Alcatel-Lucent) Service Routers.</p> <p><a href=../nokia-alcatel-lucent-sros-ospf-configuration-tutorial/ >As with the OSPF configuration tutorial</a> I will cover the configuration process for various BGP scenarios along with the verification and troubleshooting steps bundled with colorful figures, detailed code snippets and useful remarks.</p> <p>BGP is so huge that I had no other option but to write about it in several parts:</p> <ul> <li><strong>Part 1 - basic eBGP and iBGP configuration</strong></li> <li><a href=../nokia-alcatel-lucent-bgp-configuration-tutorial-part-2---communities/ >Part 2 - BGP policies. Community</a></li> </ul> <p>Part 1 is dedicated to basic eBGP/iBGP configuration. We will practice with common BGP configuration procedures at first, then learn how to export routes into BGP process and prevent unnecessary route reflection by means of <code>split-horizon</code> over eBGP links.</p> <p>Next we go over iBGP configuration to spread the eBGP learned routes across the Autonomous Systems. I will explain the necessity of having a full-mesh iBGP topology and the use of the <code>next-hop-self</code> command for iBGP peers.</p> <p>It's a perfect time to configure some BGP, right?</p> <!-- more --> <h2 id=common-bgp-configuration-steps>Common BGP configuration steps<a class=headerlink href=#common-bgp-configuration-steps title="Permanent link">#</a></h2> <p>Despite what type of BGP (Internal or External) you are going to configure there are some basic steps we are about to discuss. Address planning, IGP configuration, router-id selection, autonomous-system number setting, peer groups and neighbor configuration - all of these task are common to each and every BGP configuration routine.</p> <h3 id=igp-and-addressing>IGP and addressing<a class=headerlink href=#igp-and-addressing title="Permanent link">#</a></h3> <p>BGP completely relies on IGP (or static routes) when resolving nexthop address received in BGP updates from its peers. This means that prior to BGP configuration you should have IGP up and running. During this session I will refer to this base topology:</p> <p><a class=glightbox href=http://img-fotki.yandex.ru/get/4911/21639405.11c/0_84ca0_67149947_orig.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=pic src=http://img-fotki.yandex.ru/get/4911/21639405.11c/0_84ca0_67149947_orig.png></a></p> <p>A few words about the address plan and key pieces of this diagram: a BGP peering will take place between the two Autonomous Systems (hereinafter AS) 65510 and 65520.</p> <p>AS 65510 utilizes <code>10.10.0.0/16</code> network for local link addresses, system interfaces of its routers and customers-assigned networks, whereas AS 65520 uses <code>10.20.0.0/16</code> for the same purposes. Address plan details could be found at the <em>Legend section</em> of the "base topology" figure.</p> <p>We will be working with the two customers networks:</p> <ul> <li><code>R5_Customer - 10.10.55.0/24</code> in AS 65510</li> <li><code>R3_Ext_Customer - 172.16.33.0/24</code> in AS 65520</li> </ul> <p>As to Interior Gateway Protocol - I chose IS-IS, though you can choose an IGP protocol of your choice - it wont be any different. IS-IS configuration for this tutorial is super straightforward, system and network interfaces are participating in IS-IS process within the relevant ASes (except interfaces between R1-R3, R2-R4 as they are connecting different AS's and we will run BGP there). Inter-router links are all point-to-point type.</p> <p>IS-IS configuration section for reference:</p> <p>R1 (AS 65510):</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>*A:R1&gt;config&gt;router&gt;isis# info
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>----------------------------------------------
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>        level-capability level-1
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>        area-id 10.10
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>        reference-bandwidth 100000000
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>        level 1
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>            wide-metrics-only
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>        exit
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>        level 2
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>            wide-metrics-only
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>        exit
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>        interface &quot;system&quot;
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>            no shutdown
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>        exit
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>        interface &quot;toR2&quot;
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>            interface-type point-to-point
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>            no shutdown
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>        exit
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>        interface &quot;toR5&quot;
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>            interface-type point-to-point
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>            no shutdown
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>        exit
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>        no shutdown
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>----------------------------------------------
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>## IS-IS database for 65510 consists of LSP from every router in this AS
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a>*A:R1&gt;config&gt;router&gt;isis# show router isis database
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>===============================================================================
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a>Router Base ISIS Instance 0 Database
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>===============================================================================
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a>LSP ID                                  Sequence  Checksum Lifetime Attributes
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a>-------------------------------------------------------------------------------
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a>Displaying Level 1 database
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a>-------------------------------------------------------------------------------
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a>R1.00-00                                0xd       0x7740   1182     L1
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a>R2.00-00                                0xb       0x7ad1   812      L1
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a>R5.00-00                                0xc       0x8dfd   817      L1
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a>R6.00-00                                0xb       0xe8a5   842      L1
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a>Level (1) LSP Count : 4
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a>Displaying Level 2 database
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a>-------------------------------------------------------------------------------
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a>Level (2) LSP Count : 0
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a>===============================================================================
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a>## Check if we have a route to every router&#39;s system address within AS
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a>*A:R1# show router route-table  10.10.10.0/24 longer
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a>===============================================================================
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a>Route Table (Router: Base)
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a>===============================================================================
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55 href=#__codelineno-0-55></a>Dest Prefix[Flags]                            Type    Proto     Age        Pref
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56 href=#__codelineno-0-56></a>      Next Hop[Interface Name]                                    Metric
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57 href=#__codelineno-0-57></a>-------------------------------------------------------------------------------
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58 href=#__codelineno-0-58></a>10.10.10.1/32                                 Local   Local     02h12m52s  0
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59 href=#__codelineno-0-59></a>       system                                                       0
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60 href=#__codelineno-0-60></a>10.10.10.2/32                                 Remote  ISIS      02h12m24s  15
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61 href=#__codelineno-0-61></a>       10.10.99.1                                                   100
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62 href=#__codelineno-0-62></a>10.10.10.5/32                                 Remote  ISIS      02h12m25s  15
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63 href=#__codelineno-0-63></a>       10.10.99.5                                                   100
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64 href=#__codelineno-0-64></a>10.10.10.6/32                                 Remote  ISIS      02h12m22s  15
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65 href=#__codelineno-0-65></a>       10.10.99.1                                                   200
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66 href=#__codelineno-0-66></a>-------------------------------------------------------------------------------
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67 href=#__codelineno-0-67></a>No. of Routes: 4
</span></code></pre></div> <p>R3 (AS 65520):</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>A:R3&gt;config&gt;router&gt;isis# info
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>----------------------------------------------
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>        level-capability level-1
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>        area-id 20.20
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>        reference-bandwidth 100000000
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>        level 1
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>            wide-metrics-only
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>        exit
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>        level 2
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>            wide-metrics-only
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>        exit
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>        interface &quot;system&quot;
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>            no shutdown
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>        exit
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>        interface &quot;toR4&quot;
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>            interface-type point-to-point
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>            no shutdown
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>        exit
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>        no shutdown
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>----------------------------------------------
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>## AS 65520 consists of two routers R3 and R4, that is why we see only two LSP here
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>A:R3&gt;config&gt;router&gt;isis# show router isis database
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>===============================================================================
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>Router Base ISIS Instance 0 Database
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>===============================================================================
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>LSP ID                                  Sequence  Checksum Lifetime Attributes
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a>-------------------------------------------------------------------------------
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>Displaying Level 1 database
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a>-------------------------------------------------------------------------------
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a>R3.00-00                                0xc       0x8dc2   1160     L1
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a>R4.00-00                                0xa       0xfe4e   639      L1
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>Level (1) LSP Count : 2
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a>Displaying Level 2 database
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>-------------------------------------------------------------------------------
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a>Level (2) LSP Count : 0
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a>===============================================================================
</span></code></pre></div> <h3 id=configuring-router-id-and-autonomous-system-number>Configuring Router ID and Autonomous System number<a class=headerlink href=#configuring-router-id-and-autonomous-system-number title="Permanent link">#</a></h3> <p>Once IGP is configured its time to configure a common entity for almost every routing protocol - <strong>Router ID</strong>. For BGP there is more than one place to configure the Router ID. Here is the <em>Router ID</em> selection process sorted by a priority:</p> <ol> <li>Router ID is configured in BGP global context with the command <code>configure router bgp router-id &lt;ip-address&gt;</code></li> <li>Router ID is configured globally for a router with the command <code>configure router router-id &lt;ip-address&gt;</code></li> <li>Router ID is inherited from <code>system</code> IP-address.</li> </ol> <p>Important thing to remember is that if no <code>router-id</code> nor <code>system</code> interface is configured - BGP will not start. Since we have the <code>system</code> interface configured for every router we don't need to specify the <code>router-id</code> explicitly.</p> <p><strong>AS number</strong> can be configured either globally for a router <code>configure router autonomous-system &lt;autonomous-system&gt;</code> or for a specified peer group with the <code>local-as</code> command. We will stick to the first option and configure our AS numbers globally for a router:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>A:R3# configure router autonomous-system 65520
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>*A:R3&gt;config&gt;router# info
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>#--------------------------------------------------
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>echo &quot;IP Configuration&quot;
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>#--------------------------------------------------
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>        interface &quot;system&quot;
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>            address 10.20.20.3/32
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>            no shutdown
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>        exit
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>        interface &quot;toR1&quot;
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>            address 10.0.99.1/31
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>            port 1/1/3
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>            no shutdown
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>        exit
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>        interface &quot;toR4&quot;
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>            address 10.20.99.0/31
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>            port 1/1/2
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>            no shutdown
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>        exit
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>        autonomous-system 65520
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>#--------------------------------------------------
</span></code></pre></div> <h2 id=starting-ebgp>Starting eBGP<a class=headerlink href=#starting-ebgp title="Permanent link">#</a></h2> <p>Common parameters are now configured and we can jump to eBGP peers configuration. Recall that we have two routers within AS 65510 (R1 and R2) which will have eBGP peering sessions with R3 and R3 within AS 65520 accordingly. Thus we should configure eBGP peering between the pairs R1-R3, R2-R4.</p> <p><a class=glightbox href=http://img-fotki.yandex.ru/get/6612/21639405.11c/0_84ca1_6e32bdad_orig.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=pic src=http://img-fotki.yandex.ru/get/6612/21639405.11c/0_84ca1_6e32bdad_orig.png></a></p> <p>Nokia BGP configuration policy <strong>requires</strong> you to configure <strong>at least one peer group</strong> to make BGP peering happen. Peer groups are logical containers for BGP peers that share common parameters. Every BGP neighbor you add should find its place in any of the BGP peer groups, in other words - <strong>peer groups are mandatory</strong> in SROS.</p> <p>I will guide you through basic eBGP configuration between R1 and R3. R2 and R4 configuration will be just the same.</p> <p>R1:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>## entering BGP configuration context
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>*A:R1# configure router bgp
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>## creating group eBGP
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>*A:R1&gt;config&gt;router&gt;bgp$ group &quot;eBGP&quot;
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>## specifying AS Number for AS we would want to peer to (which is 65520)
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>## for eBGP peer-as should differ from local AS
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>## for iBGP peer-as should match local AS Number
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>*A:R1&gt;config&gt;router&gt;bgp&gt;group$ peer-as 65520
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>## setting IP address of the remote router in AS 65520
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>*A:R1&gt;config&gt;router&gt;bgp&gt;group$ neighbor 10.0.99.1
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>## specify local-address for eBGP peer
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>*A:R1&gt;config&gt;router&gt;bgp&gt;group&gt;neighbor# local-address 10.0.99.0
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>## Viewing resulting configuration
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>*A:R1&gt;config&gt;router&gt;bgp&gt;group&gt;neighbor$ back
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>*A:R1&gt;config&gt;router&gt;bgp&gt;group$ back
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a>*A:R1&gt;config&gt;router&gt;bgp$ info
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>----------------------------------------------
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>            group &quot;eBGP&quot;
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>                peer-as 65520
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>                neighbor 10.0.99.1
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>                    local-address 10.0.99.0
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>                exit
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>            exit
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a>            no shutdown
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a>----------------------------------------------```
</span></code></pre></div> <p>R3:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>## all the comments are the same as for R1
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>*A:R3# configure router bgp
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>*A:R3&gt;config&gt;router&gt;bgp$ group &quot;eBGP&quot;
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>*A:R3&gt;config&gt;router&gt;bgp&gt;group$ peer-as 65510
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>*A:R3&gt;config&gt;router&gt;bgp&gt;group$ neighbor 10.0.99.0
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>A:R3&gt;config&gt;router&gt;bgp&gt;group&gt;neighbor$ local-address 10.0.99.1
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>*A:R3&gt;config&gt;router&gt;bgp&gt;group&gt;neighbor$ back
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>*A:R3&gt;config&gt;router&gt;bgp&gt;group$ back
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>*A:R3&gt;config&gt;router&gt;bgp$ info
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>----------------------------------------------
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>            group &quot;eBGP&quot;
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>                peer-as 65510
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>                neighbor 10.0.99.0
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>                    local-address 10.0.99.1
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>                exit
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>            exit
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>            no shutdown
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>----------------------------------------------
</span></code></pre></div> <p>As simple as that, eBGP in its simplest form has been configured in 5 lines. Pay additional attention to <code>local-address</code> command. It is a common practice to specify a link IP address for an eBGP peer, otherwise SROS router will try to establish TCP session from its system IP address and will fail.</p> <p>To verify the established eBGP peering use the <code>show router bgp summary</code> command (another way is to use <code>show router bgp neighbor &lt;neighbor-ip-address&gt;</code>)</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>A:R1# show router bgp summary
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>===============================================================================
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a> BGP Router ID:10.10.10.1       AS:65510       Local AS:65510
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>===============================================================================
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>BGP Admin State         : Up          BGP Oper State              : Up
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>Total Peer Groups       : 1           Total Peers                 : 1
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>Total BGP Paths         : 7           Total Path Memory           : 1260
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>Total IPv4 Remote Rts   : 0           Total IPv4 Rem. Active Rts  : 0
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>Total McIPv4 Remote Rts : 0           Total McIPv4 Rem. Active Rts: 0
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>Total McIPv6 Remote Rts : 0           Total McIPv6 Rem. Active Rts: 0
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>Total IPv6 Remote Rts   : 0           Total IPv6 Rem. Active Rts  : 0
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>Total IPv4 Backup Rts   : 0           Total IPv6 Backup Rts       : 0
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>Total Supressed Rts     : 0           Total Hist. Rts             : 0
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>Total Decay Rts         : 0
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>Total VPN Peer Groups   : 0           Total VPN Peers             : 0
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>Total VPN Local Rts     : 0
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>Total VPN-IPv4 Rem. Rts : 0           Total VPN-IPv4 Rem. Act. Rts: 0
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>Total VPN-IPv6 Rem. Rts : 0           Total VPN-IPv6 Rem. Act. Rts: 0
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a>Total VPN-IPv4 Bkup Rts : 0           Total VPN-IPv6 Bkup Rts     : 0
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>Total VPN Supp. Rts     : 0           Total VPN Hist. Rts         : 0
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>Total VPN Decay Rts     : 0
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>Total L2-VPN Rem. Rts   : 0           Total L2VPN Rem. Act. Rts   : 0
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a>Total MVPN-IPv4 Rem Rts : 0           Total MVPN-IPv4 Rem Act Rts : 0
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a>Total MDT-SAFI Rem Rts  : 0           Total MDT-SAFI Rem Act Rts  : 0
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>Total MSPW Rem Rts      : 0           Total MSPW Rem Act Rts      : 0
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>Total RouteTgt Rem Rts  : 0           Total RouteTgt Rem Act Rts  : 0
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>Total McVpnIPv4 Rem Rts : 0           Total McVpnIPv4 Rem Act Rts : 0
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>Total MVPN-IPv6 Rem Rts : 0           Total MVPN-IPv6 Rem Act Rts : 0
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a>Total EVPN Rem Rts      : 0           Total EVPN Rem Act Rts      : 0
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a>Total FlowIpv4 Rem Rts  : 0           Total FlowIpv4 Rem Act Rts  : 0
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a>Total FlowIpv6 Rem Rts  : 0           Total FlowIpv6 Rem Act Rts  : 0
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a>
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a>===============================================================================
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a>BGP Summary
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a>===============================================================================
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>Neighbor
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a>                   AS PktRcvd InQ  Up/Down   State|Rcv/Act/Sent (Addr Family)
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a>                      PktSent OutQ
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a>-------------------------------------------------------------------------------
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44 href=#__codelineno-5-44></a>10.0.99.1
</span><span id=__span-5-45><a id=__codelineno-5-45 name=__codelineno-5-45 href=#__codelineno-5-45></a>                65520      85    0 00h41m58s 0/0/0 (IPv4)
</span><span id=__span-5-46><a id=__codelineno-5-46 name=__codelineno-5-46 href=#__codelineno-5-46></a>                           85    0
</span><span id=__span-5-47><a id=__codelineno-5-47 name=__codelineno-5-47 href=#__codelineno-5-47></a>-------------------------------------------------------------------------------
</span></code></pre></div> <p>At the end of this show command you can find information about the BGP neighbors and their states. With <code>show router bgp summary</code> command issued on R1 we see <code>10.0.99.1</code> as a neighbor (which is R3's interface IP address).</p> <p>If a session is established then you see the session uptime and number of routes <em>received/active/sent</em>. If the session has not been established yet an operator will see the current BGP state instead of the exchanged routes counters.</p> <p>String <code>0/0/0 (IPv4)</code> is an indicator that the peering has been successfully established and R1 router received and sent exactly zero IPv4 routes. Zero counters are expected, since we just started the eBGP session but did not export any routes to it. It is very important to remember that <strong>by default SROS does not add any non-BGP routes to the BGP process</strong>.</p> <h2 id=exporting-routes-to-bgp>Exporting routes to BGP<a class=headerlink href=#exporting-routes-to-bgp title="Permanent link">#</a></h2> <p>No fun at all to play with zero NLRI (network layer reachability information). Lets fix this and add some routes to our eBGP process. We have a good candidate for this in our address plan - <code>R5_Customer - 10.10.55.0/24</code> network. To emulate this customer's network we must add a loopback interface to R5 and announce this network via IGP:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>A:R5# configure router interface R5_Customer_loopback
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>*A:R5&gt;config&gt;router&gt;if$ loopback
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>*A:R5&gt;config&gt;router&gt;if$ address 10.10.55.1/24
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>## adding artificial R5_Customer network to IS-IS
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>*A:R5# configure router isis interface &quot;R5_Customer_loopback&quot;
</span></code></pre></div> <p>After we created a network for our customer and announced it via IS-IS we should check if R1 could see it in its routing table:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>A:R1# show router route-table 10.10.55.0/24
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>===============================================================================
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>Route Table (Router: Base)
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>===============================================================================
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>Dest Prefix[Flags]                            Type    Proto     Age        Pref
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>      Next Hop[Interface Name]                                    Metric
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>-------------------------------------------------------------------------------
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>10.10.55.0/24                                 Remote  ISIS      00h00m03s  15
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>       10.10.99.5                                                   100
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>-------------------------------------------------------------------------------
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>No. of Routes: 1
</span></code></pre></div> <p>Now R1 is aware of <code>10.10.55.0/24</code>, but this is not sufficient for the BGP process on R1 to advertise this prefix to R3. We should <strong>explicitly</strong> tell BGP process running on R1 to take <code>10.10.55.0/24</code> prefix into consideration and the way to do so is to create a <strong>policy-statement</strong> and <strong>export</strong> it to BGP.</p> <p>Step-by-step plan goes like this:</p> <ul> <li>create a <em>prefix-list</em> to match a desired prefix</li> <li>create a <em>policy-statement</em> accepting prefixes from the prefix-list and delivering it to the BGP process</li> <li>add customer's network to BGP via <code>export &lt;policy_statement&gt;</code> command under peer group context.</li> </ul> <p>Lets implement this plan:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>A:R1# configure router policy-options
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>## entering to policy options edit mode
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>A:R1&gt;config&gt;router&gt;policy-options# begin
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>## creating prefix-list for R5_Customer network
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>*A:R1&gt;config&gt;router&gt;policy-options# prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>*A:R1&gt;config&gt;router&gt;policy-options&gt;prefix-list$ prefix 10.10.55.0/24 exact
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>*A:R1&gt;config&gt;router&gt;policy-options&gt;prefix-list$ back
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>## creating policy statement
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>*A:R1&gt;config&gt;router&gt;policy-options# policy-statement &quot;R5_Customer_export&quot;
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>*A:R1&gt;config&gt;router&gt;policy-options&gt;policy-statement$ entry 10
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>*A:R1&gt;config&gt;router&gt;policy-options&gt;policy-statement&gt;entry$ from prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>*A:R1&gt;config&gt;router&gt;policy-options&gt;policy-statement&gt;entry$ to protocol bgp
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>*A:R1&gt;config&gt;router&gt;policy-options&gt;policy-statement&gt;entry$ action accept
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>*A:R1&gt;config&gt;router&gt;policy-options&gt;policy-statement&gt;entry&gt;action$ back
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>*A:R1&gt;config&gt;router&gt;policy-options&gt;policy-statement&gt;entry$ back
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>*A:R1&gt;config&gt;router&gt;policy-options&gt;policy-statement$ back
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>## applying changes to policy options
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>*A:R1&gt;config&gt;router&gt;policy-options# commit
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a>## reviewing configuration
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a>*A:R1&gt;config&gt;router&gt;policy-options# info
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a>----------------------------------------------
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a>            prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a>                prefix 10.10.55.0/24 exact
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a>            exit
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>            policy-statement &quot;R5_Customer_export&quot;
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a>                entry 10
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a>                    from
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a>                        prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a>                    exit
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a>                    to
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a>                        protocol bgp
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a>                    exit
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a>                    action accept
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a>                    exit
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a>                exit
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a>            exit
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a>----------------------------------------------
</span></code></pre></div> <p>After we have the policy statement configured we can reference it in the <code>export</code> command under the eBGP peer group section of R1:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>*A:R1# configure router bgp
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>*A:R1&gt;config&gt;router&gt;bgp# group &quot;eBGP&quot;
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>## hitting TAB after &quot;export&quot; keyword displays all available policy statements
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>*A:R1&gt;config&gt;router&gt;bgp&gt;group# export
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>&lt;policy-name&gt; [&lt;policy-name&gt;...(upto 15 max)]
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a> &quot;R5_Customer_export&quot;
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>*A:R1&gt;config&gt;router&gt;bgp&gt;group# export &quot;R5_Customer_export&quot;
</span></code></pre></div> <p>Export command triggers R1 to send a BGP Update message with the NLRI for <code>R5_Customer</code> network to R3 (note that I made the same configuration on R2-R4 pair, so the figure below shows R2's BGP Update message as well):</p> <p><a class=glightbox href=http://img-fotki.yandex.ru/get/9170/21639405.11c/0_84ca2_4e1a50c8_orig.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=pic src=http://img-fotki.yandex.ru/get/9170/21639405.11c/0_84ca2_4e1a50c8_orig.png></a></p> <p>Take a look at <code>show router bgp summary</code> once again on R1:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>A:R1# show router bgp summary
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>## output omitted ##
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>===============================================================================
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>BGP Summary
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>===============================================================================
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>Neighbor
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>                   AS PktRcvd InQ  Up/Down   State|Rcv/Act/Sent (Addr Family)
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>                      PktSent OutQ
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>-------------------------------------------------------------------------------
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>10.0.99.1
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>                65520     265    0 02h13m28s 1/0/1 (IPv4)
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>                          266    0
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>-------------------------------------------------------------------------------
</span></code></pre></div> <p>Nice, we have sent and received <em>one</em> IPv4 NLRI. It is surprising to see one prefix received considering that R3 does not have any exported networks, but we will deal with this later. Now lets check R3 to see if it has <code>R5_Customer</code> network in its routing table?</p> <blockquote> <p><strong>BGP mechanics</strong><br> I have to pause for a moment and share with you the BGP route processing diagram. It helps to understand what BGP databases are there on Nokia SROS and what path it takes through the BGP route machinery. <a class=glightbox href=http://img-fotki.yandex.ru/get/4109/21639405.11c/0_84d72_94e5a74a_orig.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=pic src=http://img-fotki.yandex.ru/get/4109/21639405.11c/0_84d72_94e5a74a_orig.png></a> <small>credits: Alcatel-Lucent Service Routing Architect (SRA) Self-Study guide, WILEY</small><br> I will refer to these databases from now on as BGP RIB In, BGP Local-RIB and BGP RIB Out.</p> </blockquote> <p>To see what routes are in <strong>BGP RIB In</strong> and BGP Local Routing Information Base (<strong>BGP Local-RIB</strong>) use the <code>show router bgp routes</code> command:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>A:R3# show router bgp routes
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>===============================================================================
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a> BGP Router ID:10.20.20.3       AS:65520       Local AS:65520
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>===============================================================================
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a> Legend -
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>                 l - leaked
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>===============================================================================
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>BGP IPv4 Routes
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>===============================================================================
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>      As-Path
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>-------------------------------------------------------------------------------
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>u*&gt;i  10.10.55.0/24                                      None        100
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>      10.0.99.0                                          None        -
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>      65510
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>-------------------------------------------------------------------------------
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a>Routes : 1
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a>===============================================================================
</span></code></pre></div> <p>Perfect, <code>10.10.55.0/24</code> network made its way into BGP Local-RIB</p> <ul> <li><code>*</code> flag means it passed validation checks</li> <li><code>u</code> tells us that this route is used and is present in the R3 routing table</li> </ul> <div class="language-text highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>A:R3# show router route-table 10.10.55.0
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>===============================================================================
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>Route Table (Router: Base)
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>===============================================================================
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>Dest Prefix[Flags]                            Type    Proto     Age        Pref
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>      Next Hop[Interface Name]                                    Metric
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>-------------------------------------------------------------------------------
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>10.10.55.0/24                                 Remote  BGP       00h12m32s  170
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a>       10.0.99.0                                                    0
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>-------------------------------------------------------------------------------
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>No. of Routes: 1
</span></code></pre></div> <h2 id=alcatel-lucent-ebgp-reflecting-routes-issue>Alcatel-Lucent eBGP reflecting routes issue<a class=headerlink href=#alcatel-lucent-ebgp-reflecting-routes-issue title="Permanent link">#</a></h2> <p>Now it is time to deal with that rogue route received by R1 from its neighbor R3.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>*A:R1# show router bgp routes
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>===============================================================================
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a> BGP Router ID:10.10.10.1       AS:65510       Local AS:65510
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>===============================================================================
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a> Legend -
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>                 l - leaked
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>===============================================================================
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>BGP IPv4 Routes
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>===============================================================================
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>      As-Path
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>-------------------------------------------------------------------------------
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>i     10.10.55.0/24                                      None        None
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>      10.0.99.1                                          None        -
</span><span id=__span-13-19><a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a>      65520 65510
</span><span id=__span-13-20><a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>-------------------------------------------------------------------------------
</span><span id=__span-13-21><a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>Routes : 1
</span><span id=__span-13-22><a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>===============================================================================
</span></code></pre></div> <p>AS 65510 local prefix <code>10.10.55.0/24</code> is in R1's own BGP Local-RIB, but why do wee see it there? Well, because R3 sent it to R1. But why the hell R3 sent back the <code>10.10.55.0/24</code> prefix to R1 given that it came from it?</p> <p>Lets investigate NLRI propagation for this prefix:</p> <ol> <li>R1 sends BGP Update message to R3 with the <code>10.10.55.0/24</code> prefix and AS Path 65510.</li> <li>R3 receives this update, stores it in <strong>BGP RIB In</strong> database and checks if this NLRI is valid (nexthop resolvable, no AS Path loop) in order to put this prefix in R3's <strong>BGP Local-RIB</strong>.</li> <li>All the checks passed and R3 sends NLRI <code>10.10.55.0/24</code> back to R1 since <strong>this is not prohibited</strong> by <a href=https://tools.ietf.org/html/rfc4271>RFC 4271 A Border Gateway Protocol 4 (BGP-4)</a> appending AS Path with its AS number.</li> <li>R1 receives this update and stores it in its <strong>BGP RIB In</strong> but this route will never make its way to <strong>BGP Local-RIB</strong> due to <strong>AS Loop</strong> error.</li> </ol> <p>Based on the output from the <code>show router bgp routes</code> command and the fact that there is only one flag <code>i</code> associated with the <code>10.10.55.0/24</code> prefix we can conclude that this prefix was not delivered to <em>Route Table Manager</em> (RTM) and left alone in the BGP RIB In of R1. But why is that? If we issue super-useful command <code>show router bgp routes &lt;prefix&gt; hunt</code> for this prefix we could see what happened:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>*A:R1# show router bgp routes 10.10.55.0/24 hunt
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>===============================================================================
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a> BGP Router ID:10.10.10.1       AS:65510       Local AS:65510
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>===============================================================================
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a> Legend -
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>                 l - leaked
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>===============================================================================
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a>BGP IPv4 Routes
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>===============================================================================
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a>-------------------------------------------------------------------------------
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a>RIB In Entries
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a>-------------------------------------------------------------------------------
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a>Network        : 10.10.55.0/24
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a>Nexthop        : 10.0.99.1
</span><span id=__span-14-18><a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a>Path Id        : None
</span><span id=__span-14-19><a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a>From           : 10.0.99.1
</span><span id=__span-14-20><a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a>Res. Nexthop   : 10.0.99.1
</span><span id=__span-14-21><a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a>Local Pref.    : None                   Interface Name : toR3
</span><span id=__span-14-22><a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a>Aggregator AS  : None                   Aggregator     : None
</span><span id=__span-14-23><a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a>Atomic Aggr.   : Not Atomic             MED            : None
</span><span id=__span-14-24><a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a>AIGP Metric    : None
</span><span id=__span-14-25><a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a>Connector      : None
</span><span id=__span-14-26><a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a>Community      : No Community Members
</span><span id=__span-14-27><a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a>Cluster        : No Cluster Members
</span><span id=__span-14-28><a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a>Originator Id  : None                   Peer Router Id : 10.20.20.3
</span><span id=__span-14-29><a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a>Fwd Class      : None                   Priority       : None
</span><span id=__span-14-30><a id=__codelineno-14-30 name=__codelineno-14-30 href=#__codelineno-14-30></a>Flags          : Invalid  IGP  AS-Loop
</span><span id=__span-14-31><a id=__codelineno-14-31 name=__codelineno-14-31 href=#__codelineno-14-31></a>Route Source   : External
</span><span id=__span-14-32><a id=__codelineno-14-32 name=__codelineno-14-32 href=#__codelineno-14-32></a>AS-Path        : 65520 65510
</span><span id=__span-14-33><a id=__codelineno-14-33 name=__codelineno-14-33 href=#__codelineno-14-33></a>Route Tag      : 0
</span><span id=__span-14-34><a id=__codelineno-14-34 name=__codelineno-14-34 href=#__codelineno-14-34></a>Neighbor-AS    : 65520
</span><span id=__span-14-35><a id=__codelineno-14-35 name=__codelineno-14-35 href=#__codelineno-14-35></a>Orig Validation: NotFound
</span><span id=__span-14-36><a id=__codelineno-14-36 name=__codelineno-14-36 href=#__codelineno-14-36></a>Source Class   : 0                      Dest Class     : 0
</span><span id=__span-14-37><a id=__codelineno-14-37 name=__codelineno-14-37 href=#__codelineno-14-37></a>
</span><span id=__span-14-38><a id=__codelineno-14-38 name=__codelineno-14-38 href=#__codelineno-14-38></a>-------------------------------------------------------------------------------
</span><span id=__span-14-39><a id=__codelineno-14-39 name=__codelineno-14-39 href=#__codelineno-14-39></a>RIB Out Entries
</span><span id=__span-14-40><a id=__codelineno-14-40 name=__codelineno-14-40 href=#__codelineno-14-40></a>-------------------------------------------------------------------------------
</span><span id=__span-14-41><a id=__codelineno-14-41 name=__codelineno-14-41 href=#__codelineno-14-41></a>Network        : 10.10.55.0/24
</span><span id=__span-14-42><a id=__codelineno-14-42 name=__codelineno-14-42 href=#__codelineno-14-42></a>Nexthop        : 10.0.99.0
</span><span id=__span-14-43><a id=__codelineno-14-43 name=__codelineno-14-43 href=#__codelineno-14-43></a>Path Id        : None
</span><span id=__span-14-44><a id=__codelineno-14-44 name=__codelineno-14-44 href=#__codelineno-14-44></a>To             : 10.0.99.1
</span><span id=__span-14-45><a id=__codelineno-14-45 name=__codelineno-14-45 href=#__codelineno-14-45></a>Res. Nexthop   : n/a
</span><span id=__span-14-46><a id=__codelineno-14-46 name=__codelineno-14-46 href=#__codelineno-14-46></a>Local Pref.    : n/a                    Interface Name : NotAvailable
</span><span id=__span-14-47><a id=__codelineno-14-47 name=__codelineno-14-47 href=#__codelineno-14-47></a>Aggregator AS  : None                   Aggregator     : None
</span><span id=__span-14-48><a id=__codelineno-14-48 name=__codelineno-14-48 href=#__codelineno-14-48></a>Atomic Aggr.   : Not Atomic             MED            : 100
</span><span id=__span-14-49><a id=__codelineno-14-49 name=__codelineno-14-49 href=#__codelineno-14-49></a>AIGP Metric    : None
</span><span id=__span-14-50><a id=__codelineno-14-50 name=__codelineno-14-50 href=#__codelineno-14-50></a>Connector      : None
</span><span id=__span-14-51><a id=__codelineno-14-51 name=__codelineno-14-51 href=#__codelineno-14-51></a>Community      : No Community Members
</span><span id=__span-14-52><a id=__codelineno-14-52 name=__codelineno-14-52 href=#__codelineno-14-52></a>Cluster        : No Cluster Members
</span><span id=__span-14-53><a id=__codelineno-14-53 name=__codelineno-14-53 href=#__codelineno-14-53></a>Originator Id  : None                   Peer Router Id : 10.20.20.3
</span><span id=__span-14-54><a id=__codelineno-14-54 name=__codelineno-14-54 href=#__codelineno-14-54></a>Origin         : IGP
</span><span id=__span-14-55><a id=__codelineno-14-55 name=__codelineno-14-55 href=#__codelineno-14-55></a>AS-Path        : 65510
</span><span id=__span-14-56><a id=__codelineno-14-56 name=__codelineno-14-56 href=#__codelineno-14-56></a>Route Tag      : 0
</span><span id=__span-14-57><a id=__codelineno-14-57 name=__codelineno-14-57 href=#__codelineno-14-57></a>Neighbor-AS    : 65510
</span><span id=__span-14-58><a id=__codelineno-14-58 name=__codelineno-14-58 href=#__codelineno-14-58></a>Orig Validation: NotFound
</span><span id=__span-14-59><a id=__codelineno-14-59 name=__codelineno-14-59 href=#__codelineno-14-59></a>Source Class   : 0                      Dest Class     : 0
</span><span id=__span-14-60><a id=__codelineno-14-60 name=__codelineno-14-60 href=#__codelineno-14-60></a>
</span><span id=__span-14-61><a id=__codelineno-14-61 name=__codelineno-14-61 href=#__codelineno-14-61></a>-------------------------------------------------------------------------------
</span><span id=__span-14-62><a id=__codelineno-14-62 name=__codelineno-14-62 href=#__codelineno-14-62></a>Routes : 2
</span><span id=__span-14-63><a id=__codelineno-14-63 name=__codelineno-14-63 href=#__codelineno-14-63></a>===============================================================================
</span></code></pre></div> <p><strong>RIB In Entries</strong> section of this output and especially the lines "Flags" and "AS Path" answer the question why R1 will not pass <code>10.10.55.0/24</code> to the <em>BGP Local-RIB</em> — there is an <strong>AS Path Loop</strong> for this NLRI. And this is the reason why this NLRI is in <em>BGP RIB In</em> only.</p> <h2 id=ebgp-split-horizon>eBGP split-horizon<a class=headerlink href=#ebgp-split-horizon title="Permanent link">#</a></h2> <p>For those of you who came from Cisco or Juniper camps its quite strange to see that R3 send the same prefix back to R1. I agree, its hard to find a case when it would be desired to receive previously announced prefix over eBGP. To mitigate this round-trip exchange you can use the <code>split-horizon</code> command on R3. This split-horizon has nothing to do with standard iBGP split-horizon behavior (which is "do not advertise prefixes received from one iBGP peer to the other iBPG peers").</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>## check that 10.10.55.0/24 prefix is announcing back to R1
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>*A:R3# show router bgp routes 10.10.55.0/24 hunt
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>===============================================================================
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a> BGP Router ID:10.20.20.3       AS:65520       Local AS:65520
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>===============================================================================
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a> Legend -
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>                 l - leaked
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>===============================================================================
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>BGP IPv4 Routes
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a>===============================================================================
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a>-------------------------------------------------------------------------------
</span><span id=__span-15-15><a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>RIB In Entries
</span><span id=__span-15-16><a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a>-------------------------------------------------------------------------------
</span><span id=__span-15-17><a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>&lt; output omitted &gt;
</span><span id=__span-15-18><a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>-------------------------------------------------------------------------------
</span><span id=__span-15-19><a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a>RIB Out Entries
</span><span id=__span-15-20><a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a>-------------------------------------------------------------------------------
</span><span id=__span-15-21><a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a>Network        : 10.10.55.0/24
</span><span id=__span-15-22><a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a>Nexthop        : 10.0.99.1
</span><span id=__span-15-23><a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a>Path Id        : None
</span><span id=__span-15-24><a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a>To             : 10.0.99.0
</span><span id=__span-15-25><a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a>Res. Nexthop   : n/a
</span><span id=__span-15-26><a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a>Local Pref.    : n/a                    Interface Name : NotAvailable
</span><span id=__span-15-27><a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a>Aggregator AS  : None                   Aggregator     : None
</span><span id=__span-15-28><a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a>Atomic Aggr.   : Not Atomic             MED            : None
</span><span id=__span-15-29><a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a>AIGP Metric    : None
</span><span id=__span-15-30><a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a>Connector      : None
</span><span id=__span-15-31><a id=__codelineno-15-31 name=__codelineno-15-31 href=#__codelineno-15-31></a>Community      : No Community Members
</span><span id=__span-15-32><a id=__codelineno-15-32 name=__codelineno-15-32 href=#__codelineno-15-32></a>Cluster        : No Cluster Members
</span><span id=__span-15-33><a id=__codelineno-15-33 name=__codelineno-15-33 href=#__codelineno-15-33></a>Originator Id  : None                   Peer Router Id : 10.10.10.1
</span><span id=__span-15-34><a id=__codelineno-15-34 name=__codelineno-15-34 href=#__codelineno-15-34></a>Origin         : IGP
</span><span id=__span-15-35><a id=__codelineno-15-35 name=__codelineno-15-35 href=#__codelineno-15-35></a>AS-Path        : 65520 65510
</span><span id=__span-15-36><a id=__codelineno-15-36 name=__codelineno-15-36 href=#__codelineno-15-36></a>Route Tag      : 0
</span><span id=__span-15-37><a id=__codelineno-15-37 name=__codelineno-15-37 href=#__codelineno-15-37></a>Neighbor-AS    : 65520
</span><span id=__span-15-38><a id=__codelineno-15-38 name=__codelineno-15-38 href=#__codelineno-15-38></a>Orig Validation: NotFound
</span><span id=__span-15-39><a id=__codelineno-15-39 name=__codelineno-15-39 href=#__codelineno-15-39></a>Source Class   : 0                      Dest Class     : 0
</span><span id=__span-15-40><a id=__codelineno-15-40 name=__codelineno-15-40 href=#__codelineno-15-40></a>
</span><span id=__span-15-41><a id=__codelineno-15-41 name=__codelineno-15-41 href=#__codelineno-15-41></a>-------------------------------------------------------------------------------
</span><span id=__span-15-42><a id=__codelineno-15-42 name=__codelineno-15-42 href=#__codelineno-15-42></a>Routes : 2
</span><span id=__span-15-43><a id=__codelineno-15-43 name=__codelineno-15-43 href=#__codelineno-15-43></a>===============================================================================
</span><span id=__span-15-44><a id=__codelineno-15-44 name=__codelineno-15-44 href=#__codelineno-15-44></a>
</span><span id=__span-15-45><a id=__codelineno-15-45 name=__codelineno-15-45 href=#__codelineno-15-45></a>
</span><span id=__span-15-46><a id=__codelineno-15-46 name=__codelineno-15-46 href=#__codelineno-15-46></a>## issue split-horizon command to disable this useless behavior
</span><span id=__span-15-47><a id=__codelineno-15-47 name=__codelineno-15-47 href=#__codelineno-15-47></a>A:R3# configure router bgp group &quot;eBGP&quot;
</span><span id=__span-15-48><a id=__codelineno-15-48 name=__codelineno-15-48 href=#__codelineno-15-48></a>A:R3&gt;config&gt;router&gt;bgp&gt;group# split-horizon 
</span><span id=__span-15-49><a id=__codelineno-15-49 name=__codelineno-15-49 href=#__codelineno-15-49></a>
</span><span id=__span-15-50><a id=__codelineno-15-50 name=__codelineno-15-50 href=#__codelineno-15-50></a>
</span><span id=__span-15-51><a id=__codelineno-15-51 name=__codelineno-15-51 href=#__codelineno-15-51></a>## there is now no routes in RIB Out Entries section
</span><span id=__span-15-52><a id=__codelineno-15-52 name=__codelineno-15-52 href=#__codelineno-15-52></a>*A:R3# show router bgp routes 10.10.55.0/24 hunt
</span><span id=__span-15-53><a id=__codelineno-15-53 name=__codelineno-15-53 href=#__codelineno-15-53></a>===============================================================================
</span><span id=__span-15-54><a id=__codelineno-15-54 name=__codelineno-15-54 href=#__codelineno-15-54></a> BGP Router ID:10.20.20.3       AS:65520       Local AS:65520
</span><span id=__span-15-55><a id=__codelineno-15-55 name=__codelineno-15-55 href=#__codelineno-15-55></a>===============================================================================
</span><span id=__span-15-56><a id=__codelineno-15-56 name=__codelineno-15-56 href=#__codelineno-15-56></a> Legend -
</span><span id=__span-15-57><a id=__codelineno-15-57 name=__codelineno-15-57 href=#__codelineno-15-57></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-15-58><a id=__codelineno-15-58 name=__codelineno-15-58 href=#__codelineno-15-58></a>                 l - leaked
</span><span id=__span-15-59><a id=__codelineno-15-59 name=__codelineno-15-59 href=#__codelineno-15-59></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-15-60><a id=__codelineno-15-60 name=__codelineno-15-60 href=#__codelineno-15-60></a>
</span><span id=__span-15-61><a id=__codelineno-15-61 name=__codelineno-15-61 href=#__codelineno-15-61></a>===============================================================================
</span><span id=__span-15-62><a id=__codelineno-15-62 name=__codelineno-15-62 href=#__codelineno-15-62></a>BGP IPv4 Routes
</span><span id=__span-15-63><a id=__codelineno-15-63 name=__codelineno-15-63 href=#__codelineno-15-63></a>===============================================================================
</span><span id=__span-15-64><a id=__codelineno-15-64 name=__codelineno-15-64 href=#__codelineno-15-64></a>-------------------------------------------------------------------------------
</span><span id=__span-15-65><a id=__codelineno-15-65 name=__codelineno-15-65 href=#__codelineno-15-65></a>RIB In Entries
</span><span id=__span-15-66><a id=__codelineno-15-66 name=__codelineno-15-66 href=#__codelineno-15-66></a>-------------------------------------------------------------------------------
</span><span id=__span-15-67><a id=__codelineno-15-67 name=__codelineno-15-67 href=#__codelineno-15-67></a>Network        : 10.10.55.0/24
</span><span id=__span-15-68><a id=__codelineno-15-68 name=__codelineno-15-68 href=#__codelineno-15-68></a>Nexthop        : 10.0.99.0
</span><span id=__span-15-69><a id=__codelineno-15-69 name=__codelineno-15-69 href=#__codelineno-15-69></a>Path Id        : None
</span><span id=__span-15-70><a id=__codelineno-15-70 name=__codelineno-15-70 href=#__codelineno-15-70></a>From           : 10.0.99.0
</span><span id=__span-15-71><a id=__codelineno-15-71 name=__codelineno-15-71 href=#__codelineno-15-71></a>Res. Nexthop   : 10.0.99.0
</span><span id=__span-15-72><a id=__codelineno-15-72 name=__codelineno-15-72 href=#__codelineno-15-72></a>
</span><span id=__span-15-73><a id=__codelineno-15-73 name=__codelineno-15-73 href=#__codelineno-15-73></a>&lt;output omitted&gt;
</span><span id=__span-15-74><a id=__codelineno-15-74 name=__codelineno-15-74 href=#__codelineno-15-74></a>
</span><span id=__span-15-75><a id=__codelineno-15-75 name=__codelineno-15-75 href=#__codelineno-15-75></a>-------------------------------------------------------------------------------
</span><span id=__span-15-76><a id=__codelineno-15-76 name=__codelineno-15-76 href=#__codelineno-15-76></a>RIB Out Entries
</span><span id=__span-15-77><a id=__codelineno-15-77 name=__codelineno-15-77 href=#__codelineno-15-77></a>-------------------------------------------------------------------------------
</span><span id=__span-15-78><a id=__codelineno-15-78 name=__codelineno-15-78 href=#__codelineno-15-78></a>-------------------------------------------------------------------------------
</span><span id=__span-15-79><a id=__codelineno-15-79 name=__codelineno-15-79 href=#__codelineno-15-79></a>Routes : 1
</span><span id=__span-15-80><a id=__codelineno-15-80 name=__codelineno-15-80 href=#__codelineno-15-80></a>===============================================================================
</span><span id=__span-15-81><a id=__codelineno-15-81 name=__codelineno-15-81 href=#__codelineno-15-81></a>
</span><span id=__span-15-82><a id=__codelineno-15-82 name=__codelineno-15-82 href=#__codelineno-15-82></a>
</span><span id=__span-15-83><a id=__codelineno-15-83 name=__codelineno-15-83 href=#__codelineno-15-83></a>
</span><span id=__span-15-84><a id=__codelineno-15-84 name=__codelineno-15-84 href=#__codelineno-15-84></a>## and R1 now has no routes in its RIB In and Local-RIB databases.
</span><span id=__span-15-85><a id=__codelineno-15-85 name=__codelineno-15-85 href=#__codelineno-15-85></a>A:R1# show router bgp routes
</span><span id=__span-15-86><a id=__codelineno-15-86 name=__codelineno-15-86 href=#__codelineno-15-86></a>===============================================================================
</span><span id=__span-15-87><a id=__codelineno-15-87 name=__codelineno-15-87 href=#__codelineno-15-87></a> BGP Router ID:10.10.10.1       AS:65510       Local AS:65510
</span><span id=__span-15-88><a id=__codelineno-15-88 name=__codelineno-15-88 href=#__codelineno-15-88></a>===============================================================================
</span><span id=__span-15-89><a id=__codelineno-15-89 name=__codelineno-15-89 href=#__codelineno-15-89></a> Legend -
</span><span id=__span-15-90><a id=__codelineno-15-90 name=__codelineno-15-90 href=#__codelineno-15-90></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-15-91><a id=__codelineno-15-91 name=__codelineno-15-91 href=#__codelineno-15-91></a>                 l - leaked
</span><span id=__span-15-92><a id=__codelineno-15-92 name=__codelineno-15-92 href=#__codelineno-15-92></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-15-93><a id=__codelineno-15-93 name=__codelineno-15-93 href=#__codelineno-15-93></a>
</span><span id=__span-15-94><a id=__codelineno-15-94 name=__codelineno-15-94 href=#__codelineno-15-94></a>===============================================================================
</span><span id=__span-15-95><a id=__codelineno-15-95 name=__codelineno-15-95 href=#__codelineno-15-95></a>BGP IPv4 Routes
</span><span id=__span-15-96><a id=__codelineno-15-96 name=__codelineno-15-96 href=#__codelineno-15-96></a>===============================================================================
</span><span id=__span-15-97><a id=__codelineno-15-97 name=__codelineno-15-97 href=#__codelineno-15-97></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-15-98><a id=__codelineno-15-98 name=__codelineno-15-98 href=#__codelineno-15-98></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-15-99><a id=__codelineno-15-99 name=__codelineno-15-99 href=#__codelineno-15-99></a>      As-Path
</span><span id=__span-15-100><a id=__codelineno-15-100 name=__codelineno-15-100 href=#__codelineno-15-100></a>-------------------------------------------------------------------------------
</span><span id=__span-15-101><a id=__codelineno-15-101 name=__codelineno-15-101 href=#__codelineno-15-101></a>No Matching Entries Found
</span><span id=__span-15-102><a id=__codelineno-15-102 name=__codelineno-15-102 href=#__codelineno-15-102></a>===============================================================================
</span></code></pre></div> <h2 id=ebgp-resulting-configuration>eBGP resulting configuration<a class=headerlink href=#ebgp-resulting-configuration title="Permanent link">#</a></h2> <p>Check the resulting eBGP config that you would have on your routers at this moment:</p> <p>R1:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>A:R1&gt;config&gt;router&gt;bgp# info
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>----------------------------------------------
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>            group &quot;eBGP&quot;
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>                export &quot;R5_Customer_export&quot;
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>                peer-as 65520
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>                split-horizon
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>                neighbor 10.0.99.1
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>                exit
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>            exit
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>            no shutdown
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>----------------------------------------------
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>A:R1&gt;config&gt;router&gt;policy-options# info
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>----------------------------------------------
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>            prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>                prefix 10.10.55.0/24 exact
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>            exit
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>            policy-statement &quot;R5_Customer_export&quot;
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>                entry 10
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>                    from
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>                        prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>                    exit
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>                    to
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>                        protocol bgp
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>                    exit
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a>                    action accept
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a>                    exit
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a>                exit
</span><span id=__span-16-29><a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a>            exit
</span><span id=__span-16-30><a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a>----------------------------------------------
</span><span id=__span-16-31><a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a>
</span><span id=__span-16-32><a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a>A:R1# show router bgp neighbor 10.0.99.1 advertised-routes
</span><span id=__span-16-33><a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a>===============================================================================
</span><span id=__span-16-34><a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a> BGP Router ID:10.10.10.1       AS:65510       Local AS:65510
</span><span id=__span-16-35><a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a>===============================================================================
</span><span id=__span-16-36><a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a> Legend -
</span><span id=__span-16-37><a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-16-38><a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a>                 l - leaked
</span><span id=__span-16-39><a id=__codelineno-16-39 name=__codelineno-16-39 href=#__codelineno-16-39></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-16-40><a id=__codelineno-16-40 name=__codelineno-16-40 href=#__codelineno-16-40></a>
</span><span id=__span-16-41><a id=__codelineno-16-41 name=__codelineno-16-41 href=#__codelineno-16-41></a>===============================================================================
</span><span id=__span-16-42><a id=__codelineno-16-42 name=__codelineno-16-42 href=#__codelineno-16-42></a>BGP IPv4 Routes
</span><span id=__span-16-43><a id=__codelineno-16-43 name=__codelineno-16-43 href=#__codelineno-16-43></a>===============================================================================
</span><span id=__span-16-44><a id=__codelineno-16-44 name=__codelineno-16-44 href=#__codelineno-16-44></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-16-45><a id=__codelineno-16-45 name=__codelineno-16-45 href=#__codelineno-16-45></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-16-46><a id=__codelineno-16-46 name=__codelineno-16-46 href=#__codelineno-16-46></a>      As-Path
</span><span id=__span-16-47><a id=__codelineno-16-47 name=__codelineno-16-47 href=#__codelineno-16-47></a>-------------------------------------------------------------------------------
</span><span id=__span-16-48><a id=__codelineno-16-48 name=__codelineno-16-48 href=#__codelineno-16-48></a>i     10.10.55.0/24                                      n/a         100
</span><span id=__span-16-49><a id=__codelineno-16-49 name=__codelineno-16-49 href=#__codelineno-16-49></a>      10.0.99.0                                          None        -
</span><span id=__span-16-50><a id=__codelineno-16-50 name=__codelineno-16-50 href=#__codelineno-16-50></a>      65510
</span><span id=__span-16-51><a id=__codelineno-16-51 name=__codelineno-16-51 href=#__codelineno-16-51></a>-------------------------------------------------------------------------------
</span><span id=__span-16-52><a id=__codelineno-16-52 name=__codelineno-16-52 href=#__codelineno-16-52></a>Routes : 1
</span><span id=__span-16-53><a id=__codelineno-16-53 name=__codelineno-16-53 href=#__codelineno-16-53></a>===============================================================================
</span><span id=__span-16-54><a id=__codelineno-16-54 name=__codelineno-16-54 href=#__codelineno-16-54></a>
</span><span id=__span-16-55><a id=__codelineno-16-55 name=__codelineno-16-55 href=#__codelineno-16-55></a>
</span><span id=__span-16-56><a id=__codelineno-16-56 name=__codelineno-16-56 href=#__codelineno-16-56></a>A:R1# show router bgp neighbor 10.0.99.1 received-routes
</span><span id=__span-16-57><a id=__codelineno-16-57 name=__codelineno-16-57 href=#__codelineno-16-57></a>===============================================================================
</span><span id=__span-16-58><a id=__codelineno-16-58 name=__codelineno-16-58 href=#__codelineno-16-58></a> BGP Router ID:10.10.10.1       AS:65510       Local AS:65510
</span><span id=__span-16-59><a id=__codelineno-16-59 name=__codelineno-16-59 href=#__codelineno-16-59></a>===============================================================================
</span><span id=__span-16-60><a id=__codelineno-16-60 name=__codelineno-16-60 href=#__codelineno-16-60></a> Legend -
</span><span id=__span-16-61><a id=__codelineno-16-61 name=__codelineno-16-61 href=#__codelineno-16-61></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-16-62><a id=__codelineno-16-62 name=__codelineno-16-62 href=#__codelineno-16-62></a>                 l - leaked
</span><span id=__span-16-63><a id=__codelineno-16-63 name=__codelineno-16-63 href=#__codelineno-16-63></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-16-64><a id=__codelineno-16-64 name=__codelineno-16-64 href=#__codelineno-16-64></a>
</span><span id=__span-16-65><a id=__codelineno-16-65 name=__codelineno-16-65 href=#__codelineno-16-65></a>===============================================================================
</span><span id=__span-16-66><a id=__codelineno-16-66 name=__codelineno-16-66 href=#__codelineno-16-66></a>BGP IPv4 Routes
</span><span id=__span-16-67><a id=__codelineno-16-67 name=__codelineno-16-67 href=#__codelineno-16-67></a>===============================================================================
</span><span id=__span-16-68><a id=__codelineno-16-68 name=__codelineno-16-68 href=#__codelineno-16-68></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-16-69><a id=__codelineno-16-69 name=__codelineno-16-69 href=#__codelineno-16-69></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-16-70><a id=__codelineno-16-70 name=__codelineno-16-70 href=#__codelineno-16-70></a>      As-Path
</span><span id=__span-16-71><a id=__codelineno-16-71 name=__codelineno-16-71 href=#__codelineno-16-71></a>-------------------------------------------------------------------------------
</span><span id=__span-16-72><a id=__codelineno-16-72 name=__codelineno-16-72 href=#__codelineno-16-72></a>No Matching Entries Found
</span><span id=__span-16-73><a id=__codelineno-16-73 name=__codelineno-16-73 href=#__codelineno-16-73></a>===============================================================================
</span></code></pre></div> <p>R2:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>A:R2&gt;config&gt;router&gt;bgp# info
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>----------------------------------------------
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>            group &quot;eBGP&quot;
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>                export &quot;R5_Customer_export&quot;
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>                peer-as 65520
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>                split-horizon
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>                neighbor 10.0.99.3
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>                exit
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>            exit
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>            no shutdown
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>----------------------------------------------
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>A:R2&gt;config&gt;router&gt;policy-options# info
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>----------------------------------------------
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>            prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>                prefix 10.10.55.0/24 exact
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>            exit
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a>            policy-statement &quot;R5_Customer_export&quot;
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a>                entry 10
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a>                    from
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a>                        prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a>                    exit
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a>                    to
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a>                        protocol bgp
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a>                    exit
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a>                    action accept
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a>                    exit
</span><span id=__span-17-28><a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a>                exit
</span><span id=__span-17-29><a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a>            exit
</span><span id=__span-17-30><a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a>----------------------------------------------
</span><span id=__span-17-31><a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a>
</span><span id=__span-17-32><a id=__codelineno-17-32 name=__codelineno-17-32 href=#__codelineno-17-32></a>
</span><span id=__span-17-33><a id=__codelineno-17-33 name=__codelineno-17-33 href=#__codelineno-17-33></a>
</span><span id=__span-17-34><a id=__codelineno-17-34 name=__codelineno-17-34 href=#__codelineno-17-34></a>A:R2# show router bgp neighbor 10.0.99.3 advertised-routes
</span><span id=__span-17-35><a id=__codelineno-17-35 name=__codelineno-17-35 href=#__codelineno-17-35></a>===============================================================================
</span><span id=__span-17-36><a id=__codelineno-17-36 name=__codelineno-17-36 href=#__codelineno-17-36></a> BGP Router ID:10.10.10.2       AS:65510       Local AS:65510
</span><span id=__span-17-37><a id=__codelineno-17-37 name=__codelineno-17-37 href=#__codelineno-17-37></a>===============================================================================
</span><span id=__span-17-38><a id=__codelineno-17-38 name=__codelineno-17-38 href=#__codelineno-17-38></a> Legend -
</span><span id=__span-17-39><a id=__codelineno-17-39 name=__codelineno-17-39 href=#__codelineno-17-39></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-17-40><a id=__codelineno-17-40 name=__codelineno-17-40 href=#__codelineno-17-40></a>                 l - leaked
</span><span id=__span-17-41><a id=__codelineno-17-41 name=__codelineno-17-41 href=#__codelineno-17-41></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-17-42><a id=__codelineno-17-42 name=__codelineno-17-42 href=#__codelineno-17-42></a>
</span><span id=__span-17-43><a id=__codelineno-17-43 name=__codelineno-17-43 href=#__codelineno-17-43></a>===============================================================================
</span><span id=__span-17-44><a id=__codelineno-17-44 name=__codelineno-17-44 href=#__codelineno-17-44></a>BGP IPv4 Routes
</span><span id=__span-17-45><a id=__codelineno-17-45 name=__codelineno-17-45 href=#__codelineno-17-45></a>===============================================================================
</span><span id=__span-17-46><a id=__codelineno-17-46 name=__codelineno-17-46 href=#__codelineno-17-46></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-17-47><a id=__codelineno-17-47 name=__codelineno-17-47 href=#__codelineno-17-47></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-17-48><a id=__codelineno-17-48 name=__codelineno-17-48 href=#__codelineno-17-48></a>      As-Path
</span><span id=__span-17-49><a id=__codelineno-17-49 name=__codelineno-17-49 href=#__codelineno-17-49></a>-------------------------------------------------------------------------------
</span><span id=__span-17-50><a id=__codelineno-17-50 name=__codelineno-17-50 href=#__codelineno-17-50></a>i     10.10.55.0/24                                      n/a         200
</span><span id=__span-17-51><a id=__codelineno-17-51 name=__codelineno-17-51 href=#__codelineno-17-51></a>      10.0.99.2                                          None        -
</span><span id=__span-17-52><a id=__codelineno-17-52 name=__codelineno-17-52 href=#__codelineno-17-52></a>      65510
</span><span id=__span-17-53><a id=__codelineno-17-53 name=__codelineno-17-53 href=#__codelineno-17-53></a>-------------------------------------------------------------------------------
</span><span id=__span-17-54><a id=__codelineno-17-54 name=__codelineno-17-54 href=#__codelineno-17-54></a>Routes : 1
</span><span id=__span-17-55><a id=__codelineno-17-55 name=__codelineno-17-55 href=#__codelineno-17-55></a>===============================================================================
</span><span id=__span-17-56><a id=__codelineno-17-56 name=__codelineno-17-56 href=#__codelineno-17-56></a>
</span><span id=__span-17-57><a id=__codelineno-17-57 name=__codelineno-17-57 href=#__codelineno-17-57></a>
</span><span id=__span-17-58><a id=__codelineno-17-58 name=__codelineno-17-58 href=#__codelineno-17-58></a>
</span><span id=__span-17-59><a id=__codelineno-17-59 name=__codelineno-17-59 href=#__codelineno-17-59></a>A:R2# show router bgp neighbor 10.0.99.3 received-routes
</span><span id=__span-17-60><a id=__codelineno-17-60 name=__codelineno-17-60 href=#__codelineno-17-60></a>===============================================================================
</span><span id=__span-17-61><a id=__codelineno-17-61 name=__codelineno-17-61 href=#__codelineno-17-61></a> BGP Router ID:10.10.10.2       AS:65510       Local AS:65510
</span><span id=__span-17-62><a id=__codelineno-17-62 name=__codelineno-17-62 href=#__codelineno-17-62></a>===============================================================================
</span><span id=__span-17-63><a id=__codelineno-17-63 name=__codelineno-17-63 href=#__codelineno-17-63></a> Legend -
</span><span id=__span-17-64><a id=__codelineno-17-64 name=__codelineno-17-64 href=#__codelineno-17-64></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-17-65><a id=__codelineno-17-65 name=__codelineno-17-65 href=#__codelineno-17-65></a>                 l - leaked
</span><span id=__span-17-66><a id=__codelineno-17-66 name=__codelineno-17-66 href=#__codelineno-17-66></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-17-67><a id=__codelineno-17-67 name=__codelineno-17-67 href=#__codelineno-17-67></a>
</span><span id=__span-17-68><a id=__codelineno-17-68 name=__codelineno-17-68 href=#__codelineno-17-68></a>===============================================================================
</span><span id=__span-17-69><a id=__codelineno-17-69 name=__codelineno-17-69 href=#__codelineno-17-69></a>BGP IPv4 Routes
</span><span id=__span-17-70><a id=__codelineno-17-70 name=__codelineno-17-70 href=#__codelineno-17-70></a>===============================================================================
</span><span id=__span-17-71><a id=__codelineno-17-71 name=__codelineno-17-71 href=#__codelineno-17-71></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-17-72><a id=__codelineno-17-72 name=__codelineno-17-72 href=#__codelineno-17-72></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-17-73><a id=__codelineno-17-73 name=__codelineno-17-73 href=#__codelineno-17-73></a>      As-Path
</span><span id=__span-17-74><a id=__codelineno-17-74 name=__codelineno-17-74 href=#__codelineno-17-74></a>-------------------------------------------------------------------------------
</span><span id=__span-17-75><a id=__codelineno-17-75 name=__codelineno-17-75 href=#__codelineno-17-75></a>No Matching Entries Found
</span><span id=__span-17-76><a id=__codelineno-17-76 name=__codelineno-17-76 href=#__codelineno-17-76></a>===============================================================================
</span></code></pre></div> <p>R3:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a>A:R3&gt;config&gt;router&gt;bgp# info
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>----------------------------------------------
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>            group &quot;eBGP&quot;
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>                peer-as 65510
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>                split-horizon
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>                neighbor 10.0.99.0
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>                exit
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>            exit
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>            no shutdown
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>----------------------------------------------
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a>
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a>A:R3# show router bgp neighbor 10.0.99.0 advertised-routes
</span><span id=__span-18-16><a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a>===============================================================================
</span><span id=__span-18-17><a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a> BGP Router ID:10.20.20.3       AS:65520       Local AS:65520
</span><span id=__span-18-18><a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a>===============================================================================
</span><span id=__span-18-19><a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a> Legend -
</span><span id=__span-18-20><a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-18-21><a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a>                 l - leaked
</span><span id=__span-18-22><a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-18-23><a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a>
</span><span id=__span-18-24><a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a>===============================================================================
</span><span id=__span-18-25><a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a>BGP IPv4 Routes
</span><span id=__span-18-26><a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a>===============================================================================
</span><span id=__span-18-27><a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-18-28><a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-18-29><a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a>      As-Path
</span><span id=__span-18-30><a id=__codelineno-18-30 name=__codelineno-18-30 href=#__codelineno-18-30></a>-------------------------------------------------------------------------------
</span><span id=__span-18-31><a id=__codelineno-18-31 name=__codelineno-18-31 href=#__codelineno-18-31></a>No Matching Entries Found
</span><span id=__span-18-32><a id=__codelineno-18-32 name=__codelineno-18-32 href=#__codelineno-18-32></a>===============================================================================
</span><span id=__span-18-33><a id=__codelineno-18-33 name=__codelineno-18-33 href=#__codelineno-18-33></a>
</span><span id=__span-18-34><a id=__codelineno-18-34 name=__codelineno-18-34 href=#__codelineno-18-34></a>
</span><span id=__span-18-35><a id=__codelineno-18-35 name=__codelineno-18-35 href=#__codelineno-18-35></a>
</span><span id=__span-18-36><a id=__codelineno-18-36 name=__codelineno-18-36 href=#__codelineno-18-36></a>A:R3# show router bgp neighbor 10.0.99.0 received-routes
</span><span id=__span-18-37><a id=__codelineno-18-37 name=__codelineno-18-37 href=#__codelineno-18-37></a>===============================================================================
</span><span id=__span-18-38><a id=__codelineno-18-38 name=__codelineno-18-38 href=#__codelineno-18-38></a> BGP Router ID:10.20.20.3       AS:65520       Local AS:65520
</span><span id=__span-18-39><a id=__codelineno-18-39 name=__codelineno-18-39 href=#__codelineno-18-39></a>===============================================================================
</span><span id=__span-18-40><a id=__codelineno-18-40 name=__codelineno-18-40 href=#__codelineno-18-40></a> Legend -
</span><span id=__span-18-41><a id=__codelineno-18-41 name=__codelineno-18-41 href=#__codelineno-18-41></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-18-42><a id=__codelineno-18-42 name=__codelineno-18-42 href=#__codelineno-18-42></a>                 l - leaked
</span><span id=__span-18-43><a id=__codelineno-18-43 name=__codelineno-18-43 href=#__codelineno-18-43></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-18-44><a id=__codelineno-18-44 name=__codelineno-18-44 href=#__codelineno-18-44></a>
</span><span id=__span-18-45><a id=__codelineno-18-45 name=__codelineno-18-45 href=#__codelineno-18-45></a>===============================================================================
</span><span id=__span-18-46><a id=__codelineno-18-46 name=__codelineno-18-46 href=#__codelineno-18-46></a>BGP IPv4 Routes
</span><span id=__span-18-47><a id=__codelineno-18-47 name=__codelineno-18-47 href=#__codelineno-18-47></a>===============================================================================
</span><span id=__span-18-48><a id=__codelineno-18-48 name=__codelineno-18-48 href=#__codelineno-18-48></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-18-49><a id=__codelineno-18-49 name=__codelineno-18-49 href=#__codelineno-18-49></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-18-50><a id=__codelineno-18-50 name=__codelineno-18-50 href=#__codelineno-18-50></a>      As-Path
</span><span id=__span-18-51><a id=__codelineno-18-51 name=__codelineno-18-51 href=#__codelineno-18-51></a>-------------------------------------------------------------------------------
</span><span id=__span-18-52><a id=__codelineno-18-52 name=__codelineno-18-52 href=#__codelineno-18-52></a>u*&gt;i  10.10.55.0/24                                      n/a         100
</span><span id=__span-18-53><a id=__codelineno-18-53 name=__codelineno-18-53 href=#__codelineno-18-53></a>      10.0.99.0                                          None        -
</span><span id=__span-18-54><a id=__codelineno-18-54 name=__codelineno-18-54 href=#__codelineno-18-54></a>      65510
</span><span id=__span-18-55><a id=__codelineno-18-55 name=__codelineno-18-55 href=#__codelineno-18-55></a>-------------------------------------------------------------------------------
</span><span id=__span-18-56><a id=__codelineno-18-56 name=__codelineno-18-56 href=#__codelineno-18-56></a>Routes : 1
</span><span id=__span-18-57><a id=__codelineno-18-57 name=__codelineno-18-57 href=#__codelineno-18-57></a>===============================================================================
</span></code></pre></div> <p>R4:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>A:R4&gt;config&gt;router&gt;bgp# info
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>----------------------------------------------
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>            group &quot;eBGP&quot;
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>                peer-as 65510
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>                split-horizon
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>                neighbor 10.0.99.2
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>                exit
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>            exit
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a>            no shutdown
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a>----------------------------------------------
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a>A:R4# show router bgp neighbor 10.0.99.2 advertised-routes
</span><span id=__span-19-15><a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>===============================================================================
</span><span id=__span-19-16><a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a> BGP Router ID:10.20.20.4       AS:65520       Local AS:65520
</span><span id=__span-19-17><a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a>===============================================================================
</span><span id=__span-19-18><a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a> Legend -
</span><span id=__span-19-19><a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-19-20><a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a>                 l - leaked
</span><span id=__span-19-21><a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-19-22><a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a>
</span><span id=__span-19-23><a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a>===============================================================================
</span><span id=__span-19-24><a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a>BGP IPv4 Routes
</span><span id=__span-19-25><a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a>===============================================================================
</span><span id=__span-19-26><a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-19-27><a id=__codelineno-19-27 name=__codelineno-19-27 href=#__codelineno-19-27></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-19-28><a id=__codelineno-19-28 name=__codelineno-19-28 href=#__codelineno-19-28></a>      As-Path
</span><span id=__span-19-29><a id=__codelineno-19-29 name=__codelineno-19-29 href=#__codelineno-19-29></a>-------------------------------------------------------------------------------
</span><span id=__span-19-30><a id=__codelineno-19-30 name=__codelineno-19-30 href=#__codelineno-19-30></a>No Matching Entries Found
</span><span id=__span-19-31><a id=__codelineno-19-31 name=__codelineno-19-31 href=#__codelineno-19-31></a>===============================================================================
</span><span id=__span-19-32><a id=__codelineno-19-32 name=__codelineno-19-32 href=#__codelineno-19-32></a>
</span><span id=__span-19-33><a id=__codelineno-19-33 name=__codelineno-19-33 href=#__codelineno-19-33></a>
</span><span id=__span-19-34><a id=__codelineno-19-34 name=__codelineno-19-34 href=#__codelineno-19-34></a>
</span><span id=__span-19-35><a id=__codelineno-19-35 name=__codelineno-19-35 href=#__codelineno-19-35></a>
</span><span id=__span-19-36><a id=__codelineno-19-36 name=__codelineno-19-36 href=#__codelineno-19-36></a>A:R4# show router bgp neighbor 10.0.99.2 received-routes
</span><span id=__span-19-37><a id=__codelineno-19-37 name=__codelineno-19-37 href=#__codelineno-19-37></a>===============================================================================
</span><span id=__span-19-38><a id=__codelineno-19-38 name=__codelineno-19-38 href=#__codelineno-19-38></a> BGP Router ID:10.20.20.4       AS:65520       Local AS:65520
</span><span id=__span-19-39><a id=__codelineno-19-39 name=__codelineno-19-39 href=#__codelineno-19-39></a>===============================================================================
</span><span id=__span-19-40><a id=__codelineno-19-40 name=__codelineno-19-40 href=#__codelineno-19-40></a> Legend -
</span><span id=__span-19-41><a id=__codelineno-19-41 name=__codelineno-19-41 href=#__codelineno-19-41></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-19-42><a id=__codelineno-19-42 name=__codelineno-19-42 href=#__codelineno-19-42></a>                 l - leaked
</span><span id=__span-19-43><a id=__codelineno-19-43 name=__codelineno-19-43 href=#__codelineno-19-43></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-19-44><a id=__codelineno-19-44 name=__codelineno-19-44 href=#__codelineno-19-44></a>
</span><span id=__span-19-45><a id=__codelineno-19-45 name=__codelineno-19-45 href=#__codelineno-19-45></a>===============================================================================
</span><span id=__span-19-46><a id=__codelineno-19-46 name=__codelineno-19-46 href=#__codelineno-19-46></a>BGP IPv4 Routes
</span><span id=__span-19-47><a id=__codelineno-19-47 name=__codelineno-19-47 href=#__codelineno-19-47></a>===============================================================================
</span><span id=__span-19-48><a id=__codelineno-19-48 name=__codelineno-19-48 href=#__codelineno-19-48></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-19-49><a id=__codelineno-19-49 name=__codelineno-19-49 href=#__codelineno-19-49></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-19-50><a id=__codelineno-19-50 name=__codelineno-19-50 href=#__codelineno-19-50></a>      As-Path
</span><span id=__span-19-51><a id=__codelineno-19-51 name=__codelineno-19-51 href=#__codelineno-19-51></a>-------------------------------------------------------------------------------
</span><span id=__span-19-52><a id=__codelineno-19-52 name=__codelineno-19-52 href=#__codelineno-19-52></a>u*&gt;i  10.10.55.0/24                                      n/a         200
</span><span id=__span-19-53><a id=__codelineno-19-53 name=__codelineno-19-53 href=#__codelineno-19-53></a>      10.0.99.2                                          None        -
</span><span id=__span-19-54><a id=__codelineno-19-54 name=__codelineno-19-54 href=#__codelineno-19-54></a>      65510
</span><span id=__span-19-55><a id=__codelineno-19-55 name=__codelineno-19-55 href=#__codelineno-19-55></a>-------------------------------------------------------------------------------
</span><span id=__span-19-56><a id=__codelineno-19-56 name=__codelineno-19-56 href=#__codelineno-19-56></a>Routes : 1
</span><span id=__span-19-57><a id=__codelineno-19-57 name=__codelineno-19-57 href=#__codelineno-19-57></a>===============================================================================
</span></code></pre></div> <h2 id=ibgp-configuration>iBGP configuration<a class=headerlink href=#ibgp-configuration title="Permanent link">#</a></h2> <p>iBGP sessions are established inside BGP Autonomous System and are used to distribute BGP routes between the routers there. In our case we have two Autonomous Systems, so we will configure full mesh of iBGP sessions within AS 65510 and AS 66520:</p> <p><a class=glightbox href=http://img-fotki.yandex.ru/get/6527/21639405.11c/0_84ca3_3adf0431_orig.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=pic src=http://img-fotki.yandex.ru/get/6527/21639405.11c/0_84ca3_3adf0431_orig.png></a></p> <p>The reason we need to provide a full-mesh of iBGP sessions is dictated by the <a href=https://supportforums.cisco.com/discussion/11487611/why-we-need-bgp-split-horizon-rule>iBGP split-horizon rule</a>. Starting with AS 65510, configure <em>iBGP</em> peer group for every router inside this AS and specify the other routers <code>system</code> IP addresses as a neighbor. For iBGP it is quite common to use <code>system</code> or loopback IP address (in contrast with link addresses used in eBGP) as a neighbor address because this enables IGP path redundancy.</p> <p>Configuration sequence is straightforward:</p> <ol> <li>create "iBGP" peer group</li> <li>set local AS Number as a <code>peer-as</code> inside the iBGP peer group</li> <li>specify the neighbors using their <code>system</code> interface addresses</li> </ol> <div class="language-text highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>## repeat configuration steps on all routers in AS 65510 and AS 65520
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>*A:R1# configure router bgp group &quot;iBGP&quot;
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>*A:R1&gt;config&gt;router&gt;bgp&gt;group# info
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>----------------------------------------------
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>                ## iBGP peers share the same AS Number in peer-as command 
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>                peer-as 65510
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>                neighbor 10.10.10.2
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a>                exit
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>                neighbor 10.10.10.5
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>                exit
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a>                neighbor 10.10.10.6
</span><span id=__span-20-12><a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a>                exit
</span><span id=__span-20-13><a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a>----------------------------------------------
</span></code></pre></div> <p>Note, that you do not need to specify the local-address statement (though it is not prohibited) since SROS router will initiate TCP socket opening from its system IP address by default.</p> <p>To verify that iBGP sessions have been successfully established you can use good-old <code>show router bgp summary</code> or fancy <code>show router bgp group &lt;group name&gt;</code> commands:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>A:R1# show router bgp group &quot;iBGP&quot;
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>===============================================================================
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>BGP Group : iBGP
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>===============================================================================
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>-------------------------------------------------------------------------------
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>Group            : iBGP
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>-------------------------------------------------------------------------------
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>Description      : (Not Specified)
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>Group Type       : No Type              State            : Up
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>Peer AS          : 65510                Local AS         : 65510
</span><span id=__span-21-12><a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a>Local Address    : n/a                  Loop Detect      : Ignore
</span><span id=__span-21-13><a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>Import Policy    : None Specified / Inherited
</span><span id=__span-21-14><a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a>Export Policy    : None Specified / Inherited
</span><span id=__span-21-15><a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a>Hold Time        : 90                   Keep Alive       : 30
</span><span id=__span-21-16><a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a>Min Hold Time    : 0
</span><span id=__span-21-17><a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a>Cluster Id       : None                 Client Reflect   : Enabled
</span><span id=__span-21-18><a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a>NLRI             : Unicast              Preference       : 170
</span><span id=__span-21-19><a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a>TTL Security     : Disabled             Min TTL Value    : n/a
</span><span id=__span-21-20><a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a>Graceful Restart : Disabled             Stale Routes Time: n/a
</span><span id=__span-21-21><a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a>Restart Time     : n/a
</span><span id=__span-21-22><a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a>Auth key chain   : n/a
</span><span id=__span-21-23><a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a>Bfd Enabled      : Disabled             Disable Cap Nego : Disabled
</span><span id=__span-21-24><a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a>Creation Origin  : manual
</span><span id=__span-21-25><a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a>Flowspec Validate: Disabled             Default Route Tgt: Disabled
</span><span id=__span-21-26><a id=__codelineno-21-26 name=__codelineno-21-26 href=#__codelineno-21-26></a>Aigp Metric      : Disabled
</span><span id=__span-21-27><a id=__codelineno-21-27 name=__codelineno-21-27 href=#__codelineno-21-27></a>Split Horizon    : Disabled
</span><span id=__span-21-28><a id=__codelineno-21-28 name=__codelineno-21-28 href=#__codelineno-21-28></a>Damp Peer Oscill*: Disabled
</span><span id=__span-21-29><a id=__codelineno-21-29 name=__codelineno-21-29 href=#__codelineno-21-29></a>GR Notification  : Disabled             Fault Tolerance  : Disabled
</span><span id=__span-21-30><a id=__codelineno-21-30 name=__codelineno-21-30 href=#__codelineno-21-30></a>Next-Hop Unchang*: None
</span><span id=__span-21-31><a id=__codelineno-21-31 name=__codelineno-21-31 href=#__codelineno-21-31></a>
</span><span id=__span-21-32><a id=__codelineno-21-32 name=__codelineno-21-32 href=#__codelineno-21-32></a>List of Peers
</span><span id=__span-21-33><a id=__codelineno-21-33 name=__codelineno-21-33 href=#__codelineno-21-33></a>- 10.10.10.2 :
</span><span id=__span-21-34><a id=__codelineno-21-34 name=__codelineno-21-34 href=#__codelineno-21-34></a>- 10.10.10.5 :
</span><span id=__span-21-35><a id=__codelineno-21-35 name=__codelineno-21-35 href=#__codelineno-21-35></a>- 10.10.10.6 :
</span><span id=__span-21-36><a id=__codelineno-21-36 name=__codelineno-21-36 href=#__codelineno-21-36></a>
</span><span id=__span-21-37><a id=__codelineno-21-37 name=__codelineno-21-37 href=#__codelineno-21-37></a>Total Peers      : 3                    Established      : 3
</span><span id=__span-21-38><a id=__codelineno-21-38 name=__codelineno-21-38 href=#__codelineno-21-38></a>-------------------------------------------------------------------------------
</span><span id=__span-21-39><a id=__codelineno-21-39 name=__codelineno-21-39 href=#__codelineno-21-39></a>Peer Groups : 1
</span><span id=__span-21-40><a id=__codelineno-21-40 name=__codelineno-21-40 href=#__codelineno-21-40></a>===============================================================================
</span></code></pre></div> <p>Ok, now we got iBGP full-mesh configured for both ASes but to start playing with iBGP let me introduce you to another customer network - <code>R3_Ext_Customer - 172.16.33.0/24</code>. This customer network resides beside R3 and you should add it to the BGP with the same policies/export routine as we did before for <code>R5_Customer</code>.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>## 1. create interface to emulate R3_Ext_Customer network
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>*A:R3# configure router interface R3_Ext_Customer
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>*A:R3&gt;config&gt;router&gt;if$ address 172.16.33.1/24
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>*A:R3&gt;config&gt;router&gt;if$ loopback
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>## 2. configure policy statement to export specific prefix to bgp
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>*A:R3&gt;config&gt;router&gt;policy-options# info
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>----------------------------------------------
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a>            prefix-list &quot;R3_Ext_Customer&quot;
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>                prefix 172.16.33.0/24 exact
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a>            exit
</span><span id=__span-22-12><a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a>            policy-statement &quot;export_R3_Ext_Customer&quot;
</span><span id=__span-22-13><a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a>                entry 10
</span><span id=__span-22-14><a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a>                    from
</span><span id=__span-22-15><a id=__codelineno-22-15 name=__codelineno-22-15 href=#__codelineno-22-15></a>                        prefix-list &quot;R3_Ext_Customer&quot;
</span><span id=__span-22-16><a id=__codelineno-22-16 name=__codelineno-22-16 href=#__codelineno-22-16></a>                    exit
</span><span id=__span-22-17><a id=__codelineno-22-17 name=__codelineno-22-17 href=#__codelineno-22-17></a>                    to
</span><span id=__span-22-18><a id=__codelineno-22-18 name=__codelineno-22-18 href=#__codelineno-22-18></a>                        protocol bgp
</span><span id=__span-22-19><a id=__codelineno-22-19 name=__codelineno-22-19 href=#__codelineno-22-19></a>                    exit
</span><span id=__span-22-20><a id=__codelineno-22-20 name=__codelineno-22-20 href=#__codelineno-22-20></a>                    action accept
</span><span id=__span-22-21><a id=__codelineno-22-21 name=__codelineno-22-21 href=#__codelineno-22-21></a>                    exit
</span><span id=__span-22-22><a id=__codelineno-22-22 name=__codelineno-22-22 href=#__codelineno-22-22></a>                exit
</span><span id=__span-22-23><a id=__codelineno-22-23 name=__codelineno-22-23 href=#__codelineno-22-23></a>            exit
</span><span id=__span-22-24><a id=__codelineno-22-24 name=__codelineno-22-24 href=#__codelineno-22-24></a>----------------------------------------------
</span><span id=__span-22-25><a id=__codelineno-22-25 name=__codelineno-22-25 href=#__codelineno-22-25></a>
</span><span id=__span-22-26><a id=__codelineno-22-26 name=__codelineno-22-26 href=#__codelineno-22-26></a>## 3. export
</span><span id=__span-22-27><a id=__codelineno-22-27 name=__codelineno-22-27 href=#__codelineno-22-27></a>*A:R3# configure router bgp group &quot;eBGP&quot; export &quot;export_R3_Ext_Customer&quot;
</span></code></pre></div> <p>What happens next? Correct, <code>R3_Ext_Customer</code> NLRI goes from R3 to R1 via eBGP. R1 checks if this NLRI is valid by checking the AS Path for looping and the next-hop for reachability.</p> <p>Since the default behavior of the eBGP is to set its <strong>egress</strong> interface's IP address as a next-hop, we see that R1 receives BGP routes with <code>10.0.99.1</code> address as the next-hop:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>A:R1# show router bgp neighbor 10.0.99.1 received-routes
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>===============================================================================
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a> BGP Router ID:10.10.10.1       AS:65510       Local AS:65510
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>===============================================================================
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a> Legend -
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>                 l - leaked
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a>===============================================================================
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a>BGP IPv4 Routes
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>===============================================================================
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-23-15><a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a>      As-Path
</span><span id=__span-23-16><a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a>-------------------------------------------------------------------------------
</span><span id=__span-23-17><a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a>u*&gt;i  172.16.33.0/24                                     n/a         None
</span><span id=__span-23-18><a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a>      10.0.99.1                                          None        -
</span><span id=__span-23-19><a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a>      65520
</span><span id=__span-23-20><a id=__codelineno-23-20 name=__codelineno-23-20 href=#__codelineno-23-20></a>-------------------------------------------------------------------------------
</span><span id=__span-23-21><a id=__codelineno-23-21 name=__codelineno-23-21 href=#__codelineno-23-21></a>Routes : 1
</span><span id=__span-23-22><a id=__codelineno-23-22 name=__codelineno-23-22 href=#__codelineno-23-22></a>===============================================================================
</span></code></pre></div> <p>This next-hop is reachable to R1 since it has <code>toR3</code> interface in this network. So R1 has every right to pass NLRI <code>10.0.99.1</code> to the <em>BGP Local-RIB</em> and then to the Routing Table Manager (RTM then installs this route to R1's routing table).</p> <p>And now iBGP on R1 comes into play by advertising NLRI <code>10.0.99.1</code> to its iBGP peers. This is the default BGP's behavior to advertise valid BGP routes came from eBGP peer to all iBGP peers, and the most important part of this eBGP-&gt;iBGP redistribution is that the <strong>next-hop</strong> once set by eBGP peer (R3 in our case) <strong>goes unchanged</strong> in iBGP updates:</p> <p><a class=glightbox href=http://img-fotki.yandex.ru/get/36/21639405.11c/0_84ca4_7c4fdef1_orig.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=pic src=http://img-fotki.yandex.ru/get/36/21639405.11c/0_84ca4_7c4fdef1_orig.png></a></p> <p>Take a look at R5's BGP routes:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>A:R5# show router bgp routes
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>===============================================================================
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a> BGP Router ID:10.10.10.5       AS:65510       Local AS:65510
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>===============================================================================
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a> Legend -
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>                 l - leaked
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>===============================================================================
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>BGP IPv4 Routes
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>===============================================================================
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-24-15><a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a>      As-Path
</span><span id=__span-24-16><a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a>-------------------------------------------------------------------------------
</span><span id=__span-24-17><a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a>i     172.16.33.0/24                                     100         None
</span><span id=__span-24-18><a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a>      10.0.99.1                                          None        -
</span><span id=__span-24-19><a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a>      65520
</span><span id=__span-24-20><a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a>-------------------------------------------------------------------------------
</span><span id=__span-24-21><a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a>Routes : 1
</span><span id=__span-24-22><a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a>===============================================================================
</span></code></pre></div> <p>R5 received <code>R3_Ext_Customer 172.16.33.0/24</code> NLRI but it cant use it (<code>u</code> flag is absent). Invoke <code>hunt</code> command to see whats wrong:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>A:R5# show router bgp routes 172.16.33.0/24 hunt
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>===============================================================================
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a> BGP Router ID:10.10.10.5       AS:65510       Local AS:65510
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>===============================================================================
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a> Legend -
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>                 l - leaked
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>===============================================================================
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a>BGP IPv4 Routes
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a>===============================================================================
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a>-------------------------------------------------------------------------------
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a>RIB In Entries
</span><span id=__span-25-15><a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a>-------------------------------------------------------------------------------
</span><span id=__span-25-16><a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a>Network        : 172.16.33.0/24
</span><span id=__span-25-17><a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a>Nexthop        : 10.0.99.1
</span><span id=__span-25-18><a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a>Path Id        : None
</span><span id=__span-25-19><a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a>From           : 10.10.10.1
</span><span id=__span-25-20><a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a>Res. Nexthop   : Unresolved
</span><span id=__span-25-21><a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a>Local Pref.    : 100                    Interface Name : NotAvailable
</span><span id=__span-25-22><a id=__codelineno-25-22 name=__codelineno-25-22 href=#__codelineno-25-22></a>Aggregator AS  : None                   Aggregator     : None
</span><span id=__span-25-23><a id=__codelineno-25-23 name=__codelineno-25-23 href=#__codelineno-25-23></a>Atomic Aggr.   : Not Atomic             MED            : None
</span><span id=__span-25-24><a id=__codelineno-25-24 name=__codelineno-25-24 href=#__codelineno-25-24></a>AIGP Metric    : None
</span><span id=__span-25-25><a id=__codelineno-25-25 name=__codelineno-25-25 href=#__codelineno-25-25></a>Connector      : None
</span><span id=__span-25-26><a id=__codelineno-25-26 name=__codelineno-25-26 href=#__codelineno-25-26></a>Community      : No Community Members
</span><span id=__span-25-27><a id=__codelineno-25-27 name=__codelineno-25-27 href=#__codelineno-25-27></a>Cluster        : No Cluster Members
</span><span id=__span-25-28><a id=__codelineno-25-28 name=__codelineno-25-28 href=#__codelineno-25-28></a>Originator Id  : None                   Peer Router Id : 10.10.10.1
</span><span id=__span-25-29><a id=__codelineno-25-29 name=__codelineno-25-29 href=#__codelineno-25-29></a>Fwd Class      : None                   Priority       : None
</span><span id=__span-25-30><a id=__codelineno-25-30 name=__codelineno-25-30 href=#__codelineno-25-30></a>Flags          : Invalid  IGP  Nexthop-Unresolved
</span><span id=__span-25-31><a id=__codelineno-25-31 name=__codelineno-25-31 href=#__codelineno-25-31></a>Route Source   : Internal
</span><span id=__span-25-32><a id=__codelineno-25-32 name=__codelineno-25-32 href=#__codelineno-25-32></a>AS-Path        : 65520
</span><span id=__span-25-33><a id=__codelineno-25-33 name=__codelineno-25-33 href=#__codelineno-25-33></a>Route Tag      : 0
</span><span id=__span-25-34><a id=__codelineno-25-34 name=__codelineno-25-34 href=#__codelineno-25-34></a>Neighbor-AS    : 65520
</span><span id=__span-25-35><a id=__codelineno-25-35 name=__codelineno-25-35 href=#__codelineno-25-35></a>Orig Validation: NotFound
</span><span id=__span-25-36><a id=__codelineno-25-36 name=__codelineno-25-36 href=#__codelineno-25-36></a>Source Class   : 0                      Dest Class     : 0
</span><span id=__span-25-37><a id=__codelineno-25-37 name=__codelineno-25-37 href=#__codelineno-25-37></a>
</span><span id=__span-25-38><a id=__codelineno-25-38 name=__codelineno-25-38 href=#__codelineno-25-38></a>-------------------------------------------------------------------------------
</span><span id=__span-25-39><a id=__codelineno-25-39 name=__codelineno-25-39 href=#__codelineno-25-39></a>RIB Out Entries
</span><span id=__span-25-40><a id=__codelineno-25-40 name=__codelineno-25-40 href=#__codelineno-25-40></a>-------------------------------------------------------------------------------
</span><span id=__span-25-41><a id=__codelineno-25-41 name=__codelineno-25-41 href=#__codelineno-25-41></a>-------------------------------------------------------------------------------
</span><span id=__span-25-42><a id=__codelineno-25-42 name=__codelineno-25-42 href=#__codelineno-25-42></a>Routes : 1
</span><span id=__span-25-43><a id=__codelineno-25-43 name=__codelineno-25-43 href=#__codelineno-25-43></a>===============================================================================
</span></code></pre></div> <p>Aha, R5 cant validate received NLRI since its next-hop is unresolvable to R5. Recall the R1 did not change next-hop information it received from R3, so R5 received the same IP address <code>10.0.99.1</code> as a next-hop and R5 has no route towards it. That is the reason that R5's routing table has no network <code>10.0.99.1</code>:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a>A:R5# show router route-table 176.16.33.0/24
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>===============================================================================
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>Route Table (Router: Base)
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>===============================================================================
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>Dest Prefix[Flags]                            Type    Proto     Age        Pref
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>      Next Hop[Interface Name]                                    Metric
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>-------------------------------------------------------------------------------
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>-------------------------------------------------------------------------------
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>No. of Routes: 0
</span></code></pre></div> <p>There are two approaches to fix this:</p> <ol> <li>use <code>next-hop-self</code> command on R1</li> <li>adding eBGP interfaces to IGP process (as passive interface) making them known to every router participating in the IGP domain. Or implementing static or default routes in AS 65510 to reach R3's interface network</li> </ol> <p>We will stick to the first option.</p> <h3 id=ibgp-next-hop-self>iBGP next-hop-self<a class=headerlink href=#ibgp-next-hop-self title="Permanent link">#</a></h3> <p>The <code>next-hop-self</code> command forces iBGP speaker, who received an eBGP update message to substitute next-hop information with its <code>system</code> IP address.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a>A:R1# configure router bgp group &quot;iBGP&quot;
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>A:R1&gt;config&gt;router&gt;bgp&gt;group# next-hop-self
</span></code></pre></div> <p>Get back to R5 and check whats changed:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a>A:R5# show router bgp routes
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>===============================================================================
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a> BGP Router ID:10.10.10.5       AS:65510       Local AS:65510
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>===============================================================================
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a> Legend -
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a> Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>                 l - leaked
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a> Origin codes  : i - IGP, e - EGP, ? - incomplete, &gt; - best, b - backup
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>===============================================================================
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>BGP IPv4 Routes
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>===============================================================================
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>Flag  Network                                            LocalPref   MED
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a>      Nexthop (Router)                                   Path-Id     Label
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>      As-Path
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a>-------------------------------------------------------------------------------
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>u*&gt;i  172.16.33.0/24                                     100         None
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>      10.10.10.1                                         None        -
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>      65520
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a>-------------------------------------------------------------------------------
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a>Routes : 1
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>===============================================================================
</span></code></pre></div> <p>Now it is a totally different story! R5 successfully validates the received NLRI and can use it thanks to resolvable next-hop which is R1's system IP address <code>10.10.10.1</code>.</p> <p>The next step is to pass this route to the RTM which is responsible for routing-table provisioning. If we take a look at R5 routing table for the recently received <code>172.16.33.0/24</code> prefix we will see that next-hop isn't <code>10.10.10.1</code>:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>A:R5# show router route-table 172.16.33.0/24
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>===============================================================================
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a>Route Table (Router: Base)
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>===============================================================================
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a>Dest Prefix[Flags]                            Type    Proto     Age        Pref
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a>      Next Hop[Interface Name]                                    Metric
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a>-------------------------------------------------------------------------------
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a>172.16.33.0/24                                Remote  BGP       00h41m45s  170
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a>       10.10.99.4                                                   0
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a>-------------------------------------------------------------------------------
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a>No. of Routes: 1
</span></code></pre></div> <p>The reason behind this discrepancy is that the routing table should have connected networks as a next-hop and since <code>10.10.10.1</code> is far from being connected to R5 it performs an operation called <strong>recursive lookup</strong>. R5 takes next-hop value received from the iBGP update <code>10.10.10.1</code> and performs the route-table lookup:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a>A:R5# show router route-table 10.10.10.1
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>===============================================================================
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a>Route Table (Router: Base)
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a>===============================================================================
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a>Dest Prefix[Flags]                            Type    Proto     Age        Pref
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a>      Next Hop[Interface Name]                                    Metric
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>-------------------------------------------------------------------------------
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a>10.10.10.1/32                                 Remote  ISIS      00h44m28s  15
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a>       10.10.99.4                                                   100
</span><span id=__span-30-11><a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>-------------------------------------------------------------------------------
</span><span id=__span-30-12><a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>No. of Routes: 1
</span></code></pre></div> <p>R5 knows how to reach <code>10.10.10.1</code> by means of IS-IS protocol and the next-hop for this prefix is indeed <code>10.10.99.4</code> which is a connected network:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>A:R5# show router route-table 10.10.99.4
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>===============================================================================
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a>Route Table (Router: Base)
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>===============================================================================
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>Dest Prefix[Flags]                            Type    Proto     Age        Pref
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a>      Next Hop[Interface Name]                                    Metric
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a>-------------------------------------------------------------------------------
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a>10.10.99.4/31                                 Local   Local     00h44m45s  0
</span><span id=__span-31-10><a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a>       toR1                                                         0
</span><span id=__span-31-11><a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a>-------------------------------------------------------------------------------
</span><span id=__span-31-12><a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a>No. of Routes: 1
</span></code></pre></div> <p>That is why we see a different next-hop in the routing and BGP Local-RIB tables.</p> <h2 id=wrapping-up>Wrapping up<a class=headerlink href=#wrapping-up title="Permanent link">#</a></h2> <p>To this moment we have done a good job - we have configured the peering between two autonomous systems AS 65510 and AS 65520 and successfully exchanged the prefixes. Now, a client residing in the <em>R3_Ext_Customer</em> network can reach hosts from the <em>R5_Customer</em> network:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>## we have to specify a source address for ping to success,
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>## since by default ALU routers perform ping from their system interface
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>## and AS 65510 know nothing about system addresses of foreign AS.
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>A:R3# ping 10.10.55.1 source 172.16.33.1 
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>PING 10.10.55.1 56 data bytes
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>64 bytes from 10.10.55.1: icmp_seq=1 ttl=63 time=9.38ms.
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>64 bytes from 10.10.55.1: icmp_seq=2 ttl=63 time=3.58ms.
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>64 bytes from 10.10.55.1: icmp_seq=3 ttl=63 time=3.13ms.
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>64 bytes from 10.10.55.1: icmp_seq=4 ttl=63 time=28.7ms.
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>64 bytes from 10.10.55.1: icmp_seq=5 ttl=63 time=103ms.
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a>
</span><span id=__span-32-12><a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>---- 10.10.55.1 PING Statistics ----
</span><span id=__span-32-13><a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a>5 packets transmitted, 5 packets received, 0.00% packet loss
</span></code></pre></div> <p>This was accomplished by mutual exchange of the corresponding routes both via eBGP and iBGP protocols.</p> <p>If some of you want to get the full picture - see this configuration snapshot captured on every router of this topology:</p> <p>R1:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>#--------------------------------------------------
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>echo &quot;Router (Network Side) Configuration&quot;
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>#--------------------------------------------------
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>    router 
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>        interface &quot;system&quot;
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>            address 10.10.10.1/32
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>            no shutdown
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>        exit
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a>        interface &quot;toR2&quot;
</span><span id=__span-33-10><a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>            address 10.10.99.0/31
</span><span id=__span-33-11><a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a>            port 1/1/1
</span><span id=__span-33-12><a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a>            no shutdown
</span><span id=__span-33-13><a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a>        exit
</span><span id=__span-33-14><a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a>        interface &quot;toR3&quot;
</span><span id=__span-33-15><a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a>            address 10.0.99.0/31
</span><span id=__span-33-16><a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a>            port 1/1/3
</span><span id=__span-33-17><a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a>            no shutdown
</span><span id=__span-33-18><a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a>        exit
</span><span id=__span-33-19><a id=__codelineno-33-19 name=__codelineno-33-19 href=#__codelineno-33-19></a>        interface &quot;toR5&quot;
</span><span id=__span-33-20><a id=__codelineno-33-20 name=__codelineno-33-20 href=#__codelineno-33-20></a>            address 10.10.99.4/31
</span><span id=__span-33-21><a id=__codelineno-33-21 name=__codelineno-33-21 href=#__codelineno-33-21></a>            port 1/1/4
</span><span id=__span-33-22><a id=__codelineno-33-22 name=__codelineno-33-22 href=#__codelineno-33-22></a>            no shutdown
</span><span id=__span-33-23><a id=__codelineno-33-23 name=__codelineno-33-23 href=#__codelineno-33-23></a>        exit                          
</span><span id=__span-33-24><a id=__codelineno-33-24 name=__codelineno-33-24 href=#__codelineno-33-24></a>        autonomous-system 65510
</span><span id=__span-33-25><a id=__codelineno-33-25 name=__codelineno-33-25 href=#__codelineno-33-25></a>#--------------------------------------------------
</span><span id=__span-33-26><a id=__codelineno-33-26 name=__codelineno-33-26 href=#__codelineno-33-26></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-33-27><a id=__codelineno-33-27 name=__codelineno-33-27 href=#__codelineno-33-27></a>#--------------------------------------------------
</span><span id=__span-33-28><a id=__codelineno-33-28 name=__codelineno-33-28 href=#__codelineno-33-28></a>        ospf
</span><span id=__span-33-29><a id=__codelineno-33-29 name=__codelineno-33-29 href=#__codelineno-33-29></a>            no shutdown
</span><span id=__span-33-30><a id=__codelineno-33-30 name=__codelineno-33-30 href=#__codelineno-33-30></a>        exit
</span><span id=__span-33-31><a id=__codelineno-33-31 name=__codelineno-33-31 href=#__codelineno-33-31></a>#--------------------------------------------------
</span><span id=__span-33-32><a id=__codelineno-33-32 name=__codelineno-33-32 href=#__codelineno-33-32></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-33-33><a id=__codelineno-33-33 name=__codelineno-33-33 href=#__codelineno-33-33></a>#--------------------------------------------------
</span><span id=__span-33-34><a id=__codelineno-33-34 name=__codelineno-33-34 href=#__codelineno-33-34></a>        isis
</span><span id=__span-33-35><a id=__codelineno-33-35 name=__codelineno-33-35 href=#__codelineno-33-35></a>            level-capability level-1
</span><span id=__span-33-36><a id=__codelineno-33-36 name=__codelineno-33-36 href=#__codelineno-33-36></a>            area-id 10.10
</span><span id=__span-33-37><a id=__codelineno-33-37 name=__codelineno-33-37 href=#__codelineno-33-37></a>            reference-bandwidth 100000000
</span><span id=__span-33-38><a id=__codelineno-33-38 name=__codelineno-33-38 href=#__codelineno-33-38></a>            level 1
</span><span id=__span-33-39><a id=__codelineno-33-39 name=__codelineno-33-39 href=#__codelineno-33-39></a>                wide-metrics-only
</span><span id=__span-33-40><a id=__codelineno-33-40 name=__codelineno-33-40 href=#__codelineno-33-40></a>            exit
</span><span id=__span-33-41><a id=__codelineno-33-41 name=__codelineno-33-41 href=#__codelineno-33-41></a>            level 2
</span><span id=__span-33-42><a id=__codelineno-33-42 name=__codelineno-33-42 href=#__codelineno-33-42></a>                wide-metrics-only     
</span><span id=__span-33-43><a id=__codelineno-33-43 name=__codelineno-33-43 href=#__codelineno-33-43></a>            exit
</span><span id=__span-33-44><a id=__codelineno-33-44 name=__codelineno-33-44 href=#__codelineno-33-44></a>            interface &quot;system&quot;
</span><span id=__span-33-45><a id=__codelineno-33-45 name=__codelineno-33-45 href=#__codelineno-33-45></a>                no shutdown
</span><span id=__span-33-46><a id=__codelineno-33-46 name=__codelineno-33-46 href=#__codelineno-33-46></a>            exit
</span><span id=__span-33-47><a id=__codelineno-33-47 name=__codelineno-33-47 href=#__codelineno-33-47></a>            interface &quot;toR2&quot;
</span><span id=__span-33-48><a id=__codelineno-33-48 name=__codelineno-33-48 href=#__codelineno-33-48></a>                interface-type point-to-point
</span><span id=__span-33-49><a id=__codelineno-33-49 name=__codelineno-33-49 href=#__codelineno-33-49></a>                no shutdown
</span><span id=__span-33-50><a id=__codelineno-33-50 name=__codelineno-33-50 href=#__codelineno-33-50></a>            exit
</span><span id=__span-33-51><a id=__codelineno-33-51 name=__codelineno-33-51 href=#__codelineno-33-51></a>            interface &quot;toR5&quot;
</span><span id=__span-33-52><a id=__codelineno-33-52 name=__codelineno-33-52 href=#__codelineno-33-52></a>                interface-type point-to-point
</span><span id=__span-33-53><a id=__codelineno-33-53 name=__codelineno-33-53 href=#__codelineno-33-53></a>                no shutdown
</span><span id=__span-33-54><a id=__codelineno-33-54 name=__codelineno-33-54 href=#__codelineno-33-54></a>            exit
</span><span id=__span-33-55><a id=__codelineno-33-55 name=__codelineno-33-55 href=#__codelineno-33-55></a>            no shutdown
</span><span id=__span-33-56><a id=__codelineno-33-56 name=__codelineno-33-56 href=#__codelineno-33-56></a>        exit
</span><span id=__span-33-57><a id=__codelineno-33-57 name=__codelineno-33-57 href=#__codelineno-33-57></a>    exit
</span><span id=__span-33-58><a id=__codelineno-33-58 name=__codelineno-33-58 href=#__codelineno-33-58></a>
</span><span id=__span-33-59><a id=__codelineno-33-59 name=__codelineno-33-59 href=#__codelineno-33-59></a>#--------------------------------------------------
</span><span id=__span-33-60><a id=__codelineno-33-60 name=__codelineno-33-60 href=#__codelineno-33-60></a>echo &quot;Service Configuration&quot;
</span><span id=__span-33-61><a id=__codelineno-33-61 name=__codelineno-33-61 href=#__codelineno-33-61></a>#--------------------------------------------------
</span><span id=__span-33-62><a id=__codelineno-33-62 name=__codelineno-33-62 href=#__codelineno-33-62></a>    service
</span><span id=__span-33-63><a id=__codelineno-33-63 name=__codelineno-33-63 href=#__codelineno-33-63></a>        customer 1 create
</span><span id=__span-33-64><a id=__codelineno-33-64 name=__codelineno-33-64 href=#__codelineno-33-64></a>            description &quot;Default customer&quot;
</span><span id=__span-33-65><a id=__codelineno-33-65 name=__codelineno-33-65 href=#__codelineno-33-65></a>        exit                          
</span><span id=__span-33-66><a id=__codelineno-33-66 name=__codelineno-33-66 href=#__codelineno-33-66></a>    exit
</span><span id=__span-33-67><a id=__codelineno-33-67 name=__codelineno-33-67 href=#__codelineno-33-67></a>#--------------------------------------------------
</span><span id=__span-33-68><a id=__codelineno-33-68 name=__codelineno-33-68 href=#__codelineno-33-68></a>echo &quot;Router (Service Side) Configuration&quot;
</span><span id=__span-33-69><a id=__codelineno-33-69 name=__codelineno-33-69 href=#__codelineno-33-69></a>#--------------------------------------------------
</span><span id=__span-33-70><a id=__codelineno-33-70 name=__codelineno-33-70 href=#__codelineno-33-70></a>    router 
</span><span id=__span-33-71><a id=__codelineno-33-71 name=__codelineno-33-71 href=#__codelineno-33-71></a>#--------------------------------------------------
</span><span id=__span-33-72><a id=__codelineno-33-72 name=__codelineno-33-72 href=#__codelineno-33-72></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-33-73><a id=__codelineno-33-73 name=__codelineno-33-73 href=#__codelineno-33-73></a>#--------------------------------------------------
</span><span id=__span-33-74><a id=__codelineno-33-74 name=__codelineno-33-74 href=#__codelineno-33-74></a>        ospf
</span><span id=__span-33-75><a id=__codelineno-33-75 name=__codelineno-33-75 href=#__codelineno-33-75></a>            no shutdown
</span><span id=__span-33-76><a id=__codelineno-33-76 name=__codelineno-33-76 href=#__codelineno-33-76></a>        exit
</span><span id=__span-33-77><a id=__codelineno-33-77 name=__codelineno-33-77 href=#__codelineno-33-77></a>#--------------------------------------------------
</span><span id=__span-33-78><a id=__codelineno-33-78 name=__codelineno-33-78 href=#__codelineno-33-78></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-33-79><a id=__codelineno-33-79 name=__codelineno-33-79 href=#__codelineno-33-79></a>#--------------------------------------------------
</span><span id=__span-33-80><a id=__codelineno-33-80 name=__codelineno-33-80 href=#__codelineno-33-80></a>        isis
</span><span id=__span-33-81><a id=__codelineno-33-81 name=__codelineno-33-81 href=#__codelineno-33-81></a>            no shutdown
</span><span id=__span-33-82><a id=__codelineno-33-82 name=__codelineno-33-82 href=#__codelineno-33-82></a>        exit
</span><span id=__span-33-83><a id=__codelineno-33-83 name=__codelineno-33-83 href=#__codelineno-33-83></a>#--------------------------------------------------
</span><span id=__span-33-84><a id=__codelineno-33-84 name=__codelineno-33-84 href=#__codelineno-33-84></a>echo &quot;Policy Configuration&quot;
</span><span id=__span-33-85><a id=__codelineno-33-85 name=__codelineno-33-85 href=#__codelineno-33-85></a>#--------------------------------------------------
</span><span id=__span-33-86><a id=__codelineno-33-86 name=__codelineno-33-86 href=#__codelineno-33-86></a>        policy-options
</span><span id=__span-33-87><a id=__codelineno-33-87 name=__codelineno-33-87 href=#__codelineno-33-87></a>            begin
</span><span id=__span-33-88><a id=__codelineno-33-88 name=__codelineno-33-88 href=#__codelineno-33-88></a>            prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-33-89><a id=__codelineno-33-89 name=__codelineno-33-89 href=#__codelineno-33-89></a>                prefix 10.10.55.0/24 exact
</span><span id=__span-33-90><a id=__codelineno-33-90 name=__codelineno-33-90 href=#__codelineno-33-90></a>            exit
</span><span id=__span-33-91><a id=__codelineno-33-91 name=__codelineno-33-91 href=#__codelineno-33-91></a>            policy-statement &quot;R5_Customer_export&quot;
</span><span id=__span-33-92><a id=__codelineno-33-92 name=__codelineno-33-92 href=#__codelineno-33-92></a>                entry 10
</span><span id=__span-33-93><a id=__codelineno-33-93 name=__codelineno-33-93 href=#__codelineno-33-93></a>                    from
</span><span id=__span-33-94><a id=__codelineno-33-94 name=__codelineno-33-94 href=#__codelineno-33-94></a>                        prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-33-95><a id=__codelineno-33-95 name=__codelineno-33-95 href=#__codelineno-33-95></a>                    exit
</span><span id=__span-33-96><a id=__codelineno-33-96 name=__codelineno-33-96 href=#__codelineno-33-96></a>                    to
</span><span id=__span-33-97><a id=__codelineno-33-97 name=__codelineno-33-97 href=#__codelineno-33-97></a>                        protocol bgp
</span><span id=__span-33-98><a id=__codelineno-33-98 name=__codelineno-33-98 href=#__codelineno-33-98></a>                    exit
</span><span id=__span-33-99><a id=__codelineno-33-99 name=__codelineno-33-99 href=#__codelineno-33-99></a>                    action accept
</span><span id=__span-33-100><a id=__codelineno-33-100 name=__codelineno-33-100 href=#__codelineno-33-100></a>                    exit
</span><span id=__span-33-101><a id=__codelineno-33-101 name=__codelineno-33-101 href=#__codelineno-33-101></a>                exit
</span><span id=__span-33-102><a id=__codelineno-33-102 name=__codelineno-33-102 href=#__codelineno-33-102></a>            exit
</span><span id=__span-33-103><a id=__codelineno-33-103 name=__codelineno-33-103 href=#__codelineno-33-103></a>            commit
</span><span id=__span-33-104><a id=__codelineno-33-104 name=__codelineno-33-104 href=#__codelineno-33-104></a>        exit
</span><span id=__span-33-105><a id=__codelineno-33-105 name=__codelineno-33-105 href=#__codelineno-33-105></a>#--------------------------------------------------
</span><span id=__span-33-106><a id=__codelineno-33-106 name=__codelineno-33-106 href=#__codelineno-33-106></a>echo &quot;BGP Configuration&quot;
</span><span id=__span-33-107><a id=__codelineno-33-107 name=__codelineno-33-107 href=#__codelineno-33-107></a>#--------------------------------------------------
</span><span id=__span-33-108><a id=__codelineno-33-108 name=__codelineno-33-108 href=#__codelineno-33-108></a>        bgp
</span><span id=__span-33-109><a id=__codelineno-33-109 name=__codelineno-33-109 href=#__codelineno-33-109></a>            group &quot;eBGP&quot;
</span><span id=__span-33-110><a id=__codelineno-33-110 name=__codelineno-33-110 href=#__codelineno-33-110></a>                export &quot;R5_Customer_export&quot; 
</span><span id=__span-33-111><a id=__codelineno-33-111 name=__codelineno-33-111 href=#__codelineno-33-111></a>                peer-as 65520         
</span><span id=__span-33-112><a id=__codelineno-33-112 name=__codelineno-33-112 href=#__codelineno-33-112></a>                split-horizon
</span><span id=__span-33-113><a id=__codelineno-33-113 name=__codelineno-33-113 href=#__codelineno-33-113></a>                neighbor 10.0.99.1
</span><span id=__span-33-114><a id=__codelineno-33-114 name=__codelineno-33-114 href=#__codelineno-33-114></a>                    local-address 10.0.99.0
</span><span id=__span-33-115><a id=__codelineno-33-115 name=__codelineno-33-115 href=#__codelineno-33-115></a>                exit
</span><span id=__span-33-116><a id=__codelineno-33-116 name=__codelineno-33-116 href=#__codelineno-33-116></a>            exit
</span><span id=__span-33-117><a id=__codelineno-33-117 name=__codelineno-33-117 href=#__codelineno-33-117></a>            group &quot;iBGP&quot;
</span><span id=__span-33-118><a id=__codelineno-33-118 name=__codelineno-33-118 href=#__codelineno-33-118></a>                next-hop-self
</span><span id=__span-33-119><a id=__codelineno-33-119 name=__codelineno-33-119 href=#__codelineno-33-119></a>                peer-as 65510
</span><span id=__span-33-120><a id=__codelineno-33-120 name=__codelineno-33-120 href=#__codelineno-33-120></a>                neighbor 10.10.10.2
</span><span id=__span-33-121><a id=__codelineno-33-121 name=__codelineno-33-121 href=#__codelineno-33-121></a>                exit
</span><span id=__span-33-122><a id=__codelineno-33-122 name=__codelineno-33-122 href=#__codelineno-33-122></a>                neighbor 10.10.10.5
</span><span id=__span-33-123><a id=__codelineno-33-123 name=__codelineno-33-123 href=#__codelineno-33-123></a>                exit
</span><span id=__span-33-124><a id=__codelineno-33-124 name=__codelineno-33-124 href=#__codelineno-33-124></a>                neighbor 10.10.10.6
</span><span id=__span-33-125><a id=__codelineno-33-125 name=__codelineno-33-125 href=#__codelineno-33-125></a>                exit
</span><span id=__span-33-126><a id=__codelineno-33-126 name=__codelineno-33-126 href=#__codelineno-33-126></a>            exit
</span><span id=__span-33-127><a id=__codelineno-33-127 name=__codelineno-33-127 href=#__codelineno-33-127></a>            no shutdown
</span><span id=__span-33-128><a id=__codelineno-33-128 name=__codelineno-33-128 href=#__codelineno-33-128></a>        exit
</span><span id=__span-33-129><a id=__codelineno-33-129 name=__codelineno-33-129 href=#__codelineno-33-129></a>    exit
</span><span id=__span-33-130><a id=__codelineno-33-130 name=__codelineno-33-130 href=#__codelineno-33-130></a>
</span><span id=__span-33-131><a id=__codelineno-33-131 name=__codelineno-33-131 href=#__codelineno-33-131></a>
</span><span id=__span-33-132><a id=__codelineno-33-132 name=__codelineno-33-132 href=#__codelineno-33-132></a>exit all
</span></code></pre></div> <p>R2:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>#--------------------------------------------------
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>echo &quot;Router (Network Side) Configuration&quot;
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>#--------------------------------------------------
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>    router 
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>        interface &quot;system&quot;
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>            address 10.10.10.2/32
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>            no shutdown
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>        exit
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>        interface &quot;toR1&quot;
</span><span id=__span-34-10><a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>            address 10.10.99.1/31
</span><span id=__span-34-11><a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>            port 1/1/1
</span><span id=__span-34-12><a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a>            no shutdown
</span><span id=__span-34-13><a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a>        exit
</span><span id=__span-34-14><a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a>        interface &quot;toR4&quot;
</span><span id=__span-34-15><a id=__codelineno-34-15 name=__codelineno-34-15 href=#__codelineno-34-15></a>            address 10.0.99.2/31
</span><span id=__span-34-16><a id=__codelineno-34-16 name=__codelineno-34-16 href=#__codelineno-34-16></a>            port 1/1/3
</span><span id=__span-34-17><a id=__codelineno-34-17 name=__codelineno-34-17 href=#__codelineno-34-17></a>            no shutdown
</span><span id=__span-34-18><a id=__codelineno-34-18 name=__codelineno-34-18 href=#__codelineno-34-18></a>        exit
</span><span id=__span-34-19><a id=__codelineno-34-19 name=__codelineno-34-19 href=#__codelineno-34-19></a>        interface &quot;toR6&quot;
</span><span id=__span-34-20><a id=__codelineno-34-20 name=__codelineno-34-20 href=#__codelineno-34-20></a>            address 10.10.99.2/31     
</span><span id=__span-34-21><a id=__codelineno-34-21 name=__codelineno-34-21 href=#__codelineno-34-21></a>            port 1/1/4
</span><span id=__span-34-22><a id=__codelineno-34-22 name=__codelineno-34-22 href=#__codelineno-34-22></a>            no shutdown
</span><span id=__span-34-23><a id=__codelineno-34-23 name=__codelineno-34-23 href=#__codelineno-34-23></a>        exit
</span><span id=__span-34-24><a id=__codelineno-34-24 name=__codelineno-34-24 href=#__codelineno-34-24></a>        autonomous-system 65510
</span><span id=__span-34-25><a id=__codelineno-34-25 name=__codelineno-34-25 href=#__codelineno-34-25></a>#--------------------------------------------------
</span><span id=__span-34-26><a id=__codelineno-34-26 name=__codelineno-34-26 href=#__codelineno-34-26></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-34-27><a id=__codelineno-34-27 name=__codelineno-34-27 href=#__codelineno-34-27></a>#--------------------------------------------------
</span><span id=__span-34-28><a id=__codelineno-34-28 name=__codelineno-34-28 href=#__codelineno-34-28></a>        ospf
</span><span id=__span-34-29><a id=__codelineno-34-29 name=__codelineno-34-29 href=#__codelineno-34-29></a>            no shutdown
</span><span id=__span-34-30><a id=__codelineno-34-30 name=__codelineno-34-30 href=#__codelineno-34-30></a>        exit
</span><span id=__span-34-31><a id=__codelineno-34-31 name=__codelineno-34-31 href=#__codelineno-34-31></a>#--------------------------------------------------
</span><span id=__span-34-32><a id=__codelineno-34-32 name=__codelineno-34-32 href=#__codelineno-34-32></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-34-33><a id=__codelineno-34-33 name=__codelineno-34-33 href=#__codelineno-34-33></a>#--------------------------------------------------
</span><span id=__span-34-34><a id=__codelineno-34-34 name=__codelineno-34-34 href=#__codelineno-34-34></a>        isis
</span><span id=__span-34-35><a id=__codelineno-34-35 name=__codelineno-34-35 href=#__codelineno-34-35></a>            level-capability level-1
</span><span id=__span-34-36><a id=__codelineno-34-36 name=__codelineno-34-36 href=#__codelineno-34-36></a>            area-id 10.10
</span><span id=__span-34-37><a id=__codelineno-34-37 name=__codelineno-34-37 href=#__codelineno-34-37></a>            reference-bandwidth 100000000
</span><span id=__span-34-38><a id=__codelineno-34-38 name=__codelineno-34-38 href=#__codelineno-34-38></a>            level 1
</span><span id=__span-34-39><a id=__codelineno-34-39 name=__codelineno-34-39 href=#__codelineno-34-39></a>                wide-metrics-only
</span><span id=__span-34-40><a id=__codelineno-34-40 name=__codelineno-34-40 href=#__codelineno-34-40></a>            exit
</span><span id=__span-34-41><a id=__codelineno-34-41 name=__codelineno-34-41 href=#__codelineno-34-41></a>            level 2
</span><span id=__span-34-42><a id=__codelineno-34-42 name=__codelineno-34-42 href=#__codelineno-34-42></a>                wide-metrics-only
</span><span id=__span-34-43><a id=__codelineno-34-43 name=__codelineno-34-43 href=#__codelineno-34-43></a>            exit                      
</span><span id=__span-34-44><a id=__codelineno-34-44 name=__codelineno-34-44 href=#__codelineno-34-44></a>            interface &quot;system&quot;
</span><span id=__span-34-45><a id=__codelineno-34-45 name=__codelineno-34-45 href=#__codelineno-34-45></a>                no shutdown
</span><span id=__span-34-46><a id=__codelineno-34-46 name=__codelineno-34-46 href=#__codelineno-34-46></a>            exit
</span><span id=__span-34-47><a id=__codelineno-34-47 name=__codelineno-34-47 href=#__codelineno-34-47></a>            interface &quot;toR1&quot;
</span><span id=__span-34-48><a id=__codelineno-34-48 name=__codelineno-34-48 href=#__codelineno-34-48></a>                interface-type point-to-point
</span><span id=__span-34-49><a id=__codelineno-34-49 name=__codelineno-34-49 href=#__codelineno-34-49></a>                no shutdown
</span><span id=__span-34-50><a id=__codelineno-34-50 name=__codelineno-34-50 href=#__codelineno-34-50></a>            exit
</span><span id=__span-34-51><a id=__codelineno-34-51 name=__codelineno-34-51 href=#__codelineno-34-51></a>            interface &quot;toR6&quot;
</span><span id=__span-34-52><a id=__codelineno-34-52 name=__codelineno-34-52 href=#__codelineno-34-52></a>                interface-type point-to-point
</span><span id=__span-34-53><a id=__codelineno-34-53 name=__codelineno-34-53 href=#__codelineno-34-53></a>                no shutdown
</span><span id=__span-34-54><a id=__codelineno-34-54 name=__codelineno-34-54 href=#__codelineno-34-54></a>            exit
</span><span id=__span-34-55><a id=__codelineno-34-55 name=__codelineno-34-55 href=#__codelineno-34-55></a>            no shutdown
</span><span id=__span-34-56><a id=__codelineno-34-56 name=__codelineno-34-56 href=#__codelineno-34-56></a>        exit
</span><span id=__span-34-57><a id=__codelineno-34-57 name=__codelineno-34-57 href=#__codelineno-34-57></a>    exit
</span><span id=__span-34-58><a id=__codelineno-34-58 name=__codelineno-34-58 href=#__codelineno-34-58></a>
</span><span id=__span-34-59><a id=__codelineno-34-59 name=__codelineno-34-59 href=#__codelineno-34-59></a>#--------------------------------------------------
</span><span id=__span-34-60><a id=__codelineno-34-60 name=__codelineno-34-60 href=#__codelineno-34-60></a>echo &quot;Service Configuration&quot;
</span><span id=__span-34-61><a id=__codelineno-34-61 name=__codelineno-34-61 href=#__codelineno-34-61></a>#--------------------------------------------------
</span><span id=__span-34-62><a id=__codelineno-34-62 name=__codelineno-34-62 href=#__codelineno-34-62></a>    service                           
</span><span id=__span-34-63><a id=__codelineno-34-63 name=__codelineno-34-63 href=#__codelineno-34-63></a>        customer 1 create
</span><span id=__span-34-64><a id=__codelineno-34-64 name=__codelineno-34-64 href=#__codelineno-34-64></a>            description &quot;Default customer&quot;
</span><span id=__span-34-65><a id=__codelineno-34-65 name=__codelineno-34-65 href=#__codelineno-34-65></a>        exit
</span><span id=__span-34-66><a id=__codelineno-34-66 name=__codelineno-34-66 href=#__codelineno-34-66></a>    exit
</span><span id=__span-34-67><a id=__codelineno-34-67 name=__codelineno-34-67 href=#__codelineno-34-67></a>#--------------------------------------------------
</span><span id=__span-34-68><a id=__codelineno-34-68 name=__codelineno-34-68 href=#__codelineno-34-68></a>echo &quot;Router (Service Side) Configuration&quot;
</span><span id=__span-34-69><a id=__codelineno-34-69 name=__codelineno-34-69 href=#__codelineno-34-69></a>#--------------------------------------------------
</span><span id=__span-34-70><a id=__codelineno-34-70 name=__codelineno-34-70 href=#__codelineno-34-70></a>    router 
</span><span id=__span-34-71><a id=__codelineno-34-71 name=__codelineno-34-71 href=#__codelineno-34-71></a>#--------------------------------------------------
</span><span id=__span-34-72><a id=__codelineno-34-72 name=__codelineno-34-72 href=#__codelineno-34-72></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-34-73><a id=__codelineno-34-73 name=__codelineno-34-73 href=#__codelineno-34-73></a>#--------------------------------------------------
</span><span id=__span-34-74><a id=__codelineno-34-74 name=__codelineno-34-74 href=#__codelineno-34-74></a>        ospf
</span><span id=__span-34-75><a id=__codelineno-34-75 name=__codelineno-34-75 href=#__codelineno-34-75></a>            no shutdown
</span><span id=__span-34-76><a id=__codelineno-34-76 name=__codelineno-34-76 href=#__codelineno-34-76></a>        exit
</span><span id=__span-34-77><a id=__codelineno-34-77 name=__codelineno-34-77 href=#__codelineno-34-77></a>#--------------------------------------------------
</span><span id=__span-34-78><a id=__codelineno-34-78 name=__codelineno-34-78 href=#__codelineno-34-78></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-34-79><a id=__codelineno-34-79 name=__codelineno-34-79 href=#__codelineno-34-79></a>#--------------------------------------------------
</span><span id=__span-34-80><a id=__codelineno-34-80 name=__codelineno-34-80 href=#__codelineno-34-80></a>        isis
</span><span id=__span-34-81><a id=__codelineno-34-81 name=__codelineno-34-81 href=#__codelineno-34-81></a>            no shutdown
</span><span id=__span-34-82><a id=__codelineno-34-82 name=__codelineno-34-82 href=#__codelineno-34-82></a>        exit
</span><span id=__span-34-83><a id=__codelineno-34-83 name=__codelineno-34-83 href=#__codelineno-34-83></a>#--------------------------------------------------
</span><span id=__span-34-84><a id=__codelineno-34-84 name=__codelineno-34-84 href=#__codelineno-34-84></a>echo &quot;Policy Configuration&quot;
</span><span id=__span-34-85><a id=__codelineno-34-85 name=__codelineno-34-85 href=#__codelineno-34-85></a>#--------------------------------------------------
</span><span id=__span-34-86><a id=__codelineno-34-86 name=__codelineno-34-86 href=#__codelineno-34-86></a>        policy-options
</span><span id=__span-34-87><a id=__codelineno-34-87 name=__codelineno-34-87 href=#__codelineno-34-87></a>            begin
</span><span id=__span-34-88><a id=__codelineno-34-88 name=__codelineno-34-88 href=#__codelineno-34-88></a>            prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-34-89><a id=__codelineno-34-89 name=__codelineno-34-89 href=#__codelineno-34-89></a>                prefix 10.10.55.0/24 exact
</span><span id=__span-34-90><a id=__codelineno-34-90 name=__codelineno-34-90 href=#__codelineno-34-90></a>            exit
</span><span id=__span-34-91><a id=__codelineno-34-91 name=__codelineno-34-91 href=#__codelineno-34-91></a>            policy-statement &quot;R5_Customer_export&quot;
</span><span id=__span-34-92><a id=__codelineno-34-92 name=__codelineno-34-92 href=#__codelineno-34-92></a>                entry 10
</span><span id=__span-34-93><a id=__codelineno-34-93 name=__codelineno-34-93 href=#__codelineno-34-93></a>                    from
</span><span id=__span-34-94><a id=__codelineno-34-94 name=__codelineno-34-94 href=#__codelineno-34-94></a>                        prefix-list &quot;R5_Customer_pfx&quot;
</span><span id=__span-34-95><a id=__codelineno-34-95 name=__codelineno-34-95 href=#__codelineno-34-95></a>                    exit
</span><span id=__span-34-96><a id=__codelineno-34-96 name=__codelineno-34-96 href=#__codelineno-34-96></a>                    to
</span><span id=__span-34-97><a id=__codelineno-34-97 name=__codelineno-34-97 href=#__codelineno-34-97></a>                        protocol bgp
</span><span id=__span-34-98><a id=__codelineno-34-98 name=__codelineno-34-98 href=#__codelineno-34-98></a>                    exit
</span><span id=__span-34-99><a id=__codelineno-34-99 name=__codelineno-34-99 href=#__codelineno-34-99></a>                    action accept
</span><span id=__span-34-100><a id=__codelineno-34-100 name=__codelineno-34-100 href=#__codelineno-34-100></a>                    exit
</span><span id=__span-34-101><a id=__codelineno-34-101 name=__codelineno-34-101 href=#__codelineno-34-101></a>                exit
</span><span id=__span-34-102><a id=__codelineno-34-102 name=__codelineno-34-102 href=#__codelineno-34-102></a>            exit
</span><span id=__span-34-103><a id=__codelineno-34-103 name=__codelineno-34-103 href=#__codelineno-34-103></a>            commit
</span><span id=__span-34-104><a id=__codelineno-34-104 name=__codelineno-34-104 href=#__codelineno-34-104></a>        exit
</span><span id=__span-34-105><a id=__codelineno-34-105 name=__codelineno-34-105 href=#__codelineno-34-105></a>#--------------------------------------------------
</span><span id=__span-34-106><a id=__codelineno-34-106 name=__codelineno-34-106 href=#__codelineno-34-106></a>echo &quot;BGP Configuration&quot;
</span><span id=__span-34-107><a id=__codelineno-34-107 name=__codelineno-34-107 href=#__codelineno-34-107></a>#--------------------------------------------------
</span><span id=__span-34-108><a id=__codelineno-34-108 name=__codelineno-34-108 href=#__codelineno-34-108></a>        bgp                           
</span><span id=__span-34-109><a id=__codelineno-34-109 name=__codelineno-34-109 href=#__codelineno-34-109></a>            group &quot;eBGP&quot;
</span><span id=__span-34-110><a id=__codelineno-34-110 name=__codelineno-34-110 href=#__codelineno-34-110></a>                export &quot;R5_Customer_export&quot; 
</span><span id=__span-34-111><a id=__codelineno-34-111 name=__codelineno-34-111 href=#__codelineno-34-111></a>                peer-as 65520
</span><span id=__span-34-112><a id=__codelineno-34-112 name=__codelineno-34-112 href=#__codelineno-34-112></a>                split-horizon
</span><span id=__span-34-113><a id=__codelineno-34-113 name=__codelineno-34-113 href=#__codelineno-34-113></a>                neighbor 10.0.99.3
</span><span id=__span-34-114><a id=__codelineno-34-114 name=__codelineno-34-114 href=#__codelineno-34-114></a>                    local-address 10.0.99.2
</span><span id=__span-34-115><a id=__codelineno-34-115 name=__codelineno-34-115 href=#__codelineno-34-115></a>                exit
</span><span id=__span-34-116><a id=__codelineno-34-116 name=__codelineno-34-116 href=#__codelineno-34-116></a>            exit
</span><span id=__span-34-117><a id=__codelineno-34-117 name=__codelineno-34-117 href=#__codelineno-34-117></a>            group &quot;iBGP&quot;
</span><span id=__span-34-118><a id=__codelineno-34-118 name=__codelineno-34-118 href=#__codelineno-34-118></a>                peer-as 65510
</span><span id=__span-34-119><a id=__codelineno-34-119 name=__codelineno-34-119 href=#__codelineno-34-119></a>                neighbor 10.10.10.1
</span><span id=__span-34-120><a id=__codelineno-34-120 name=__codelineno-34-120 href=#__codelineno-34-120></a>                exit
</span><span id=__span-34-121><a id=__codelineno-34-121 name=__codelineno-34-121 href=#__codelineno-34-121></a>                neighbor 10.10.10.5
</span><span id=__span-34-122><a id=__codelineno-34-122 name=__codelineno-34-122 href=#__codelineno-34-122></a>                exit
</span><span id=__span-34-123><a id=__codelineno-34-123 name=__codelineno-34-123 href=#__codelineno-34-123></a>                neighbor 10.10.10.6
</span><span id=__span-34-124><a id=__codelineno-34-124 name=__codelineno-34-124 href=#__codelineno-34-124></a>                exit
</span><span id=__span-34-125><a id=__codelineno-34-125 name=__codelineno-34-125 href=#__codelineno-34-125></a>            exit
</span><span id=__span-34-126><a id=__codelineno-34-126 name=__codelineno-34-126 href=#__codelineno-34-126></a>            no shutdown
</span><span id=__span-34-127><a id=__codelineno-34-127 name=__codelineno-34-127 href=#__codelineno-34-127></a>        exit
</span><span id=__span-34-128><a id=__codelineno-34-128 name=__codelineno-34-128 href=#__codelineno-34-128></a>    exit
</span><span id=__span-34-129><a id=__codelineno-34-129 name=__codelineno-34-129 href=#__codelineno-34-129></a>
</span><span id=__span-34-130><a id=__codelineno-34-130 name=__codelineno-34-130 href=#__codelineno-34-130></a>#--------------------------------------------------
</span><span id=__span-34-131><a id=__codelineno-34-131 name=__codelineno-34-131 href=#__codelineno-34-131></a>echo &quot;System Time NTP Configuration&quot;
</span><span id=__span-34-132><a id=__codelineno-34-132 name=__codelineno-34-132 href=#__codelineno-34-132></a>#--------------------------------------------------
</span><span id=__span-34-133><a id=__codelineno-34-133 name=__codelineno-34-133 href=#__codelineno-34-133></a>    system
</span><span id=__span-34-134><a id=__codelineno-34-134 name=__codelineno-34-134 href=#__codelineno-34-134></a>        time
</span><span id=__span-34-135><a id=__codelineno-34-135 name=__codelineno-34-135 href=#__codelineno-34-135></a>            ntp
</span><span id=__span-34-136><a id=__codelineno-34-136 name=__codelineno-34-136 href=#__codelineno-34-136></a>            exit
</span><span id=__span-34-137><a id=__codelineno-34-137 name=__codelineno-34-137 href=#__codelineno-34-137></a>        exit
</span><span id=__span-34-138><a id=__codelineno-34-138 name=__codelineno-34-138 href=#__codelineno-34-138></a>    exit
</span><span id=__span-34-139><a id=__codelineno-34-139 name=__codelineno-34-139 href=#__codelineno-34-139></a>
</span><span id=__span-34-140><a id=__codelineno-34-140 name=__codelineno-34-140 href=#__codelineno-34-140></a>exit all
</span></code></pre></div> <p>R3:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>#--------------------------------------------------
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>echo &quot;Router (Network Side) Configuration&quot;
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>#--------------------------------------------------
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>    router 
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a>        interface &quot;R3_Ext_Customer&quot;
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a>            address 172.16.33.1/24
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a>            loopback
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a>            no shutdown
</span><span id=__span-35-9><a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a>        exit
</span><span id=__span-35-10><a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a>        interface &quot;system&quot;
</span><span id=__span-35-11><a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a>            address 10.20.20.3/32
</span><span id=__span-35-12><a id=__codelineno-35-12 name=__codelineno-35-12 href=#__codelineno-35-12></a>            no shutdown
</span><span id=__span-35-13><a id=__codelineno-35-13 name=__codelineno-35-13 href=#__codelineno-35-13></a>        exit
</span><span id=__span-35-14><a id=__codelineno-35-14 name=__codelineno-35-14 href=#__codelineno-35-14></a>        interface &quot;toR1&quot;
</span><span id=__span-35-15><a id=__codelineno-35-15 name=__codelineno-35-15 href=#__codelineno-35-15></a>            address 10.0.99.1/31
</span><span id=__span-35-16><a id=__codelineno-35-16 name=__codelineno-35-16 href=#__codelineno-35-16></a>            port 1/1/3
</span><span id=__span-35-17><a id=__codelineno-35-17 name=__codelineno-35-17 href=#__codelineno-35-17></a>            no shutdown
</span><span id=__span-35-18><a id=__codelineno-35-18 name=__codelineno-35-18 href=#__codelineno-35-18></a>        exit
</span><span id=__span-35-19><a id=__codelineno-35-19 name=__codelineno-35-19 href=#__codelineno-35-19></a>        interface &quot;toR4&quot;              
</span><span id=__span-35-20><a id=__codelineno-35-20 name=__codelineno-35-20 href=#__codelineno-35-20></a>            address 10.20.99.0/31
</span><span id=__span-35-21><a id=__codelineno-35-21 name=__codelineno-35-21 href=#__codelineno-35-21></a>            port 1/1/2
</span><span id=__span-35-22><a id=__codelineno-35-22 name=__codelineno-35-22 href=#__codelineno-35-22></a>            no shutdown
</span><span id=__span-35-23><a id=__codelineno-35-23 name=__codelineno-35-23 href=#__codelineno-35-23></a>        exit
</span><span id=__span-35-24><a id=__codelineno-35-24 name=__codelineno-35-24 href=#__codelineno-35-24></a>        autonomous-system 65520
</span><span id=__span-35-25><a id=__codelineno-35-25 name=__codelineno-35-25 href=#__codelineno-35-25></a>#--------------------------------------------------
</span><span id=__span-35-26><a id=__codelineno-35-26 name=__codelineno-35-26 href=#__codelineno-35-26></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-35-27><a id=__codelineno-35-27 name=__codelineno-35-27 href=#__codelineno-35-27></a>#--------------------------------------------------
</span><span id=__span-35-28><a id=__codelineno-35-28 name=__codelineno-35-28 href=#__codelineno-35-28></a>        ospf
</span><span id=__span-35-29><a id=__codelineno-35-29 name=__codelineno-35-29 href=#__codelineno-35-29></a>            no shutdown
</span><span id=__span-35-30><a id=__codelineno-35-30 name=__codelineno-35-30 href=#__codelineno-35-30></a>        exit
</span><span id=__span-35-31><a id=__codelineno-35-31 name=__codelineno-35-31 href=#__codelineno-35-31></a>#--------------------------------------------------
</span><span id=__span-35-32><a id=__codelineno-35-32 name=__codelineno-35-32 href=#__codelineno-35-32></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-35-33><a id=__codelineno-35-33 name=__codelineno-35-33 href=#__codelineno-35-33></a>#--------------------------------------------------
</span><span id=__span-35-34><a id=__codelineno-35-34 name=__codelineno-35-34 href=#__codelineno-35-34></a>        isis
</span><span id=__span-35-35><a id=__codelineno-35-35 name=__codelineno-35-35 href=#__codelineno-35-35></a>            level-capability level-1
</span><span id=__span-35-36><a id=__codelineno-35-36 name=__codelineno-35-36 href=#__codelineno-35-36></a>            area-id 20.20
</span><span id=__span-35-37><a id=__codelineno-35-37 name=__codelineno-35-37 href=#__codelineno-35-37></a>            reference-bandwidth 100000000
</span><span id=__span-35-38><a id=__codelineno-35-38 name=__codelineno-35-38 href=#__codelineno-35-38></a>            level 1
</span><span id=__span-35-39><a id=__codelineno-35-39 name=__codelineno-35-39 href=#__codelineno-35-39></a>                wide-metrics-only
</span><span id=__span-35-40><a id=__codelineno-35-40 name=__codelineno-35-40 href=#__codelineno-35-40></a>            exit
</span><span id=__span-35-41><a id=__codelineno-35-41 name=__codelineno-35-41 href=#__codelineno-35-41></a>            level 2
</span><span id=__span-35-42><a id=__codelineno-35-42 name=__codelineno-35-42 href=#__codelineno-35-42></a>                wide-metrics-only     
</span><span id=__span-35-43><a id=__codelineno-35-43 name=__codelineno-35-43 href=#__codelineno-35-43></a>            exit
</span><span id=__span-35-44><a id=__codelineno-35-44 name=__codelineno-35-44 href=#__codelineno-35-44></a>            interface &quot;system&quot;
</span><span id=__span-35-45><a id=__codelineno-35-45 name=__codelineno-35-45 href=#__codelineno-35-45></a>                no shutdown
</span><span id=__span-35-46><a id=__codelineno-35-46 name=__codelineno-35-46 href=#__codelineno-35-46></a>            exit
</span><span id=__span-35-47><a id=__codelineno-35-47 name=__codelineno-35-47 href=#__codelineno-35-47></a>            interface &quot;toR4&quot;
</span><span id=__span-35-48><a id=__codelineno-35-48 name=__codelineno-35-48 href=#__codelineno-35-48></a>                interface-type point-to-point
</span><span id=__span-35-49><a id=__codelineno-35-49 name=__codelineno-35-49 href=#__codelineno-35-49></a>                no shutdown
</span><span id=__span-35-50><a id=__codelineno-35-50 name=__codelineno-35-50 href=#__codelineno-35-50></a>            exit
</span><span id=__span-35-51><a id=__codelineno-35-51 name=__codelineno-35-51 href=#__codelineno-35-51></a>            no shutdown
</span><span id=__span-35-52><a id=__codelineno-35-52 name=__codelineno-35-52 href=#__codelineno-35-52></a>        exit
</span><span id=__span-35-53><a id=__codelineno-35-53 name=__codelineno-35-53 href=#__codelineno-35-53></a>    exit
</span><span id=__span-35-54><a id=__codelineno-35-54 name=__codelineno-35-54 href=#__codelineno-35-54></a>
</span><span id=__span-35-55><a id=__codelineno-35-55 name=__codelineno-35-55 href=#__codelineno-35-55></a>#--------------------------------------------------
</span><span id=__span-35-56><a id=__codelineno-35-56 name=__codelineno-35-56 href=#__codelineno-35-56></a>echo &quot;Service Configuration&quot;
</span><span id=__span-35-57><a id=__codelineno-35-57 name=__codelineno-35-57 href=#__codelineno-35-57></a>#--------------------------------------------------
</span><span id=__span-35-58><a id=__codelineno-35-58 name=__codelineno-35-58 href=#__codelineno-35-58></a>    service
</span><span id=__span-35-59><a id=__codelineno-35-59 name=__codelineno-35-59 href=#__codelineno-35-59></a>        customer 1 create
</span><span id=__span-35-60><a id=__codelineno-35-60 name=__codelineno-35-60 href=#__codelineno-35-60></a>            description &quot;Default customer&quot;
</span><span id=__span-35-61><a id=__codelineno-35-61 name=__codelineno-35-61 href=#__codelineno-35-61></a>        exit
</span><span id=__span-35-62><a id=__codelineno-35-62 name=__codelineno-35-62 href=#__codelineno-35-62></a>    exit
</span><span id=__span-35-63><a id=__codelineno-35-63 name=__codelineno-35-63 href=#__codelineno-35-63></a>#--------------------------------------------------
</span><span id=__span-35-64><a id=__codelineno-35-64 name=__codelineno-35-64 href=#__codelineno-35-64></a>echo &quot;Router (Service Side) Configuration&quot;
</span><span id=__span-35-65><a id=__codelineno-35-65 name=__codelineno-35-65 href=#__codelineno-35-65></a>#--------------------------------------------------
</span><span id=__span-35-66><a id=__codelineno-35-66 name=__codelineno-35-66 href=#__codelineno-35-66></a>    router 
</span><span id=__span-35-67><a id=__codelineno-35-67 name=__codelineno-35-67 href=#__codelineno-35-67></a>#--------------------------------------------------
</span><span id=__span-35-68><a id=__codelineno-35-68 name=__codelineno-35-68 href=#__codelineno-35-68></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-35-69><a id=__codelineno-35-69 name=__codelineno-35-69 href=#__codelineno-35-69></a>#--------------------------------------------------
</span><span id=__span-35-70><a id=__codelineno-35-70 name=__codelineno-35-70 href=#__codelineno-35-70></a>        ospf
</span><span id=__span-35-71><a id=__codelineno-35-71 name=__codelineno-35-71 href=#__codelineno-35-71></a>            no shutdown
</span><span id=__span-35-72><a id=__codelineno-35-72 name=__codelineno-35-72 href=#__codelineno-35-72></a>        exit
</span><span id=__span-35-73><a id=__codelineno-35-73 name=__codelineno-35-73 href=#__codelineno-35-73></a>#--------------------------------------------------
</span><span id=__span-35-74><a id=__codelineno-35-74 name=__codelineno-35-74 href=#__codelineno-35-74></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-35-75><a id=__codelineno-35-75 name=__codelineno-35-75 href=#__codelineno-35-75></a>#--------------------------------------------------
</span><span id=__span-35-76><a id=__codelineno-35-76 name=__codelineno-35-76 href=#__codelineno-35-76></a>        isis
</span><span id=__span-35-77><a id=__codelineno-35-77 name=__codelineno-35-77 href=#__codelineno-35-77></a>            no shutdown
</span><span id=__span-35-78><a id=__codelineno-35-78 name=__codelineno-35-78 href=#__codelineno-35-78></a>        exit
</span><span id=__span-35-79><a id=__codelineno-35-79 name=__codelineno-35-79 href=#__codelineno-35-79></a>#--------------------------------------------------
</span><span id=__span-35-80><a id=__codelineno-35-80 name=__codelineno-35-80 href=#__codelineno-35-80></a>echo &quot;Policy Configuration&quot;
</span><span id=__span-35-81><a id=__codelineno-35-81 name=__codelineno-35-81 href=#__codelineno-35-81></a>#--------------------------------------------------
</span><span id=__span-35-82><a id=__codelineno-35-82 name=__codelineno-35-82 href=#__codelineno-35-82></a>        policy-options
</span><span id=__span-35-83><a id=__codelineno-35-83 name=__codelineno-35-83 href=#__codelineno-35-83></a>            begin
</span><span id=__span-35-84><a id=__codelineno-35-84 name=__codelineno-35-84 href=#__codelineno-35-84></a>            prefix-list &quot;R3_Ext_Customer&quot;
</span><span id=__span-35-85><a id=__codelineno-35-85 name=__codelineno-35-85 href=#__codelineno-35-85></a>                prefix 172.16.33.0/24 exact
</span><span id=__span-35-86><a id=__codelineno-35-86 name=__codelineno-35-86 href=#__codelineno-35-86></a>            exit
</span><span id=__span-35-87><a id=__codelineno-35-87 name=__codelineno-35-87 href=#__codelineno-35-87></a>            policy-statement &quot;export_R3_Ext_Customer&quot;
</span><span id=__span-35-88><a id=__codelineno-35-88 name=__codelineno-35-88 href=#__codelineno-35-88></a>                entry 10              
</span><span id=__span-35-89><a id=__codelineno-35-89 name=__codelineno-35-89 href=#__codelineno-35-89></a>                    from
</span><span id=__span-35-90><a id=__codelineno-35-90 name=__codelineno-35-90 href=#__codelineno-35-90></a>                        prefix-list &quot;R3_Ext_Customer&quot;
</span><span id=__span-35-91><a id=__codelineno-35-91 name=__codelineno-35-91 href=#__codelineno-35-91></a>                    exit
</span><span id=__span-35-92><a id=__codelineno-35-92 name=__codelineno-35-92 href=#__codelineno-35-92></a>                    to
</span><span id=__span-35-93><a id=__codelineno-35-93 name=__codelineno-35-93 href=#__codelineno-35-93></a>                        protocol bgp
</span><span id=__span-35-94><a id=__codelineno-35-94 name=__codelineno-35-94 href=#__codelineno-35-94></a>                    exit
</span><span id=__span-35-95><a id=__codelineno-35-95 name=__codelineno-35-95 href=#__codelineno-35-95></a>                    action accept
</span><span id=__span-35-96><a id=__codelineno-35-96 name=__codelineno-35-96 href=#__codelineno-35-96></a>                    exit
</span><span id=__span-35-97><a id=__codelineno-35-97 name=__codelineno-35-97 href=#__codelineno-35-97></a>                exit
</span><span id=__span-35-98><a id=__codelineno-35-98 name=__codelineno-35-98 href=#__codelineno-35-98></a>            exit
</span><span id=__span-35-99><a id=__codelineno-35-99 name=__codelineno-35-99 href=#__codelineno-35-99></a>            commit
</span><span id=__span-35-100><a id=__codelineno-35-100 name=__codelineno-35-100 href=#__codelineno-35-100></a>        exit
</span><span id=__span-35-101><a id=__codelineno-35-101 name=__codelineno-35-101 href=#__codelineno-35-101></a>#--------------------------------------------------
</span><span id=__span-35-102><a id=__codelineno-35-102 name=__codelineno-35-102 href=#__codelineno-35-102></a>echo &quot;BGP Configuration&quot;
</span><span id=__span-35-103><a id=__codelineno-35-103 name=__codelineno-35-103 href=#__codelineno-35-103></a>#--------------------------------------------------
</span><span id=__span-35-104><a id=__codelineno-35-104 name=__codelineno-35-104 href=#__codelineno-35-104></a>        bgp
</span><span id=__span-35-105><a id=__codelineno-35-105 name=__codelineno-35-105 href=#__codelineno-35-105></a>            group &quot;eBGP&quot;
</span><span id=__span-35-106><a id=__codelineno-35-106 name=__codelineno-35-106 href=#__codelineno-35-106></a>                export &quot;export_R3_Ext_Customer&quot; 
</span><span id=__span-35-107><a id=__codelineno-35-107 name=__codelineno-35-107 href=#__codelineno-35-107></a>                peer-as 65510
</span><span id=__span-35-108><a id=__codelineno-35-108 name=__codelineno-35-108 href=#__codelineno-35-108></a>                split-horizon
</span><span id=__span-35-109><a id=__codelineno-35-109 name=__codelineno-35-109 href=#__codelineno-35-109></a>                neighbor 10.0.99.0
</span><span id=__span-35-110><a id=__codelineno-35-110 name=__codelineno-35-110 href=#__codelineno-35-110></a>                    local-address 10.0.99.1
</span><span id=__span-35-111><a id=__codelineno-35-111 name=__codelineno-35-111 href=#__codelineno-35-111></a>                exit
</span><span id=__span-35-112><a id=__codelineno-35-112 name=__codelineno-35-112 href=#__codelineno-35-112></a>            exit                      
</span><span id=__span-35-113><a id=__codelineno-35-113 name=__codelineno-35-113 href=#__codelineno-35-113></a>            group &quot;iBGP&quot;
</span><span id=__span-35-114><a id=__codelineno-35-114 name=__codelineno-35-114 href=#__codelineno-35-114></a>                next-hop-self
</span><span id=__span-35-115><a id=__codelineno-35-115 name=__codelineno-35-115 href=#__codelineno-35-115></a>                peer-as 65520
</span><span id=__span-35-116><a id=__codelineno-35-116 name=__codelineno-35-116 href=#__codelineno-35-116></a>                neighbor 10.20.20.4
</span><span id=__span-35-117><a id=__codelineno-35-117 name=__codelineno-35-117 href=#__codelineno-35-117></a>                exit
</span><span id=__span-35-118><a id=__codelineno-35-118 name=__codelineno-35-118 href=#__codelineno-35-118></a>            exit
</span><span id=__span-35-119><a id=__codelineno-35-119 name=__codelineno-35-119 href=#__codelineno-35-119></a>            no shutdown
</span><span id=__span-35-120><a id=__codelineno-35-120 name=__codelineno-35-120 href=#__codelineno-35-120></a>        exit
</span><span id=__span-35-121><a id=__codelineno-35-121 name=__codelineno-35-121 href=#__codelineno-35-121></a>    exit
</span><span id=__span-35-122><a id=__codelineno-35-122 name=__codelineno-35-122 href=#__codelineno-35-122></a>
</span><span id=__span-35-123><a id=__codelineno-35-123 name=__codelineno-35-123 href=#__codelineno-35-123></a>
</span><span id=__span-35-124><a id=__codelineno-35-124 name=__codelineno-35-124 href=#__codelineno-35-124></a>exit all
</span></code></pre></div> <p>R4:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>#--------------------------------------------------
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>echo &quot;Router (Network Side) Configuration&quot;
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>#--------------------------------------------------
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>    router 
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a>        interface &quot;system&quot;
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a>            address 10.20.20.4/32
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a>            no shutdown
</span><span id=__span-36-8><a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a>        exit
</span><span id=__span-36-9><a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a>        interface &quot;toR2&quot;
</span><span id=__span-36-10><a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a>            address 10.0.99.3/31
</span><span id=__span-36-11><a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a>            port 1/1/3
</span><span id=__span-36-12><a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a>            no shutdown
</span><span id=__span-36-13><a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a>        exit
</span><span id=__span-36-14><a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a>        interface &quot;toR3&quot;
</span><span id=__span-36-15><a id=__codelineno-36-15 name=__codelineno-36-15 href=#__codelineno-36-15></a>            address 10.20.99.1/31
</span><span id=__span-36-16><a id=__codelineno-36-16 name=__codelineno-36-16 href=#__codelineno-36-16></a>            port 1/1/2
</span><span id=__span-36-17><a id=__codelineno-36-17 name=__codelineno-36-17 href=#__codelineno-36-17></a>            no shutdown
</span><span id=__span-36-18><a id=__codelineno-36-18 name=__codelineno-36-18 href=#__codelineno-36-18></a>        exit
</span><span id=__span-36-19><a id=__codelineno-36-19 name=__codelineno-36-19 href=#__codelineno-36-19></a>        autonomous-system 65520
</span><span id=__span-36-20><a id=__codelineno-36-20 name=__codelineno-36-20 href=#__codelineno-36-20></a>#--------------------------------------------------
</span><span id=__span-36-21><a id=__codelineno-36-21 name=__codelineno-36-21 href=#__codelineno-36-21></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-36-22><a id=__codelineno-36-22 name=__codelineno-36-22 href=#__codelineno-36-22></a>#--------------------------------------------------
</span><span id=__span-36-23><a id=__codelineno-36-23 name=__codelineno-36-23 href=#__codelineno-36-23></a>        ospf                          
</span><span id=__span-36-24><a id=__codelineno-36-24 name=__codelineno-36-24 href=#__codelineno-36-24></a>            no shutdown
</span><span id=__span-36-25><a id=__codelineno-36-25 name=__codelineno-36-25 href=#__codelineno-36-25></a>        exit
</span><span id=__span-36-26><a id=__codelineno-36-26 name=__codelineno-36-26 href=#__codelineno-36-26></a>#--------------------------------------------------
</span><span id=__span-36-27><a id=__codelineno-36-27 name=__codelineno-36-27 href=#__codelineno-36-27></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-36-28><a id=__codelineno-36-28 name=__codelineno-36-28 href=#__codelineno-36-28></a>#--------------------------------------------------
</span><span id=__span-36-29><a id=__codelineno-36-29 name=__codelineno-36-29 href=#__codelineno-36-29></a>        isis
</span><span id=__span-36-30><a id=__codelineno-36-30 name=__codelineno-36-30 href=#__codelineno-36-30></a>            level-capability level-1
</span><span id=__span-36-31><a id=__codelineno-36-31 name=__codelineno-36-31 href=#__codelineno-36-31></a>            area-id 20.20
</span><span id=__span-36-32><a id=__codelineno-36-32 name=__codelineno-36-32 href=#__codelineno-36-32></a>            reference-bandwidth 100000000
</span><span id=__span-36-33><a id=__codelineno-36-33 name=__codelineno-36-33 href=#__codelineno-36-33></a>            level 1
</span><span id=__span-36-34><a id=__codelineno-36-34 name=__codelineno-36-34 href=#__codelineno-36-34></a>                wide-metrics-only
</span><span id=__span-36-35><a id=__codelineno-36-35 name=__codelineno-36-35 href=#__codelineno-36-35></a>            exit
</span><span id=__span-36-36><a id=__codelineno-36-36 name=__codelineno-36-36 href=#__codelineno-36-36></a>            level 2
</span><span id=__span-36-37><a id=__codelineno-36-37 name=__codelineno-36-37 href=#__codelineno-36-37></a>                wide-metrics-only
</span><span id=__span-36-38><a id=__codelineno-36-38 name=__codelineno-36-38 href=#__codelineno-36-38></a>            exit
</span><span id=__span-36-39><a id=__codelineno-36-39 name=__codelineno-36-39 href=#__codelineno-36-39></a>            interface &quot;system&quot;
</span><span id=__span-36-40><a id=__codelineno-36-40 name=__codelineno-36-40 href=#__codelineno-36-40></a>                no shutdown
</span><span id=__span-36-41><a id=__codelineno-36-41 name=__codelineno-36-41 href=#__codelineno-36-41></a>            exit
</span><span id=__span-36-42><a id=__codelineno-36-42 name=__codelineno-36-42 href=#__codelineno-36-42></a>            interface &quot;toR3&quot;
</span><span id=__span-36-43><a id=__codelineno-36-43 name=__codelineno-36-43 href=#__codelineno-36-43></a>                interface-type point-to-point
</span><span id=__span-36-44><a id=__codelineno-36-44 name=__codelineno-36-44 href=#__codelineno-36-44></a>                no shutdown
</span><span id=__span-36-45><a id=__codelineno-36-45 name=__codelineno-36-45 href=#__codelineno-36-45></a>            exit
</span><span id=__span-36-46><a id=__codelineno-36-46 name=__codelineno-36-46 href=#__codelineno-36-46></a>            no shutdown               
</span><span id=__span-36-47><a id=__codelineno-36-47 name=__codelineno-36-47 href=#__codelineno-36-47></a>        exit
</span><span id=__span-36-48><a id=__codelineno-36-48 name=__codelineno-36-48 href=#__codelineno-36-48></a>    exit
</span><span id=__span-36-49><a id=__codelineno-36-49 name=__codelineno-36-49 href=#__codelineno-36-49></a>
</span><span id=__span-36-50><a id=__codelineno-36-50 name=__codelineno-36-50 href=#__codelineno-36-50></a>#--------------------------------------------------
</span><span id=__span-36-51><a id=__codelineno-36-51 name=__codelineno-36-51 href=#__codelineno-36-51></a>echo &quot;Service Configuration&quot;
</span><span id=__span-36-52><a id=__codelineno-36-52 name=__codelineno-36-52 href=#__codelineno-36-52></a>#--------------------------------------------------
</span><span id=__span-36-53><a id=__codelineno-36-53 name=__codelineno-36-53 href=#__codelineno-36-53></a>    service
</span><span id=__span-36-54><a id=__codelineno-36-54 name=__codelineno-36-54 href=#__codelineno-36-54></a>        customer 1 create
</span><span id=__span-36-55><a id=__codelineno-36-55 name=__codelineno-36-55 href=#__codelineno-36-55></a>            description &quot;Default customer&quot;
</span><span id=__span-36-56><a id=__codelineno-36-56 name=__codelineno-36-56 href=#__codelineno-36-56></a>        exit
</span><span id=__span-36-57><a id=__codelineno-36-57 name=__codelineno-36-57 href=#__codelineno-36-57></a>    exit
</span><span id=__span-36-58><a id=__codelineno-36-58 name=__codelineno-36-58 href=#__codelineno-36-58></a>#--------------------------------------------------
</span><span id=__span-36-59><a id=__codelineno-36-59 name=__codelineno-36-59 href=#__codelineno-36-59></a>echo &quot;Router (Service Side) Configuration&quot;
</span><span id=__span-36-60><a id=__codelineno-36-60 name=__codelineno-36-60 href=#__codelineno-36-60></a>#--------------------------------------------------
</span><span id=__span-36-61><a id=__codelineno-36-61 name=__codelineno-36-61 href=#__codelineno-36-61></a>    router 
</span><span id=__span-36-62><a id=__codelineno-36-62 name=__codelineno-36-62 href=#__codelineno-36-62></a>#--------------------------------------------------
</span><span id=__span-36-63><a id=__codelineno-36-63 name=__codelineno-36-63 href=#__codelineno-36-63></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-36-64><a id=__codelineno-36-64 name=__codelineno-36-64 href=#__codelineno-36-64></a>#--------------------------------------------------
</span><span id=__span-36-65><a id=__codelineno-36-65 name=__codelineno-36-65 href=#__codelineno-36-65></a>        ospf
</span><span id=__span-36-66><a id=__codelineno-36-66 name=__codelineno-36-66 href=#__codelineno-36-66></a>            no shutdown
</span><span id=__span-36-67><a id=__codelineno-36-67 name=__codelineno-36-67 href=#__codelineno-36-67></a>        exit
</span><span id=__span-36-68><a id=__codelineno-36-68 name=__codelineno-36-68 href=#__codelineno-36-68></a>#--------------------------------------------------
</span><span id=__span-36-69><a id=__codelineno-36-69 name=__codelineno-36-69 href=#__codelineno-36-69></a>echo &quot;ISIS Configuration&quot;             
</span><span id=__span-36-70><a id=__codelineno-36-70 name=__codelineno-36-70 href=#__codelineno-36-70></a>#--------------------------------------------------
</span><span id=__span-36-71><a id=__codelineno-36-71 name=__codelineno-36-71 href=#__codelineno-36-71></a>        isis
</span><span id=__span-36-72><a id=__codelineno-36-72 name=__codelineno-36-72 href=#__codelineno-36-72></a>            no shutdown
</span><span id=__span-36-73><a id=__codelineno-36-73 name=__codelineno-36-73 href=#__codelineno-36-73></a>        exit
</span><span id=__span-36-74><a id=__codelineno-36-74 name=__codelineno-36-74 href=#__codelineno-36-74></a>#--------------------------------------------------
</span><span id=__span-36-75><a id=__codelineno-36-75 name=__codelineno-36-75 href=#__codelineno-36-75></a>echo &quot;BGP Configuration&quot;
</span><span id=__span-36-76><a id=__codelineno-36-76 name=__codelineno-36-76 href=#__codelineno-36-76></a>#--------------------------------------------------
</span><span id=__span-36-77><a id=__codelineno-36-77 name=__codelineno-36-77 href=#__codelineno-36-77></a>        bgp
</span><span id=__span-36-78><a id=__codelineno-36-78 name=__codelineno-36-78 href=#__codelineno-36-78></a>            group &quot;eBGP&quot;
</span><span id=__span-36-79><a id=__codelineno-36-79 name=__codelineno-36-79 href=#__codelineno-36-79></a>                peer-as 65510
</span><span id=__span-36-80><a id=__codelineno-36-80 name=__codelineno-36-80 href=#__codelineno-36-80></a>                split-horizon
</span><span id=__span-36-81><a id=__codelineno-36-81 name=__codelineno-36-81 href=#__codelineno-36-81></a>                neighbor 10.0.99.2
</span><span id=__span-36-82><a id=__codelineno-36-82 name=__codelineno-36-82 href=#__codelineno-36-82></a>                    local-address 10.0.99.3
</span><span id=__span-36-83><a id=__codelineno-36-83 name=__codelineno-36-83 href=#__codelineno-36-83></a>                exit
</span><span id=__span-36-84><a id=__codelineno-36-84 name=__codelineno-36-84 href=#__codelineno-36-84></a>            exit
</span><span id=__span-36-85><a id=__codelineno-36-85 name=__codelineno-36-85 href=#__codelineno-36-85></a>            group &quot;iBGP&quot;
</span><span id=__span-36-86><a id=__codelineno-36-86 name=__codelineno-36-86 href=#__codelineno-36-86></a>                next-hop-self
</span><span id=__span-36-87><a id=__codelineno-36-87 name=__codelineno-36-87 href=#__codelineno-36-87></a>                peer-as 65520
</span><span id=__span-36-88><a id=__codelineno-36-88 name=__codelineno-36-88 href=#__codelineno-36-88></a>                neighbor 10.20.20.3
</span><span id=__span-36-89><a id=__codelineno-36-89 name=__codelineno-36-89 href=#__codelineno-36-89></a>                exit
</span><span id=__span-36-90><a id=__codelineno-36-90 name=__codelineno-36-90 href=#__codelineno-36-90></a>            exit
</span><span id=__span-36-91><a id=__codelineno-36-91 name=__codelineno-36-91 href=#__codelineno-36-91></a>            no shutdown
</span><span id=__span-36-92><a id=__codelineno-36-92 name=__codelineno-36-92 href=#__codelineno-36-92></a>        exit
</span><span id=__span-36-93><a id=__codelineno-36-93 name=__codelineno-36-93 href=#__codelineno-36-93></a>    exit                              
</span><span id=__span-36-94><a id=__codelineno-36-94 name=__codelineno-36-94 href=#__codelineno-36-94></a>
</span><span id=__span-36-95><a id=__codelineno-36-95 name=__codelineno-36-95 href=#__codelineno-36-95></a>
</span><span id=__span-36-96><a id=__codelineno-36-96 name=__codelineno-36-96 href=#__codelineno-36-96></a>exit all
</span></code></pre></div> <p>R5:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a>#--------------------------------------------------
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>echo &quot;Router (Network Side) Configuration&quot;
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>#--------------------------------------------------
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>    router 
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>        interface &quot;R5_Customer_loopback&quot;
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a>            address 10.10.55.1/24
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>            loopback
</span><span id=__span-37-8><a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a>            no shutdown
</span><span id=__span-37-9><a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>        exit
</span><span id=__span-37-10><a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a>        interface &quot;system&quot;
</span><span id=__span-37-11><a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a>            address 10.10.10.5/32
</span><span id=__span-37-12><a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>            no shutdown
</span><span id=__span-37-13><a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a>        exit
</span><span id=__span-37-14><a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a>        interface &quot;toR1&quot;
</span><span id=__span-37-15><a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a>            address 10.10.99.5/31
</span><span id=__span-37-16><a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a>            port 1/1/4
</span><span id=__span-37-17><a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a>            no shutdown
</span><span id=__span-37-18><a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a>        exit
</span><span id=__span-37-19><a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a>        interface &quot;toR6&quot;
</span><span id=__span-37-20><a id=__codelineno-37-20 name=__codelineno-37-20 href=#__codelineno-37-20></a>            address 10.10.99.6/31
</span><span id=__span-37-21><a id=__codelineno-37-21 name=__codelineno-37-21 href=#__codelineno-37-21></a>            port 1/1/1
</span><span id=__span-37-22><a id=__codelineno-37-22 name=__codelineno-37-22 href=#__codelineno-37-22></a>            no shutdown
</span><span id=__span-37-23><a id=__codelineno-37-23 name=__codelineno-37-23 href=#__codelineno-37-23></a>        exit                          
</span><span id=__span-37-24><a id=__codelineno-37-24 name=__codelineno-37-24 href=#__codelineno-37-24></a>        autonomous-system 65510
</span><span id=__span-37-25><a id=__codelineno-37-25 name=__codelineno-37-25 href=#__codelineno-37-25></a>#--------------------------------------------------
</span><span id=__span-37-26><a id=__codelineno-37-26 name=__codelineno-37-26 href=#__codelineno-37-26></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-37-27><a id=__codelineno-37-27 name=__codelineno-37-27 href=#__codelineno-37-27></a>#--------------------------------------------------
</span><span id=__span-37-28><a id=__codelineno-37-28 name=__codelineno-37-28 href=#__codelineno-37-28></a>        ospf
</span><span id=__span-37-29><a id=__codelineno-37-29 name=__codelineno-37-29 href=#__codelineno-37-29></a>            no shutdown
</span><span id=__span-37-30><a id=__codelineno-37-30 name=__codelineno-37-30 href=#__codelineno-37-30></a>        exit
</span><span id=__span-37-31><a id=__codelineno-37-31 name=__codelineno-37-31 href=#__codelineno-37-31></a>#--------------------------------------------------
</span><span id=__span-37-32><a id=__codelineno-37-32 name=__codelineno-37-32 href=#__codelineno-37-32></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-37-33><a id=__codelineno-37-33 name=__codelineno-37-33 href=#__codelineno-37-33></a>#--------------------------------------------------
</span><span id=__span-37-34><a id=__codelineno-37-34 name=__codelineno-37-34 href=#__codelineno-37-34></a>        isis
</span><span id=__span-37-35><a id=__codelineno-37-35 name=__codelineno-37-35 href=#__codelineno-37-35></a>            level-capability level-1
</span><span id=__span-37-36><a id=__codelineno-37-36 name=__codelineno-37-36 href=#__codelineno-37-36></a>            area-id 10.10
</span><span id=__span-37-37><a id=__codelineno-37-37 name=__codelineno-37-37 href=#__codelineno-37-37></a>            reference-bandwidth 100000000
</span><span id=__span-37-38><a id=__codelineno-37-38 name=__codelineno-37-38 href=#__codelineno-37-38></a>            level 1
</span><span id=__span-37-39><a id=__codelineno-37-39 name=__codelineno-37-39 href=#__codelineno-37-39></a>                wide-metrics-only
</span><span id=__span-37-40><a id=__codelineno-37-40 name=__codelineno-37-40 href=#__codelineno-37-40></a>            exit
</span><span id=__span-37-41><a id=__codelineno-37-41 name=__codelineno-37-41 href=#__codelineno-37-41></a>            level 2
</span><span id=__span-37-42><a id=__codelineno-37-42 name=__codelineno-37-42 href=#__codelineno-37-42></a>                wide-metrics-only
</span><span id=__span-37-43><a id=__codelineno-37-43 name=__codelineno-37-43 href=#__codelineno-37-43></a>            exit
</span><span id=__span-37-44><a id=__codelineno-37-44 name=__codelineno-37-44 href=#__codelineno-37-44></a>            interface &quot;system&quot;
</span><span id=__span-37-45><a id=__codelineno-37-45 name=__codelineno-37-45 href=#__codelineno-37-45></a>                no shutdown
</span><span id=__span-37-46><a id=__codelineno-37-46 name=__codelineno-37-46 href=#__codelineno-37-46></a>            exit                      
</span><span id=__span-37-47><a id=__codelineno-37-47 name=__codelineno-37-47 href=#__codelineno-37-47></a>            interface &quot;R5_Customer_loopback&quot;
</span><span id=__span-37-48><a id=__codelineno-37-48 name=__codelineno-37-48 href=#__codelineno-37-48></a>                passive
</span><span id=__span-37-49><a id=__codelineno-37-49 name=__codelineno-37-49 href=#__codelineno-37-49></a>                no shutdown
</span><span id=__span-37-50><a id=__codelineno-37-50 name=__codelineno-37-50 href=#__codelineno-37-50></a>            exit
</span><span id=__span-37-51><a id=__codelineno-37-51 name=__codelineno-37-51 href=#__codelineno-37-51></a>            interface &quot;toR1&quot;
</span><span id=__span-37-52><a id=__codelineno-37-52 name=__codelineno-37-52 href=#__codelineno-37-52></a>                interface-type point-to-point
</span><span id=__span-37-53><a id=__codelineno-37-53 name=__codelineno-37-53 href=#__codelineno-37-53></a>                no shutdown
</span><span id=__span-37-54><a id=__codelineno-37-54 name=__codelineno-37-54 href=#__codelineno-37-54></a>            exit
</span><span id=__span-37-55><a id=__codelineno-37-55 name=__codelineno-37-55 href=#__codelineno-37-55></a>            interface &quot;toR6&quot;
</span><span id=__span-37-56><a id=__codelineno-37-56 name=__codelineno-37-56 href=#__codelineno-37-56></a>                interface-type point-to-point
</span><span id=__span-37-57><a id=__codelineno-37-57 name=__codelineno-37-57 href=#__codelineno-37-57></a>                no shutdown
</span><span id=__span-37-58><a id=__codelineno-37-58 name=__codelineno-37-58 href=#__codelineno-37-58></a>            exit
</span><span id=__span-37-59><a id=__codelineno-37-59 name=__codelineno-37-59 href=#__codelineno-37-59></a>            no shutdown
</span><span id=__span-37-60><a id=__codelineno-37-60 name=__codelineno-37-60 href=#__codelineno-37-60></a>        exit
</span><span id=__span-37-61><a id=__codelineno-37-61 name=__codelineno-37-61 href=#__codelineno-37-61></a>    exit
</span><span id=__span-37-62><a id=__codelineno-37-62 name=__codelineno-37-62 href=#__codelineno-37-62></a>
</span><span id=__span-37-63><a id=__codelineno-37-63 name=__codelineno-37-63 href=#__codelineno-37-63></a>#--------------------------------------------------
</span><span id=__span-37-64><a id=__codelineno-37-64 name=__codelineno-37-64 href=#__codelineno-37-64></a>echo &quot;Service Configuration&quot;
</span><span id=__span-37-65><a id=__codelineno-37-65 name=__codelineno-37-65 href=#__codelineno-37-65></a>#--------------------------------------------------
</span><span id=__span-37-66><a id=__codelineno-37-66 name=__codelineno-37-66 href=#__codelineno-37-66></a>    service
</span><span id=__span-37-67><a id=__codelineno-37-67 name=__codelineno-37-67 href=#__codelineno-37-67></a>        customer 1 create
</span><span id=__span-37-68><a id=__codelineno-37-68 name=__codelineno-37-68 href=#__codelineno-37-68></a>            description &quot;Default customer&quot;
</span><span id=__span-37-69><a id=__codelineno-37-69 name=__codelineno-37-69 href=#__codelineno-37-69></a>        exit                          
</span><span id=__span-37-70><a id=__codelineno-37-70 name=__codelineno-37-70 href=#__codelineno-37-70></a>    exit
</span><span id=__span-37-71><a id=__codelineno-37-71 name=__codelineno-37-71 href=#__codelineno-37-71></a>#--------------------------------------------------
</span><span id=__span-37-72><a id=__codelineno-37-72 name=__codelineno-37-72 href=#__codelineno-37-72></a>echo &quot;Router (Service Side) Configuration&quot;
</span><span id=__span-37-73><a id=__codelineno-37-73 name=__codelineno-37-73 href=#__codelineno-37-73></a>#--------------------------------------------------
</span><span id=__span-37-74><a id=__codelineno-37-74 name=__codelineno-37-74 href=#__codelineno-37-74></a>    router 
</span><span id=__span-37-75><a id=__codelineno-37-75 name=__codelineno-37-75 href=#__codelineno-37-75></a>#--------------------------------------------------
</span><span id=__span-37-76><a id=__codelineno-37-76 name=__codelineno-37-76 href=#__codelineno-37-76></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-37-77><a id=__codelineno-37-77 name=__codelineno-37-77 href=#__codelineno-37-77></a>#--------------------------------------------------
</span><span id=__span-37-78><a id=__codelineno-37-78 name=__codelineno-37-78 href=#__codelineno-37-78></a>        ospf
</span><span id=__span-37-79><a id=__codelineno-37-79 name=__codelineno-37-79 href=#__codelineno-37-79></a>            no shutdown
</span><span id=__span-37-80><a id=__codelineno-37-80 name=__codelineno-37-80 href=#__codelineno-37-80></a>        exit
</span><span id=__span-37-81><a id=__codelineno-37-81 name=__codelineno-37-81 href=#__codelineno-37-81></a>#--------------------------------------------------
</span><span id=__span-37-82><a id=__codelineno-37-82 name=__codelineno-37-82 href=#__codelineno-37-82></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-37-83><a id=__codelineno-37-83 name=__codelineno-37-83 href=#__codelineno-37-83></a>#--------------------------------------------------
</span><span id=__span-37-84><a id=__codelineno-37-84 name=__codelineno-37-84 href=#__codelineno-37-84></a>        isis
</span><span id=__span-37-85><a id=__codelineno-37-85 name=__codelineno-37-85 href=#__codelineno-37-85></a>            no shutdown
</span><span id=__span-37-86><a id=__codelineno-37-86 name=__codelineno-37-86 href=#__codelineno-37-86></a>        exit
</span><span id=__span-37-87><a id=__codelineno-37-87 name=__codelineno-37-87 href=#__codelineno-37-87></a>#--------------------------------------------------
</span><span id=__span-37-88><a id=__codelineno-37-88 name=__codelineno-37-88 href=#__codelineno-37-88></a>echo &quot;BGP Configuration&quot;
</span><span id=__span-37-89><a id=__codelineno-37-89 name=__codelineno-37-89 href=#__codelineno-37-89></a>#--------------------------------------------------
</span><span id=__span-37-90><a id=__codelineno-37-90 name=__codelineno-37-90 href=#__codelineno-37-90></a>        bgp
</span><span id=__span-37-91><a id=__codelineno-37-91 name=__codelineno-37-91 href=#__codelineno-37-91></a>            group &quot;iBGP&quot;
</span><span id=__span-37-92><a id=__codelineno-37-92 name=__codelineno-37-92 href=#__codelineno-37-92></a>                peer-as 65510         
</span><span id=__span-37-93><a id=__codelineno-37-93 name=__codelineno-37-93 href=#__codelineno-37-93></a>                neighbor 10.10.10.1
</span><span id=__span-37-94><a id=__codelineno-37-94 name=__codelineno-37-94 href=#__codelineno-37-94></a>                exit
</span><span id=__span-37-95><a id=__codelineno-37-95 name=__codelineno-37-95 href=#__codelineno-37-95></a>                neighbor 10.10.10.2
</span><span id=__span-37-96><a id=__codelineno-37-96 name=__codelineno-37-96 href=#__codelineno-37-96></a>                exit
</span><span id=__span-37-97><a id=__codelineno-37-97 name=__codelineno-37-97 href=#__codelineno-37-97></a>                neighbor 10.10.10.6
</span><span id=__span-37-98><a id=__codelineno-37-98 name=__codelineno-37-98 href=#__codelineno-37-98></a>                exit
</span><span id=__span-37-99><a id=__codelineno-37-99 name=__codelineno-37-99 href=#__codelineno-37-99></a>            exit
</span><span id=__span-37-100><a id=__codelineno-37-100 name=__codelineno-37-100 href=#__codelineno-37-100></a>            no shutdown
</span><span id=__span-37-101><a id=__codelineno-37-101 name=__codelineno-37-101 href=#__codelineno-37-101></a>        exit
</span><span id=__span-37-102><a id=__codelineno-37-102 name=__codelineno-37-102 href=#__codelineno-37-102></a>    exit
</span><span id=__span-37-103><a id=__codelineno-37-103 name=__codelineno-37-103 href=#__codelineno-37-103></a>
</span><span id=__span-37-104><a id=__codelineno-37-104 name=__codelineno-37-104 href=#__codelineno-37-104></a>
</span><span id=__span-37-105><a id=__codelineno-37-105 name=__codelineno-37-105 href=#__codelineno-37-105></a>exit all
</span></code></pre></div> <p>R6:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a>#--------------------------------------------------
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>echo &quot;Router (Network Side) Configuration&quot;
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a>#--------------------------------------------------
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>    router 
</span><span id=__span-38-5><a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a>        interface &quot;system&quot;
</span><span id=__span-38-6><a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a>            address 10.10.10.6/32
</span><span id=__span-38-7><a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a>            no shutdown
</span><span id=__span-38-8><a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a>        exit
</span><span id=__span-38-9><a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a>        interface &quot;toR2&quot;
</span><span id=__span-38-10><a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a>            address 10.10.99.3/31
</span><span id=__span-38-11><a id=__codelineno-38-11 name=__codelineno-38-11 href=#__codelineno-38-11></a>            port 1/1/4
</span><span id=__span-38-12><a id=__codelineno-38-12 name=__codelineno-38-12 href=#__codelineno-38-12></a>            no shutdown
</span><span id=__span-38-13><a id=__codelineno-38-13 name=__codelineno-38-13 href=#__codelineno-38-13></a>        exit
</span><span id=__span-38-14><a id=__codelineno-38-14 name=__codelineno-38-14 href=#__codelineno-38-14></a>        interface &quot;toR5&quot;
</span><span id=__span-38-15><a id=__codelineno-38-15 name=__codelineno-38-15 href=#__codelineno-38-15></a>            address 10.10.99.7/31
</span><span id=__span-38-16><a id=__codelineno-38-16 name=__codelineno-38-16 href=#__codelineno-38-16></a>            port 1/1/1
</span><span id=__span-38-17><a id=__codelineno-38-17 name=__codelineno-38-17 href=#__codelineno-38-17></a>            no shutdown
</span><span id=__span-38-18><a id=__codelineno-38-18 name=__codelineno-38-18 href=#__codelineno-38-18></a>        exit
</span><span id=__span-38-19><a id=__codelineno-38-19 name=__codelineno-38-19 href=#__codelineno-38-19></a>        autonomous-system 65510
</span><span id=__span-38-20><a id=__codelineno-38-20 name=__codelineno-38-20 href=#__codelineno-38-20></a>#--------------------------------------------------
</span><span id=__span-38-21><a id=__codelineno-38-21 name=__codelineno-38-21 href=#__codelineno-38-21></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-38-22><a id=__codelineno-38-22 name=__codelineno-38-22 href=#__codelineno-38-22></a>#--------------------------------------------------
</span><span id=__span-38-23><a id=__codelineno-38-23 name=__codelineno-38-23 href=#__codelineno-38-23></a>        ospf                          
</span><span id=__span-38-24><a id=__codelineno-38-24 name=__codelineno-38-24 href=#__codelineno-38-24></a>            no shutdown
</span><span id=__span-38-25><a id=__codelineno-38-25 name=__codelineno-38-25 href=#__codelineno-38-25></a>        exit
</span><span id=__span-38-26><a id=__codelineno-38-26 name=__codelineno-38-26 href=#__codelineno-38-26></a>#--------------------------------------------------
</span><span id=__span-38-27><a id=__codelineno-38-27 name=__codelineno-38-27 href=#__codelineno-38-27></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-38-28><a id=__codelineno-38-28 name=__codelineno-38-28 href=#__codelineno-38-28></a>#--------------------------------------------------
</span><span id=__span-38-29><a id=__codelineno-38-29 name=__codelineno-38-29 href=#__codelineno-38-29></a>        isis
</span><span id=__span-38-30><a id=__codelineno-38-30 name=__codelineno-38-30 href=#__codelineno-38-30></a>            level-capability level-1
</span><span id=__span-38-31><a id=__codelineno-38-31 name=__codelineno-38-31 href=#__codelineno-38-31></a>            area-id 10.10
</span><span id=__span-38-32><a id=__codelineno-38-32 name=__codelineno-38-32 href=#__codelineno-38-32></a>            reference-bandwidth 100000000
</span><span id=__span-38-33><a id=__codelineno-38-33 name=__codelineno-38-33 href=#__codelineno-38-33></a>            level 1
</span><span id=__span-38-34><a id=__codelineno-38-34 name=__codelineno-38-34 href=#__codelineno-38-34></a>                wide-metrics-only
</span><span id=__span-38-35><a id=__codelineno-38-35 name=__codelineno-38-35 href=#__codelineno-38-35></a>            exit
</span><span id=__span-38-36><a id=__codelineno-38-36 name=__codelineno-38-36 href=#__codelineno-38-36></a>            level 2
</span><span id=__span-38-37><a id=__codelineno-38-37 name=__codelineno-38-37 href=#__codelineno-38-37></a>                wide-metrics-only
</span><span id=__span-38-38><a id=__codelineno-38-38 name=__codelineno-38-38 href=#__codelineno-38-38></a>            exit
</span><span id=__span-38-39><a id=__codelineno-38-39 name=__codelineno-38-39 href=#__codelineno-38-39></a>            interface &quot;system&quot;
</span><span id=__span-38-40><a id=__codelineno-38-40 name=__codelineno-38-40 href=#__codelineno-38-40></a>                no shutdown
</span><span id=__span-38-41><a id=__codelineno-38-41 name=__codelineno-38-41 href=#__codelineno-38-41></a>            exit
</span><span id=__span-38-42><a id=__codelineno-38-42 name=__codelineno-38-42 href=#__codelineno-38-42></a>            interface &quot;toR2&quot;
</span><span id=__span-38-43><a id=__codelineno-38-43 name=__codelineno-38-43 href=#__codelineno-38-43></a>                interface-type point-to-point
</span><span id=__span-38-44><a id=__codelineno-38-44 name=__codelineno-38-44 href=#__codelineno-38-44></a>                no shutdown
</span><span id=__span-38-45><a id=__codelineno-38-45 name=__codelineno-38-45 href=#__codelineno-38-45></a>            exit
</span><span id=__span-38-46><a id=__codelineno-38-46 name=__codelineno-38-46 href=#__codelineno-38-46></a>            interface &quot;toR5&quot;          
</span><span id=__span-38-47><a id=__codelineno-38-47 name=__codelineno-38-47 href=#__codelineno-38-47></a>                interface-type point-to-point
</span><span id=__span-38-48><a id=__codelineno-38-48 name=__codelineno-38-48 href=#__codelineno-38-48></a>                no shutdown
</span><span id=__span-38-49><a id=__codelineno-38-49 name=__codelineno-38-49 href=#__codelineno-38-49></a>            exit
</span><span id=__span-38-50><a id=__codelineno-38-50 name=__codelineno-38-50 href=#__codelineno-38-50></a>            no shutdown
</span><span id=__span-38-51><a id=__codelineno-38-51 name=__codelineno-38-51 href=#__codelineno-38-51></a>        exit
</span><span id=__span-38-52><a id=__codelineno-38-52 name=__codelineno-38-52 href=#__codelineno-38-52></a>    exit
</span><span id=__span-38-53><a id=__codelineno-38-53 name=__codelineno-38-53 href=#__codelineno-38-53></a>
</span><span id=__span-38-54><a id=__codelineno-38-54 name=__codelineno-38-54 href=#__codelineno-38-54></a>#--------------------------------------------------
</span><span id=__span-38-55><a id=__codelineno-38-55 name=__codelineno-38-55 href=#__codelineno-38-55></a>echo &quot;Service Configuration&quot;
</span><span id=__span-38-56><a id=__codelineno-38-56 name=__codelineno-38-56 href=#__codelineno-38-56></a>#--------------------------------------------------
</span><span id=__span-38-57><a id=__codelineno-38-57 name=__codelineno-38-57 href=#__codelineno-38-57></a>    service
</span><span id=__span-38-58><a id=__codelineno-38-58 name=__codelineno-38-58 href=#__codelineno-38-58></a>        customer 1 create
</span><span id=__span-38-59><a id=__codelineno-38-59 name=__codelineno-38-59 href=#__codelineno-38-59></a>            description &quot;Default customer&quot;
</span><span id=__span-38-60><a id=__codelineno-38-60 name=__codelineno-38-60 href=#__codelineno-38-60></a>        exit
</span><span id=__span-38-61><a id=__codelineno-38-61 name=__codelineno-38-61 href=#__codelineno-38-61></a>    exit
</span><span id=__span-38-62><a id=__codelineno-38-62 name=__codelineno-38-62 href=#__codelineno-38-62></a>#--------------------------------------------------
</span><span id=__span-38-63><a id=__codelineno-38-63 name=__codelineno-38-63 href=#__codelineno-38-63></a>echo &quot;Router (Service Side) Configuration&quot;
</span><span id=__span-38-64><a id=__codelineno-38-64 name=__codelineno-38-64 href=#__codelineno-38-64></a>#--------------------------------------------------
</span><span id=__span-38-65><a id=__codelineno-38-65 name=__codelineno-38-65 href=#__codelineno-38-65></a>    router 
</span><span id=__span-38-66><a id=__codelineno-38-66 name=__codelineno-38-66 href=#__codelineno-38-66></a>#--------------------------------------------------
</span><span id=__span-38-67><a id=__codelineno-38-67 name=__codelineno-38-67 href=#__codelineno-38-67></a>echo &quot;OSPFv2 Configuration&quot;
</span><span id=__span-38-68><a id=__codelineno-38-68 name=__codelineno-38-68 href=#__codelineno-38-68></a>#--------------------------------------------------
</span><span id=__span-38-69><a id=__codelineno-38-69 name=__codelineno-38-69 href=#__codelineno-38-69></a>        ospf                          
</span><span id=__span-38-70><a id=__codelineno-38-70 name=__codelineno-38-70 href=#__codelineno-38-70></a>            no shutdown
</span><span id=__span-38-71><a id=__codelineno-38-71 name=__codelineno-38-71 href=#__codelineno-38-71></a>        exit
</span><span id=__span-38-72><a id=__codelineno-38-72 name=__codelineno-38-72 href=#__codelineno-38-72></a>#--------------------------------------------------
</span><span id=__span-38-73><a id=__codelineno-38-73 name=__codelineno-38-73 href=#__codelineno-38-73></a>echo &quot;ISIS Configuration&quot;
</span><span id=__span-38-74><a id=__codelineno-38-74 name=__codelineno-38-74 href=#__codelineno-38-74></a>#--------------------------------------------------
</span><span id=__span-38-75><a id=__codelineno-38-75 name=__codelineno-38-75 href=#__codelineno-38-75></a>        isis
</span><span id=__span-38-76><a id=__codelineno-38-76 name=__codelineno-38-76 href=#__codelineno-38-76></a>            no shutdown
</span><span id=__span-38-77><a id=__codelineno-38-77 name=__codelineno-38-77 href=#__codelineno-38-77></a>        exit
</span><span id=__span-38-78><a id=__codelineno-38-78 name=__codelineno-38-78 href=#__codelineno-38-78></a>#--------------------------------------------------
</span><span id=__span-38-79><a id=__codelineno-38-79 name=__codelineno-38-79 href=#__codelineno-38-79></a>echo &quot;BGP Configuration&quot;
</span><span id=__span-38-80><a id=__codelineno-38-80 name=__codelineno-38-80 href=#__codelineno-38-80></a>#--------------------------------------------------
</span><span id=__span-38-81><a id=__codelineno-38-81 name=__codelineno-38-81 href=#__codelineno-38-81></a>        bgp
</span><span id=__span-38-82><a id=__codelineno-38-82 name=__codelineno-38-82 href=#__codelineno-38-82></a>            group &quot;iBGP&quot;
</span><span id=__span-38-83><a id=__codelineno-38-83 name=__codelineno-38-83 href=#__codelineno-38-83></a>                peer-as 65510
</span><span id=__span-38-84><a id=__codelineno-38-84 name=__codelineno-38-84 href=#__codelineno-38-84></a>                neighbor 10.10.10.1
</span><span id=__span-38-85><a id=__codelineno-38-85 name=__codelineno-38-85 href=#__codelineno-38-85></a>                exit
</span><span id=__span-38-86><a id=__codelineno-38-86 name=__codelineno-38-86 href=#__codelineno-38-86></a>                neighbor 10.10.10.2
</span><span id=__span-38-87><a id=__codelineno-38-87 name=__codelineno-38-87 href=#__codelineno-38-87></a>                exit
</span><span id=__span-38-88><a id=__codelineno-38-88 name=__codelineno-38-88 href=#__codelineno-38-88></a>                neighbor 10.10.10.5
</span><span id=__span-38-89><a id=__codelineno-38-89 name=__codelineno-38-89 href=#__codelineno-38-89></a>                exit
</span><span id=__span-38-90><a id=__codelineno-38-90 name=__codelineno-38-90 href=#__codelineno-38-90></a>            exit
</span><span id=__span-38-91><a id=__codelineno-38-91 name=__codelineno-38-91 href=#__codelineno-38-91></a>            no shutdown
</span><span id=__span-38-92><a id=__codelineno-38-92 name=__codelineno-38-92 href=#__codelineno-38-92></a>        exit                          
</span><span id=__span-38-93><a id=__codelineno-38-93 name=__codelineno-38-93 href=#__codelineno-38-93></a>    exit
</span><span id=__span-38-94><a id=__codelineno-38-94 name=__codelineno-38-94 href=#__codelineno-38-94></a>
</span><span id=__span-38-95><a id=__codelineno-38-95 name=__codelineno-38-95 href=#__codelineno-38-95></a>
</span><span id=__span-38-96><a id=__codelineno-38-96 name=__codelineno-38-96 href=#__codelineno-38-96></a>exit all
</span></code></pre></div> <h2 id=__comments>Comments</h2> <script src=https://giscus.app/client.js data-repo=hellt/netdevops.me data-repo-id="MDEwOlJlcG9zaXRvcnkzNTkzNTc5ODc=" data-category="Show and tell" data-category-id=DIC_kwDOFWteI84CRmVn data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async>
    </script> <!-- Synchronize Giscus theme with palette --> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate" ? "dark" : "light"
        giscus.setAttribute("data-theme", theme)
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function () {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function () {
            var palette = __md_get("__palette")
            if (palette && typeof palette.color === "object") {
                var theme = palette.color.scheme === "slate" ? "dark" : "light"

                /* Instruct Giscus to change theme */
                var frame = document.querySelector(".giscus-frame")
                frame.contentWindow.postMessage(
                    { giscus: { setConfig: { theme } } },
                    "https://giscus.app"
                )
            }
        })
    })
</script> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs Insiders </a> </div> <div class=md-social> <a href=https://github.com/hellt target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/ntdvps target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.top", "navigation.instant", "navigation.tabs", "search.suggest", "content.code.annotate", "toc.follow", "content.tooltips", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.1e90e0fb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.2b189340.min.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>