<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Applying DevOps to networks."><meta name=author content="Roman Dodin"><link href=https://netdevops.me/2019/creating-google-cloud-platform-function-with-python-and-serverless/ rel=canonical><link href=../how-to-download-an-m3um3u8-playlist-stream-without-a-special-software/ rel=prev><link href=../creating-a-bootstrap-based-front-end-for-your-simple-rest-service/ rel=next><link rel=alternate type=application/rss+xml title="RSS feed" href=../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../../feed_rss_updated.xml><link rel=icon href=../../assets/images/code.svg><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.4.14+insiders-4.46.0"><title>Creating Google Cloud Platform Function with Python and Serverless - Applying DevOps to networks</title><link rel=stylesheet href=../../assets/stylesheets/main.0ab26e37.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Google Sans";--md-code-font:"Fira Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-Y7R34KCT4N"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-Y7R34KCT4N",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-Y7R34KCT4N",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#creating-google-cloud-platform-function-with-python-and-serverless class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <a href=https://twitter.com/ntdvps> For updates follow <strong>@ntdvps</strong> on <span class="twemoji twitter"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </span> <strong>Twitter</strong> </a> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Applying DevOps to networks" class="md-header__button md-logo" aria-label="Applying DevOps to networks" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Applying DevOps to networks </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Creating Google Cloud Platform Function with Python and Serverless </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=cyan aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hellt/netdevops.me title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> hellt/netdevops.me </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class="md-tabs__item md-tabs__item--active"> <a href=../.. class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../tags/ class=md-tabs__link> Tags </a> </li> <li class=md-tabs__item> <a href=../../subscribe/ class=md-tabs__link> Subscribe </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Applying DevOps to networks" class="md-nav__button md-logo" aria-label="Applying DevOps to networks" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg> </a> Applying DevOps to networks </label> <div class=md-nav__source> <a href=https://github.com/hellt/netdevops.me title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> hellt/netdevops.me </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1 checked> <div class="md-nav__link md-nav__container"> <a href=../.. class="md-nav__link "> <span class=md-ellipsis> Blog </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=true> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> <li class=md-nav__item> <a href=../../subscribe/ class=md-nav__link> <span class=md-ellipsis> Subscribe </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#agenda class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Agenda </span> </span> </a> </li> <li class=md-nav__item> <a href=#1-google-cloud-platform class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 1 Google Cloud Platform </span> </span> </a> </li> <li class=md-nav__item> <a href=#2-function-creation class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 2 Function creation </span> </span> </a> <nav class=md-nav aria-label="2 Function creation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-serverless-service-template class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 2.1 Serverless service template </span> </span> </a> </li> <li class=md-nav__item> <a href=#22-testing-function-deployment class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 2.2 Testing function deployment </span> </span> </a> </li> <li class=md-nav__item> <a href=#23-writing-a-function class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 2.3 Writing a Function </span> </span> </a> <nav class=md-nav aria-label="2.3 Writing a Function"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#231-managing-code-dependencies class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 2.3.1 Managing code dependencies </span> </span> </a> </li> <li class=md-nav__item> <a href=#232-events class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 2.3.2 Events </span> </span> </a> </li> <li class=md-nav__item> <a href=#233-writing-a-function class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 2.3.3 Writing a function </span> </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#24-logging class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 2.4 Logging </span> </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-function-deployment class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 3 Function deployment </span> </span> </a> </li> <li class=md-nav__item> <a href=#4-usage-examples class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 4 Usage examples </span> </span> </a> <nav class=md-nav aria-label="4 Usage examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#41-empty-get-request class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 4.1 empty GET request </span> </span> </a> </li> <li class=md-nav__item> <a href=#42-post-with-a-root-and-pycatj_data-specified class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 4.2 POST with a root and pycatj_data specified </span> </span> </a> </li> <li class=md-nav__item> <a href=#43-post-without-root-with-pycatj_data class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 4.3 POST without root, with pycatj_data </span> </span> </a> </li> <li class=md-nav__item> <a href=#44-post-with-json-file-as-a-body class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 4.4 POST with json file as a body </span> </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#whats-next class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> What's next? </span> </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=../.. class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img src=https://avatars.githubusercontent.com/u/5679861 alt="Roman Dodin"> </span> <span class=md-profile__description> <strong> Roman Dodin </strong> <br> Network Automater </span> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Metadata </span> </div> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg> <time datetime="2019-06-30 00:00:00" class=md-ellipsis>June 30, 2019</time> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg> <span class=md-ellipsis> 12 min read </span> </div> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a href=../../tags/#gcp class=md-tag>gcp</a> <a href=../../tags/#gcp-function class=md-tag>gcp function</a> <a href=../../tags/#python class=md-tag>python</a> <a href=../../tags/#serverless class=md-tag>serverless</a> </nav> <h1 id=creating-google-cloud-platform-function-with-python-and-serverless>Creating Google Cloud Platform Function with Python and Serverless<a class=headerlink href=#creating-google-cloud-platform-function-with-python-and-serverless title="Permanent link">#</a></h1> <p>Two years ago <a href=../../2017/building-aws-lambda-with-python-s3-and-serverless/ >I shared</a> my experience on building the AWS Lambda function for a python project of my own. And a few days ago I stumbled upon a nice opensource CLI tool that I immediately wanted to transform in a web service.</p> <!-- more --> <p><a class=glightbox href=https://gitlab.com/rdodin/pics/-/wikis/uploads/e4f956d64dcf812f64a77f8532499d07/image.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=serverless src=https://gitlab.com/rdodin/pics/-/wikis/uploads/e4f956d64dcf812f64a77f8532499d07/image.png></a></p> <p>Naturally, a simple, single-purpose tool is a perfect candidate for function-as-a-service (FaaS), and since I had past experience with AWS Lambda, this time I decided to meet its Google's sibling - <a href=https://cloud.google.com/functions/ >Google Cloud Function</a>.</p> <p>In this post we'll discover how to take a python package with 3<sup>rd</sup> party dependencies, make a GCP Function from it and deploy it without a single click in the UI - all without leaving the IDE.</p> <p>[<a href=https://github.com/hellt/pycatj-web>Project's source code</a>]</p> <p>The python tool I considered a natural fit for a Cloud Function is a <a href=https://github.com/dbarrosop/pycatj><code>pycatj</code></a> by <strong>David Barroso</strong> that he released just recently.</p> <p><center><blockquote class=twitter-tweet><p dir=ltr>For those with problems accessing yaml/json data: <a href=https://t.co/IbbS3x05bq><a href=https://t.co/IbbS3x05bq>https://t.co/IbbS3x05bq</a></a></p>&mdash; David Barroso (@dbarrosop) <a href="https://twitter.com/dbarrosop/status/1143810284513107968?ref_src=twsrc%5Etfw">June 26, 2019</a></blockquote> <script async src=https://platform.twitter.com/widgets.js charset=utf-8></script></center></p> <p>This tool helps you to map a JSON/YAML file to a Python dictionary highlighting the keys you need to access the nested data:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=err>$</span><span class=w> </span><span class=err>ca</span><span class=kc>t</span><span class=w> </span><span class=kc>tests</span><span class=err>/da</span><span class=kc>ta</span><span class=err>/</span><span class=kc>test</span><span class=err>_</span><span class=mf>1.</span><span class=err>jso</span><span class=kc>n</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=p>{</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span><span class=nt>&quot;somekey&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;somevalue&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>    </span><span class=nt>&quot;somenumber&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>123</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=nt>&quot;a_dict&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>        </span><span class=nt>&quot;asd&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;123&quot;</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>        </span><span class=nt>&quot;qwe&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>],</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>        </span><span class=nt>&quot;nested_dict&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>            </span><span class=nt>&quot;das&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>31</span><span class=p>,</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=w>            </span><span class=nt>&quot;qwe&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;asd&quot;</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=p>}</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=err>$</span><span class=w> </span><span class=err>pyca</span><span class=kc>t</span><span class=err>j</span><span class=w> </span><span class=mi>--</span><span class=err>roo</span><span class=kc>t</span><span class=w> </span><span class=err>my_var</span><span class=w> </span><span class=kc>tests</span><span class=err>/da</span><span class=kc>ta</span><span class=err>/</span><span class=kc>test</span><span class=err>_</span><span class=mf>1.</span><span class=err>jso</span><span class=kc>n</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=err>my_var</span><span class=p>[</span><span class=s2>&quot;somekey&quot;</span><span class=p>]</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=s2>&quot;somevalue&quot;</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=err>my_var</span><span class=p>[</span><span class=s2>&quot;somenumber&quot;</span><span class=p>]</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=mi>123</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=err>my_var</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;asd&quot;</span><span class=p>]</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=s2>&quot;123&quot;</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=err>my_var</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;qwe&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=err>my_var</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;qwe&quot;</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=err>my_var</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;qwe&quot;</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=err>my_var</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;nested_dict&quot;</span><span class=p>][</span><span class=s2>&quot;das&quot;</span><span class=p>]</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=mi>31</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=err>my_var</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;nested_dict&quot;</span><span class=p>][</span><span class=s2>&quot;qwe&quot;</span><span class=p>]</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=s2>&quot;asd&quot;</span>
</span></code></pre></div> <p>I felt like having a single-page web service that would do these transformations leveraging the <code>pycatj</code> would be helpful to somebody sometime.<br> Probably the easiest way would be to rewrite the same code with JavaScript and create a static page with that code without any backend, but <em>does it spark joy?</em>. Not even a bit.</p> <p>And as a starting point I decided to create a serverless function that will rely on <code>pycatj</code> and will be triggered later by a Web frontend with an HTTP request carrying the content for <em>pycatj-ifying</em>.</p> <p>In a nutshell, the function should behave something like that:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>curl<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span>https://api-endpoint.com<span class=w> </span>-d<span class=w> </span><span class=s1>&#39;{&quot;data&quot;:{&quot;somekey&quot;:&quot;value1&quot;}}&#39;</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=c1># returns</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>my_var<span class=o>[</span><span class=s2>&quot;somekey&quot;</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;value1&quot;</span>
</span></code></pre></div> <p>To add some sugar to the mix I will leverage the <a href=https://serverless.com>serverless</a> framework to do the heavy lifting in a code-first way. The plan is set, lets go see it to completion.</p> <h2 id=agenda>Agenda<a class=headerlink href=#agenda title="Permanent link">#</a></h2> <p>The decomposition of the service creation and deployment can be done as follows:</p> <ol> <li>Google Cloud Platform</li> <li>Create a GCP account (if needed) and acquire the API credentials</li> <li>Create a project in GCP that will host a Function and enable the needed APIs for serverless to be able to create the Function and its artifacts</li> <li>Function creation and testing</li> <li>create the code in conformance with the GCP Function handlers/events rules</li> <li>Manage code dependencies</li> <li>Function deployment</li> <li>leveraging serverless framework to deploy a function to GCP</li> <li>Add a frontend (in another blog post) that will use the serverless function.</li> </ol> <h2 id=1-google-cloud-platform>1 Google Cloud Platform<a class=headerlink href=#1-google-cloud-platform title="Permanent link">#</a></h2> <p>Following the agenda, ensure that you have a working GCP account (trial gives you $300, and GCP Function is perpetually FREE with the sane usage thresholds). Make sure that you have a billing account created, this is set up when you opt in the free trial program, for example. Without a linked billing account the Functions won't work.</p> <p>Once you have your account set, you should either continue with a default project or create a new one. In either case you need to enable the APIs that will be leveraged by serverless framework for a function deployment process. Go thru <a href=https://serverless.com/framework/docs/providers/google/guide/credentials/ >this guide</a> carefully on how to enable the right APIs.</p> <p><strong>API credentials</strong></p> <p>Do not forget to download your API credentials, as nothing can be done without them. This <a href=https://serverless.com/framework/docs/providers/google/guide/credentials/#get-credentials--assign-roles>guide's section</a> explains it all.<br> The commands you will see in the rest of this post assume that the credentials are stored in <code>~/.gcould</code> directory.</p> <h2 id=2-function-creation>2 Function creation<a class=headerlink href=#2-function-creation title="Permanent link">#</a></h2> <p>Since we are living on the edge, we will rely on the <a href=https://serverless.com>serverless</a> framework to create &amp; deploy our function. The very same framework <a href=../../2017/building-aws-lambda-with-python-s3-and-serverless/ >I leveraged</a> for the AWS Lambda creation, so why not try it for GCP Function?</p> <p>The notable benefit of serverless framework is that it allows you to define your Function deployment <em>as a code</em> and thus making it repeatable, versionable and fast.</p> <p>But nothing comes cheap, for all these perks you need to pay; and the serverless toll is in being a Javascript package =|. Don't know about you, but <em>no glove - no love</em> is the principle I try to stick to with JS. So why not quarantine it in a <a href=https://hub.docker.com/r/amaysim/serverless>docker container</a> jail and keep your machine npm-free?</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>docker<span class=w> </span>pull<span class=w> </span>amaysim/serverless:1.45.1
</span></code></pre></div> <h3 id=21-serverless-service-template>2.1 Serverless service template<a class=headerlink href=#21-serverless-service-template title="Permanent link">#</a></h3> <p>The way I start my serverless journey is by telling the serverless to <a href=https://serverless.com/framework/docs/providers/google/cli-reference/create/#available-templates>generate a service template</a> in the programming language of my choice. Later we can tune bits and pieces of that <a href=https://serverless.com/framework/docs/providers/aws/guide/services/ >service</a>, but if you start from a zero-ground, its easier to have a scaffolding to work on.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Create service with `google-python` template in the folder ~/projects/pycatj-web</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>docker<span class=w> </span>run<span class=w> </span>--rm<span class=w> </span><span class=se>\</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w> </span>-v<span class=w> </span>~/projects/pycatj-web:/opt/app<span class=w> </span><span class=se>\</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w> </span>amaysim/serverless:1.45.1<span class=w> </span><span class=se>\</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w> </span>serverless<span class=w> </span>create<span class=w> </span>--template<span class=w> </span>google-python<span class=w> </span>--path<span class=w> </span>pycatj-serverless
</span></code></pre></div> <p>The result of the <code>serverless create --template &lt;template&gt;</code> command will be a directory with a boilerplate code for our function and a few serverless artifacts.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># artifacts created by `serverless create --template`</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>$<span class=w> </span>tree<span class=w> </span>pycatj-serverless/
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>pycatj-serverless/
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>├──<span class=w> </span>main.py
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>├──<span class=w> </span>package.json
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>└──<span class=w> </span>serverless.yml
</span></code></pre></div> <p>We need to take a closer look at the generated <code>serverless.yml</code> template file where we need to make some adjustments:</p> <ol> <li>the project name should match the project name you have created in the GCP</li> <li>the path to your GCP credentials json file should be valid</li> </ol> <p>Given that the project in my GCP is called <code>pycatj</code> and my credentials file is <code>~/.gcloud/pycatj-d6af60eda976.json</code> the <code>provider</code> section of the <code>serverless.yml</code> file would look like this:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a># serverless.yml file
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a># with project name and credentials file specified
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>provider:
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>  name: google
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>  stage: dev
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>  runtime: python37
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>  region: us-central1
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>  project: pycatj
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>  credentials: ~/.gcloud/pycatj-d6af60eda976.json
</span></code></pre></div> <p>As to the <code>main.py</code> generated by the framework, then its a simple boilerplate code with a text reply to an incoming HTTP request wrapped in a Flask object.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># main.py</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=k>def</span> <span class=nf>http</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Responds to any HTTP request.</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=sd>    Args:</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=sd>        request (flask.Request): HTTP request object.</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=sd>    Returns:</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=sd>        The response text or any set of values that can be turned into a</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=sd>        Response object using</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=sd>        `make_response &lt;http://flask.pocoo.org/docs/1.0/api/#flask.Flask.make_response&gt;`.</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>    <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;Hello World!&#39;</span>
</span></code></pre></div> <p>Lets test that our modifications work out so far by trying to deploy the template service.</p> <h3 id=22-testing-function-deployment>2.2 Testing function deployment<a class=headerlink href=#22-testing-function-deployment title="Permanent link">#</a></h3> <p>Before we start pushing our function and its artifacts to the GCP, we need to tell serverless how to talk to the cloud provider. To do that, we need to install the <code>serverless-google-cloudfunctions</code> plugin that is <a href=https://github.com/hellt/pycatj-web/blob/master/pycatj-serverless/serverless.yml#L18>referenced</a> in the <code>serverless.yml</code> file.</p> <p>Install the google cloud functions plugin with the <code>npm install</code> command using the directory with a generated serverless service files:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>docker<span class=w> </span>run<span class=w> </span>--rm<span class=w> </span><span class=se>\</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>  </span>-v<span class=w> </span>~/.gcloud/:/root/.gcloud<span class=w> </span><span class=se>\</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>  </span>-v<span class=w> </span>~/projects/pycatj-web/pycatj-serverless:/opt/app<span class=w> </span><span class=se>\</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>  </span>amaysim/serverless:1.45.1<span class=w> </span>npm<span class=w> </span>install
</span></code></pre></div> <p>Note, here I mount my GCP credentials that are stored at <code>~/.gcloud</code> dir to a containers <code>/root/.gcloud</code> dir where serverless container will find them as they are referenced in the <code>serverless.yml</code> file.<br> And secondly I bind mount my project's directory <code>~/projects/pycatj-web/pycatj-serverless</code> to the <code>/opt/app</code> dir inside the container that is a <code>WORKDIR</code> of that container.</p> <p>Now we have a green flag to try out the deployment process with <code>serverless deploy</code>:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>docker run --rm \
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>  -v ~/.gcloud/:/root/.gcloud \
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>  -v ~/projects/pycatj-web/pycatj-serverless:/opt/app \
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>  amaysim/serverless:1.45.1 serverless deploy
</span></code></pre></div> <blockquote> <p>If the deployment <a href=https://github.com/serverless/serverless-google-cloudfunctions/issues/82#issuecomment-326222674>fails</a> with the <strong>Error Not Found</strong> make sure that you don't have stale failed deployments by going to <strong>Cloud Console -&gt; Deployment Manager</strong> and deleting all deployments created by Serverless</p> </blockquote> <p>Upon a successful deployment you will have a Cloud Function deployed and reachable by the service URL:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>Deployed functions
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>first
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>  https://us-central1-pycatj.cloudfunctions.net/http
</span></code></pre></div> <p><code>curl</code>-ing that API endpoint will return a simple "Hello world" as coded in our boilerplate <code>main.py</code> function:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># main.py</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=k>def</span> <span class=nf>http</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;Hello World!&#39;</span>
</span></code></pre></div> <div class="language-bash highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>curl<span class=w> </span>-s<span class=w> </span>https://us-central1-pycatj.cloudfunctions.net/http
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>Hello<span class=w> </span>World!
</span></code></pre></div> <p>You can also verify the resources that were created by this deployment by visiting the <strong>Deployment Manager</strong> in the GCP console as well as navigating to the functions page and examine the deployed function and its properties:</p> <p><a class=glightbox href=https://gitlab.com/rdodin/pics/-/wikis/uploads/10b4d747ddda7e773d8b21767619b9df/image.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=function src=https://gitlab.com/rdodin/pics/-/wikis/uploads/10b4d747ddda7e773d8b21767619b9df/image.png></a></p> <h3 id=23-writing-a-function>2.3 Writing a Function<a class=headerlink href=#23-writing-a-function title="Permanent link">#</a></h3> <p>That was a template <a href=https://serverless.com/framework/docs/providers/google/guide/functions/ >function</a> that we just <a href=https://serverless.com/framework/docs/providers/google/guide/deploying/ >deployed</a> with the HTTP <a href=https://serverless.com/framework/docs/providers/google/guide/events/ >event</a> acting as a trigger.</p> <p>Lets see how the the actual Python function is coupled to a service definition inside the serverless file. How about we give our function a different name by first changing the <code>functions</code> section of the <code>serverless.yml</code> file:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># changing the function name and handler to `pycatjify`</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=nt>functions</span><span class=p>:</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>  </span><span class=nt>pycatjify</span><span class=p>:</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>    </span><span class=nt>handler</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pycatjify</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>    </span><span class=nt>events</span><span class=p>:</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>http</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">path</span>
</span></code></pre></div> <p>Since we changed the function and the handler name to <code>pycatjify</code> we should do the same to our function inside the <code>main.py</code> file:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>def</span> <span class=nf>pycatjify</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;We are going to give pycatj its own place on the web!&quot;</span>
</span></code></pre></div> <p>Deploying this function will give us a new API endpoint aligned to a new function name we specified in the <code>serverless.yml</code>:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>Deployed<span class=w> </span>functions
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>pycatjify
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>  </span>https://us-central1-pycatj.cloudfunctions.net/pycatjify
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=c1># testing</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>$<span class=w> </span>curl<span class=w> </span>https://us-central1-pycatj.cloudfunctions.net/pycatjify
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>We<span class=w> </span>are<span class=w> </span>going<span class=w> </span>to<span class=w> </span>give<span class=w> </span>pycatj<span class=w> </span>its<span class=w> </span>own<span class=w> </span>place<span class=w> </span>on<span class=w> </span>the<span class=w> </span>web!
</span></code></pre></div> <h4 id=231-managing-code-dependencies>2.3.1 Managing code dependencies<a class=headerlink href=#231-managing-code-dependencies title="Permanent link">#</a></h4> <p>Up until now we played with a boilerplate code with a few names changed to give our function a bit of an identity. We reached the stage when its time to onboard the <code>pycatj</code> package and make our function benefit from it.</p> <p>Since the Functions are executed in the sandboxes on the cloud platforms, we must somehow tell what dependencies we want these sandbox to have when running our code. In the <a href=https://netdevops.me/2017/building-aws-lambda-with-python-s3-and-serverless#adding-python-packages-to-lambda>AWS Lambda example</a> we packaged the 3<sup>rd</sup> party libraries along the function (aka vendoring).</p> <p>In GCP case the <a href=../../2017/building-aws-lambda-with-python-s3-and-serverless/#adding-python-packages-to-lambda>vendoring</a> approach is also possible and is done in the same way, but it is also possible to ship a pip <code>requirements.txt</code> file along your <code>main.py</code> that will specify your function dependencies as pythonistas used to.</p> <blockquote> <p>Read more on GCP python <a href=https://cloud.google.com/functions/docs/writing/specifying-dependencies-python>dependency</a> management</p> </blockquote> <p>Unfortunately, the PIP version that GCP currently uses does not support <a href=https://www.python.org/dev/peps/pep-0517/ >PEP 517</a>, so it was not possible to specify <code>-e git+https://github.com/dbarrosop/pycatj.git#egg=pycatj</code> in a requirements file, thus I continued with a good old vendoring technique:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=c1># executed in ~/projects/pycatj-web/pycatj-serverless</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>pip3<span class=w> </span>install<span class=w> </span>-t<span class=w> </span>./vendored<span class=w> </span>git+https://github.com/dbarrosop/pycatj.git
</span></code></pre></div> <p>This installs <code>pycatj</code> package and its dependencies in a <code>vendored</code> directory and will be considered as Function's artifact and pushed to GCP along the <code>main.py</code> with the next <code>serverless deploy</code> command.</p> <h4 id=232-events>2.3.2 Events<a class=headerlink href=#232-events title="Permanent link">#</a></h4> <p>Every function should be triggered by an <a href=https://cloud.google.com/functions/docs/concepts/events-triggers>event or a trigger</a> that is supported by a cloud provider. When serverless is used the event type is specified for each function in the <code>serverless.yml</code> file:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1># pycatjify function is triggered by an event of type `http`</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=c1># note that they key `path` is irrelevant to the serverless</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=nt>functions</span><span class=p>:</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>  </span><span class=nt>pycatjify</span><span class=p>:</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=w>    </span><span class=nt>handler</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pycatjify</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>    </span><span class=nt>events</span><span class=p>:</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>http</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">path</span>
</span></code></pre></div> <p>With this configuration we expect our function to execute once an HTTP request hits the function API endpoint.</p> <h4 id=233-writing-a-function>2.3.3 Writing a function<a class=headerlink href=#233-writing-a-function title="Permanent link">#</a></h4> <p>Yes, a thousand words later we finally at a milestone where we write actual python code for a function. The template we generated earlier gives us a good starting point - a function body with a single <a href=hhttps://flask.palletsprojects.com/en/1.1.x/api/#flask.request>Flask <code>request</code></a> argument:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=k>def</span> <span class=nf>pycatj</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;We are going to give pycatj its own place on the web!&quot;</span>
</span></code></pre></div> <p>The logic of our serverless function that we are coding here is:</p> <ol> <li>parse the contents of an incoming HTTP request extracting the contents of a JSON file passed along with it</li> <li>transform the received data with <code>pycatj</code> package and send back the response</li> </ol> <p>With a few additions to access the <code>pycatj</code> package in a <code>vendored</code> directory and being able to test the function locally, the resulting <a href=https://github.com/hellt/pycatj-web/blob/master/pycatj-serverless/main.py><code>main.py</code></a> file looks as follows:</p> <script src=https://gist.github.com/hellt/d44b58c2f0c8b5f1be46047c9916aa82.js></script> <p>This code has some extra additions to a simple two-step logic I mentioned before. I stuffed a default <code>data</code> value that will be used when the incoming request has no body, then we will use this dummy data just for demonstration purposes.<br> To let me test the function code locally I added the <code>if __name__ == "__main__":</code> condition and lastly I wrote some <code>print</code> functions for a trivial logging. Speaking of which...</p> <h3 id=24-logging>2.4 Logging<a class=headerlink href=#24-logging title="Permanent link">#</a></h3> <p>Logging is a bless! Having a chance to look what happens with your function in a cloud platform sandbox is definitely a plus. With GCP the <a href=https://cloud.google.com/functions/docs/monitoring/logging#functions-log-helloworld-python>logging</a> can be done in the simple and advanced modes. A simple logging logs everything that is printed by a function into <code>stdout/stderr</code> outputs -&gt; a simple <code>print()</code> function would suffice. In a more advanced mode you would leverage a GCP Logging API.</p> <p>The logs can be viewed with the Web UI Logging interface, as well as with the <code>gcloud</code> CLI tool.</p> <h2 id=3-function-deployment>3 Function deployment<a class=headerlink href=#3-function-deployment title="Permanent link">#</a></h2> <p>We previously already tried the deployed process with a boilerplate code just to make sure that the serverless framework works. Now that we have our <code>pycatj</code> package and its dependencies stored in a <code>vendored</code> folder and the function body is filled with the actual code, lets repeat the deployment and see what we get:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a>docker run --rm \
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>  -v ~/.gcloud/:/root/.gcloud \
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>  -v ~/projects/pycatj-web/pycatj-serverless:/opt/app \
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>  amaysim/serverless:1.45.1 serverless deploy
</span></code></pre></div> <p>All goes well and serverless successfully updates our function to include the vendored artifacts as well as the new code in the <code>main.py</code>. Under the hood, the deployment process took the code of our Function and packaged it into a directory, zipped and uploaded to the deployment bucket.</p> <p>As demonstrated above, the serverless framework allows a user to express the deployment in a code, making the process extremely easy and fast.</p> <h2 id=4-usage-examples>4 Usage examples<a class=headerlink href=#4-usage-examples title="Permanent link">#</a></h2> <p>Time to give our Function a roll by bombing it with HTTP requests. In this section I will show you how you can use the pycatjify service within a CLI and in a subsequent post we will write a simple Web UI using the API that our function provides.</p> <h3 id=41-empty-get-request>4.1 empty GET request<a class=headerlink href=#41-empty-get-request title="Permanent link">#</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>curl</span> <span class=o>-</span><span class=n>s</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>us</span><span class=o>-</span><span class=n>central1</span><span class=o>-</span><span class=n>pycatj</span><span class=o>.</span><span class=n>cloudfunctions</span><span class=o>.</span><span class=n>net</span><span class=o>/</span><span class=n>pycatjify</span> <span class=o>|</span> <span class=n>jq</span> <span class=o>-</span><span class=n>r</span> <span class=o>.</span><span class=n>data</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=c1># returns</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=n>my_dict</span><span class=p>[</span><span class=s2>&quot;data&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;test_value&quot;</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=n>my_dict</span><span class=p>[</span><span class=s2>&quot;somenumber&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>123</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=n>my_dict</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;asd&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;123&quot;</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=n>my_dict</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;qwe&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=n>my_dict</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;qwe&quot;</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>2</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=n>my_dict</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;qwe&quot;</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>3</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=n>my_dict</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;nested_dict&quot;</span><span class=p>][</span><span class=s2>&quot;das&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>31</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=n>my_dict</span><span class=p>[</span><span class=s2>&quot;a_dict&quot;</span><span class=p>][</span><span class=s2>&quot;nested_dict&quot;</span><span class=p>][</span><span class=s2>&quot;qwe&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;asd&quot;</span>
</span></code></pre></div> <p>With an empty GET request the function delivers a demo of its capabilities by taking a hardcoded demo JSON and making a transformation. The returned string is returned in a JSON object accessible by the <code>data</code> key.</p> <h3 id=42-post-with-a-root-and-pycatj_data-specified>4.2 POST with a root and pycatj_data specified<a class=headerlink href=#42-post-with-a-root-and-pycatj_data-specified title="Permanent link">#</a></h3> <p>Getting a demo response back is useless, to make use of a pycatjify service a user can specify the <code>root</code> value and pass the original JSON data in a POST request body using the <code>pycatj_data</code> key:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>curl<span class=w> </span>-sX<span class=w> </span>POST<span class=w> </span>https://us-central1-pycatj.cloudfunctions.net/pycatjify<span class=w> </span><span class=se>\</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=w>  </span>-H<span class=w> </span><span class=s2>&quot;Content-Type: application/json&quot;</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=w>  </span>-d<span class=w> </span><span class=s1>&#39;{&quot;root&quot;:&quot;POST&quot;,&quot;pycatj_data&quot;:{&quot;somekey&quot;:&quot;somevalue&quot;,&quot;a_dict&quot;:{&quot;qwe&quot;:[1,2],&quot;nested_dict&quot;:{&quot;das&quot;:31}}}}&#39;</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>  </span><span class=p>|</span><span class=w> </span>jq<span class=w> </span>-r<span class=w> </span>.data
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=c1># returns</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>POST<span class=o>[</span><span class=s2>&quot;somekey&quot;</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;somevalue&quot;</span>
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a>POST<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;qwe&quot;</span><span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>1</span>
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>POST<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;qwe&quot;</span><span class=o>][</span><span class=m>1</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>2</span>
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>POST<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;nested_dict&quot;</span><span class=o>][</span><span class=s2>&quot;das&quot;</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>31</span>
</span></code></pre></div> <h3 id=43-post-without-root-with-pycatj_data>4.3 POST without root, with pycatj_data<a class=headerlink href=#43-post-without-root-with-pycatj_data title="Permanent link">#</a></h3> <p>It is also allowed to omit the <code>root</code> key, in that case a default root value will be applied:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>curl<span class=w> </span>-sX<span class=w> </span>POST<span class=w> </span>https://us-central1-pycatj.cloudfunctions.net/pycatjify<span class=w> </span><span class=se>\</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=w>  </span>-H<span class=w> </span><span class=s2>&quot;Content-Type: application/json&quot;</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=w>  </span>-d<span class=w> </span><span class=s1>&#39;{&quot;pycatj_data&quot;:{&quot;somekey&quot;:&quot;somevalue&quot;,&quot;a_dict&quot;:{&quot;qwe&quot;:[1,2],&quot;nested_dict&quot;:{&quot;das&quot;:31}}}}&#39;</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=w>  </span><span class=p>|</span><span class=w> </span>jq<span class=w> </span>-r<span class=w> </span>.data
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=c1># returns</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>my_dict<span class=o>[</span><span class=s2>&quot;somekey&quot;</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;somevalue&quot;</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>my_dict<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;qwe&quot;</span><span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>1</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>my_dict<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;qwe&quot;</span><span class=o>][</span><span class=m>1</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>2</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>my_dict<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;nested_dict&quot;</span><span class=o>][</span><span class=s2>&quot;das&quot;</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>31</span>
</span></code></pre></div> <h3 id=44-post-with-json-file-as-a-body>4.4 POST with json file as a body<a class=headerlink href=#44-post-with-json-file-as-a-body title="Permanent link">#</a></h3> <p>My personal favorite is dumping a JSON file in a request. In that case a lengthy <code>curl</code> is not needed and you can specify a path to a file with a <code>@</code> char.<br> This example leverages the logic embedded in a function that treats the whole body of an incoming request as a data for <code>pycatj</code> transformation.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>$<span class=w> </span>cat<span class=w> </span>test/test1.json
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=o>{</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=w>    </span><span class=s2>&quot;somekey&quot;</span>:<span class=w> </span><span class=s2>&quot;localfile&quot;</span>,
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=w>    </span><span class=s2>&quot;a_dict&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=w>        </span><span class=s2>&quot;asd&quot;</span>:<span class=w> </span><span class=s2>&quot;123&quot;</span>,
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=w>        </span><span class=s2>&quot;qwe&quot;</span>:<span class=w> </span><span class=o>[</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=w>            </span><span class=m>1</span>,
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=w>            </span><span class=m>2</span>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=w>        </span><span class=o>]</span>,
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=w>        </span><span class=s2>&quot;nested_dict&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=w>            </span><span class=s2>&quot;das&quot;</span>:<span class=w> </span><span class=m>31</span>,
</span><span id=__span-22-12><a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a><span class=w>            </span><span class=s2>&quot;qwe&quot;</span>:<span class=w> </span><span class=s2>&quot;asd&quot;</span>
</span><span id=__span-22-13><a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a><span class=w>        </span><span class=o>}</span>
</span><span id=__span-22-14><a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-22-15><a id=__codelineno-22-15 name=__codelineno-22-15 href=#__codelineno-22-15></a><span class=o>}</span>
</span><span id=__span-22-16><a id=__codelineno-22-16 name=__codelineno-22-16 href=#__codelineno-22-16></a>
</span><span id=__span-22-17><a id=__codelineno-22-17 name=__codelineno-22-17 href=#__codelineno-22-17></a>curl<span class=w> </span>-sX<span class=w> </span>POST<span class=w> </span>https://us-central1-pycatj.cloudfunctions.net/pycatjify<span class=w> </span><span class=se>\</span>
</span><span id=__span-22-18><a id=__codelineno-22-18 name=__codelineno-22-18 href=#__codelineno-22-18></a><span class=w>  </span>-H<span class=w> </span><span class=s2>&quot;Content-Type: application/json&quot;</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-22-19><a id=__codelineno-22-19 name=__codelineno-22-19 href=#__codelineno-22-19></a><span class=w>  </span>-d<span class=w> </span><span class=s2>&quot;@./test/test1.json&quot;</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-22-20><a id=__codelineno-22-20 name=__codelineno-22-20 href=#__codelineno-22-20></a><span class=w>  </span><span class=p>|</span><span class=w> </span>jq<span class=w> </span>-r<span class=w> </span>.data
</span><span id=__span-22-21><a id=__codelineno-22-21 name=__codelineno-22-21 href=#__codelineno-22-21></a>
</span><span id=__span-22-22><a id=__codelineno-22-22 name=__codelineno-22-22 href=#__codelineno-22-22></a><span class=c1># returns</span>
</span><span id=__span-22-23><a id=__codelineno-22-23 name=__codelineno-22-23 href=#__codelineno-22-23></a>my_dict<span class=o>[</span><span class=s2>&quot;somekey&quot;</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;localfile&quot;</span>
</span><span id=__span-22-24><a id=__codelineno-22-24 name=__codelineno-22-24 href=#__codelineno-22-24></a>my_dict<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;asd&quot;</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;123&quot;</span>
</span><span id=__span-22-25><a id=__codelineno-22-25 name=__codelineno-22-25 href=#__codelineno-22-25></a>my_dict<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;qwe&quot;</span><span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>1</span>
</span><span id=__span-22-26><a id=__codelineno-22-26 name=__codelineno-22-26 href=#__codelineno-22-26></a>my_dict<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;qwe&quot;</span><span class=o>][</span><span class=m>1</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>2</span>
</span><span id=__span-22-27><a id=__codelineno-22-27 name=__codelineno-22-27 href=#__codelineno-22-27></a>my_dict<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;nested_dict&quot;</span><span class=o>][</span><span class=s2>&quot;das&quot;</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>31</span>
</span><span id=__span-22-28><a id=__codelineno-22-28 name=__codelineno-22-28 href=#__codelineno-22-28></a>my_dict<span class=o>[</span><span class=s2>&quot;a_dict&quot;</span><span class=o>][</span><span class=s2>&quot;nested_dict&quot;</span><span class=o>][</span><span class=s2>&quot;qwe&quot;</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;asd&quot;</span>
</span></code></pre></div> <h2 id=whats-next>What's next?<a class=headerlink href=#whats-next title="Permanent link">#</a></h2> <p>Having <code>pycatj</code> functionality available withing a HTTP call reach makes it possible to create a simple one-page web frontend that will receive the users input and render the result of the pycatj-web service we deployed in this post.</p> <p>I will make another post covering the learning curve I needed to climb on to create a modern Material UI frontend that leverages the serverless function.</p> <p>[<a href=https://github.com/hellt/pycatj-web>Project's source code</a>]</p> <h2 id=__comments>Comments</h2> <script src=https://giscus.app/client.js data-repo=hellt/netdevops.me data-repo-id="MDEwOlJlcG9zaXRvcnkzNTkzNTc5ODc=" data-category="Show and tell" data-category-id=DIC_kwDOFWteI84CRmVn data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async>
    </script> <!-- Synchronize Giscus theme with palette --> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate" ? "dark" : "light"
        giscus.setAttribute("data-theme", theme)
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function () {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function () {
            var palette = __md_get("__palette")
            if (palette && typeof palette.color === "object") {
                var theme = palette.color.scheme === "slate" ? "dark" : "light"

                /* Instruct Giscus to change theme */
                var frame = document.querySelector(".giscus-frame")
                frame.contentWindow.postMessage(
                    { giscus: { setConfig: { theme } } },
                    "https://giscus.app"
                )
            }
        })
    })
</script> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs Insiders </a> </div> <div class=md-social> <a href=https://github.com/hellt target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/ntdvps target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.top", "navigation.instant", "navigation.tabs", "search.suggest", "content.code.annotate", "toc.follow", "content.tooltips", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.1e90e0fb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.2b189340.min.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>